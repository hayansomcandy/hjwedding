(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Rg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ng={exports:{}},Jc={},Fg={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var za=Symbol.for("react.element"),pE=Symbol.for("react.portal"),mE=Symbol.for("react.fragment"),gE=Symbol.for("react.strict_mode"),xE=Symbol.for("react.profiler"),vE=Symbol.for("react.provider"),_E=Symbol.for("react.context"),yE=Symbol.for("react.forward_ref"),wE=Symbol.for("react.suspense"),EE=Symbol.for("react.memo"),TE=Symbol.for("react.lazy"),Ap=Symbol.iterator;function SE(e){return e===null||typeof e!="object"?null:(e=Ap&&e[Ap]||e["@@iterator"],typeof e=="function"?e:null)}var Og={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Dg=Object.assign,Pg={};function ao(e,t,n){this.props=e,this.context=t,this.refs=Pg,this.updater=n||Og}ao.prototype.isReactComponent={};ao.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ao.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Lg(){}Lg.prototype=ao.prototype;function nh(e,t,n){this.props=e,this.context=t,this.refs=Pg,this.updater=n||Og}var rh=nh.prototype=new Lg;rh.constructor=nh;Dg(rh,ao.prototype);rh.isPureReactComponent=!0;var Ip=Array.isArray,bg=Object.prototype.hasOwnProperty,ih={current:null},Mg={key:!0,ref:!0,__self:!0,__source:!0};function Bg(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)bg.call(t,r)&&!Mg.hasOwnProperty(r)&&(i[r]=t[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(r in a=e.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:za,type:e,key:s,ref:o,props:i,_owner:ih.current}}function CE(e,t){return{$$typeof:za,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function sh(e){return typeof e=="object"&&e!==null&&e.$$typeof===za}function kE(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Rp=/\/+/g;function Uu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?kE(""+e.key):t.toString(36)}function Ml(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case za:case pE:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+Uu(o,0):r,Ip(i)?(n="",e!=null&&(n=e.replace(Rp,"$&/")+"/"),Ml(i,t,n,"",function(c){return c})):i!=null&&(sh(i)&&(i=CE(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Rp,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",Ip(e))for(var a=0;a<e.length;a++){s=e[a];var l=r+Uu(s,a);o+=Ml(s,t,n,l,i)}else if(l=SE(e),typeof l=="function")for(e=l.call(e),a=0;!(s=e.next()).done;)s=s.value,l=r+Uu(s,a++),o+=Ml(s,t,n,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ll(e,t,n){if(e==null)return e;var r=[],i=0;return Ml(e,r,"","",function(s){return t.call(n,s,i++)}),r}function AE(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var en={current:null},Bl={transition:null},IE={ReactCurrentDispatcher:en,ReactCurrentBatchConfig:Bl,ReactCurrentOwner:ih};function jg(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:ll,forEach:function(e,t,n){ll(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ll(e,function(){t++}),t},toArray:function(e){return ll(e,function(t){return t})||[]},only:function(e){if(!sh(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=ao;ke.Fragment=mE;ke.Profiler=xE;ke.PureComponent=nh;ke.StrictMode=gE;ke.Suspense=wE;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IE;ke.act=jg;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Dg({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=ih.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(l in t)bg.call(t,l)&&!Mg.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&a!==void 0?a[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:za,type:e.type,key:i,ref:s,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:_E,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:vE,_context:e},e.Consumer=e};ke.createElement=Bg;ke.createFactory=function(e){var t=Bg.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:yE,render:e}};ke.isValidElement=sh;ke.lazy=function(e){return{$$typeof:TE,_payload:{_status:-1,_result:e},_init:AE}};ke.memo=function(e,t){return{$$typeof:EE,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=Bl.transition;Bl.transition={};try{e()}finally{Bl.transition=t}};ke.unstable_act=jg;ke.useCallback=function(e,t){return en.current.useCallback(e,t)};ke.useContext=function(e){return en.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return en.current.useDeferredValue(e)};ke.useEffect=function(e,t){return en.current.useEffect(e,t)};ke.useId=function(){return en.current.useId()};ke.useImperativeHandle=function(e,t,n){return en.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return en.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return en.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return en.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return en.current.useReducer(e,t,n)};ke.useRef=function(e){return en.current.useRef(e)};ke.useState=function(e){return en.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return en.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return en.current.useTransition()};ke.version="18.3.1";Fg.exports=ke;var ce=Fg.exports;const Mf=Rg(ce);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RE=ce,NE=Symbol.for("react.element"),FE=Symbol.for("react.fragment"),OE=Object.prototype.hasOwnProperty,DE=RE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,PE={key:!0,ref:!0,__self:!0,__source:!0};function Ug(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)OE.call(t,r)&&!PE.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:NE,type:e,key:s,ref:o,props:i,_owner:DE.current}}Jc.Fragment=FE;Jc.jsx=Ug;Jc.jsxs=Ug;Ng.exports=Jc;var d=Ng.exports,Bf={},Wg={exports:{}},kn={},zg={exports:{}},Hg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(se,de){var me=se.length;se.push(de);e:for(;0<me;){var Se=me-1>>>1,F=se[Se];if(0<i(F,de))se[Se]=de,se[me]=F,me=Se;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var de=se[0],me=se.pop();if(me!==de){se[0]=me;e:for(var Se=0,F=se.length,M=F>>>1;Se<M;){var T=2*(Se+1)-1,R=se[T],b=T+1,Y=se[b];if(0>i(R,me))b<F&&0>i(Y,R)?(se[Se]=Y,se[b]=me,Se=b):(se[Se]=R,se[T]=me,Se=T);else if(b<F&&0>i(Y,me))se[Se]=Y,se[b]=me,Se=b;else break e}}return de}function i(se,de){var me=se.sortIndex-de.sortIndex;return me!==0?me:se.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,p=!1,g=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(se){for(var de=n(c);de!==null;){if(de.callback===null)r(c);else if(de.startTime<=se)r(c),de.sortIndex=de.expirationTime,t(l,de);else break;de=n(c)}}function I(se){if(m=!1,y(se),!g)if(n(l)!==null)g=!0,He(O);else{var de=n(c);de!==null&&We(I,de.startTime-se)}}function O(se,de){g=!1,m&&(m=!1,_(D),D=-1),p=!0;var me=f;try{for(y(de),h=n(l);h!==null&&(!(h.expirationTime>de)||se&&!H());){var Se=h.callback;if(typeof Se=="function"){h.callback=null,f=h.priorityLevel;var F=Se(h.expirationTime<=de);de=e.unstable_now(),typeof F=="function"?h.callback=F:h===n(l)&&r(l),y(de)}else r(l);h=n(l)}if(h!==null)var M=!0;else{var T=n(c);T!==null&&We(I,T.startTime-de),M=!1}return M}finally{h=null,f=me,p=!1}}var z=!1,N=null,D=-1,L=5,P=-1;function H(){return!(e.unstable_now()-P<L)}function K(){if(N!==null){var se=e.unstable_now();P=se;var de=!0;try{de=N(!0,se)}finally{de?te():(z=!1,N=null)}}else z=!1}var te;if(typeof x=="function")te=function(){x(K)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,ve=we.port2;we.port1.onmessage=K,te=function(){ve.postMessage(null)}}else te=function(){w(K,0)};function He(se){N=se,z||(z=!0,te())}function We(se,de){D=w(function(){se(e.unstable_now())},de)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,He(O))},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(se){switch(f){case 1:case 2:case 3:var de=3;break;default:de=f}var me=f;f=de;try{return se()}finally{f=me}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(se,de){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var me=f;f=se;try{return de()}finally{f=me}},e.unstable_scheduleCallback=function(se,de,me){var Se=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Se+me:Se):me=Se,se){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=me+F,se={id:u++,callback:de,priorityLevel:se,startTime:me,expirationTime:F,sortIndex:-1},me>Se?(se.sortIndex=me,t(c,se),n(l)===null&&se===n(c)&&(m?(_(D),D=-1):m=!0,We(I,me-Se))):(se.sortIndex=F,t(l,se),g||p||(g=!0,He(O))),se},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(se){var de=f;return function(){var me=f;f=de;try{return se.apply(this,arguments)}finally{f=me}}}})(Hg);zg.exports=Hg;var LE=zg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bE=ce,Sn=LE;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vg=new Set,ca={};function is(e,t){Ys(e,t),Ys(e+"Capture",t)}function Ys(e,t){for(ca[e]=t,e=0;e<t.length;e++)Vg.add(t[e])}var Rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jf=Object.prototype.hasOwnProperty,ME=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Np={},Fp={};function BE(e){return jf.call(Fp,e)?!0:jf.call(Np,e)?!1:ME.test(e)?Fp[e]=!0:(Np[e]=!0,!1)}function jE(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function UE(e,t,n,r){if(t===null||typeof t>"u"||jE(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function tn(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Mt[e]=new tn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Mt[t]=new tn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Mt[e]=new tn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Mt[e]=new tn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Mt[e]=new tn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Mt[e]=new tn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Mt[e]=new tn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Mt[e]=new tn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Mt[e]=new tn(e,5,!1,e.toLowerCase(),null,!1,!1)});var oh=/[\-:]([a-z])/g;function ah(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(oh,ah);Mt[t]=new tn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(oh,ah);Mt[t]=new tn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(oh,ah);Mt[t]=new tn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Mt[e]=new tn(e,1,!1,e.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Mt[e]=new tn(e,1,!1,e.toLowerCase(),null,!0,!0)});function lh(e,t,n,r){var i=Mt.hasOwnProperty(t)?Mt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(UE(t,n,i,r)&&(n=null),r||i===null?BE(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var jr=bE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cl=Symbol.for("react.element"),ys=Symbol.for("react.portal"),ws=Symbol.for("react.fragment"),ch=Symbol.for("react.strict_mode"),Uf=Symbol.for("react.profiler"),$g=Symbol.for("react.provider"),Gg=Symbol.for("react.context"),uh=Symbol.for("react.forward_ref"),Wf=Symbol.for("react.suspense"),zf=Symbol.for("react.suspense_list"),fh=Symbol.for("react.memo"),$r=Symbol.for("react.lazy"),Kg=Symbol.for("react.offscreen"),Op=Symbol.iterator;function To(e){return e===null||typeof e!="object"?null:(e=Op&&e[Op]||e["@@iterator"],typeof e=="function"?e:null)}var rt=Object.assign,Wu;function Mo(e){if(Wu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Wu=t&&t[1]||""}return`
`+Wu+e}var zu=!1;function Hu(e,t){if(!e||zu)return"";zu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=a);break}}}finally{zu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Mo(e):""}function WE(e){switch(e.tag){case 5:return Mo(e.type);case 16:return Mo("Lazy");case 13:return Mo("Suspense");case 19:return Mo("SuspenseList");case 0:case 2:case 15:return e=Hu(e.type,!1),e;case 11:return e=Hu(e.type.render,!1),e;case 1:return e=Hu(e.type,!0),e;default:return""}}function Hf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ws:return"Fragment";case ys:return"Portal";case Uf:return"Profiler";case ch:return"StrictMode";case Wf:return"Suspense";case zf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Gg:return(e.displayName||"Context")+".Consumer";case $g:return(e._context.displayName||"Context")+".Provider";case uh:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case fh:return t=e.displayName||null,t!==null?t:Hf(e.type)||"Memo";case $r:t=e._payload,e=e._init;try{return Hf(e(t))}catch{}}return null}function zE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hf(t);case 8:return t===ch?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function fi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Xg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function HE(e){var t=Xg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ul(e){e._valueTracker||(e._valueTracker=HE(e))}function Yg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Xg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ql(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vf(e,t){var n=t.checked;return rt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Dp(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=fi(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function qg(e,t){t=t.checked,t!=null&&lh(e,"checked",t,!1)}function $f(e,t){qg(e,t);var n=fi(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Gf(e,t.type,n):t.hasOwnProperty("defaultValue")&&Gf(e,t.type,fi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Pp(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Gf(e,t,n){(t!=="number"||ql(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Bo=Array.isArray;function Ps(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+fi(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Kf(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return rt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Lp(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Q(92));if(Bo(n)){if(1<n.length)throw Error(Q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:fi(n)}}function Qg(e,t){var n=fi(t.value),r=fi(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function bp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Jg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xf(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Jg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var fl,Zg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(fl=fl||document.createElement("div"),fl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ua(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},VE=["Webkit","ms","Moz","O"];Object.keys(zo).forEach(function(e){VE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zo[t]=zo[e]})});function ex(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||zo.hasOwnProperty(e)&&zo[e]?(""+t).trim():t+"px"}function tx(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ex(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var $E=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yf(e,t){if(t){if($E[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function qf(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qf=null;function hh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jf=null,Ls=null,bs=null;function Mp(e){if(e=$a(e)){if(typeof Jf!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=ru(t),Jf(e.stateNode,e.type,t))}}function nx(e){Ls?bs?bs.push(e):bs=[e]:Ls=e}function rx(){if(Ls){var e=Ls,t=bs;if(bs=Ls=null,Mp(e),t)for(e=0;e<t.length;e++)Mp(t[e])}}function ix(e,t){return e(t)}function sx(){}var Vu=!1;function ox(e,t,n){if(Vu)return e(t,n);Vu=!0;try{return ix(e,t,n)}finally{Vu=!1,(Ls!==null||bs!==null)&&(sx(),rx())}}function fa(e,t){var n=e.stateNode;if(n===null)return null;var r=ru(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Q(231,t,typeof n));return n}var Zf=!1;if(Rr)try{var So={};Object.defineProperty(So,"passive",{get:function(){Zf=!0}}),window.addEventListener("test",So,So),window.removeEventListener("test",So,So)}catch{Zf=!1}function GE(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Ho=!1,Ql=null,Jl=!1,e0=null,KE={onError:function(e){Ho=!0,Ql=e}};function XE(e,t,n,r,i,s,o,a,l){Ho=!1,Ql=null,GE.apply(KE,arguments)}function YE(e,t,n,r,i,s,o,a,l){if(XE.apply(this,arguments),Ho){if(Ho){var c=Ql;Ho=!1,Ql=null}else throw Error(Q(198));Jl||(Jl=!0,e0=c)}}function ss(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function ax(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Bp(e){if(ss(e)!==e)throw Error(Q(188))}function qE(e){var t=e.alternate;if(!t){if(t=ss(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Bp(i),e;if(s===r)return Bp(i),t;s=s.sibling}throw Error(Q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?e:t}function lx(e){return e=qE(e),e!==null?cx(e):null}function cx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=cx(e);if(t!==null)return t;e=e.sibling}return null}var ux=Sn.unstable_scheduleCallback,jp=Sn.unstable_cancelCallback,QE=Sn.unstable_shouldYield,JE=Sn.unstable_requestPaint,ft=Sn.unstable_now,ZE=Sn.unstable_getCurrentPriorityLevel,dh=Sn.unstable_ImmediatePriority,fx=Sn.unstable_UserBlockingPriority,Zl=Sn.unstable_NormalPriority,eT=Sn.unstable_LowPriority,hx=Sn.unstable_IdlePriority,Zc=null,ur=null;function tT(e){if(ur&&typeof ur.onCommitFiberRoot=="function")try{ur.onCommitFiberRoot(Zc,e,void 0,(e.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:iT,nT=Math.log,rT=Math.LN2;function iT(e){return e>>>=0,e===0?32:31-(nT(e)/rT|0)|0}var hl=64,dl=4194304;function jo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ec(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=jo(a):(s&=o,s!==0&&(r=jo(s)))}else o=n&~i,o!==0?r=jo(o):s!==0&&(r=jo(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Qn(t),i=1<<n,r|=e[n],t&=~i;return r}function sT(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oT(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Qn(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=sT(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}function t0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dx(){var e=hl;return hl<<=1,!(hl&4194240)&&(hl=64),e}function $u(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ha(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qn(t),e[t]=n}function aT(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Qn(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function ph(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Qn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Me=0;function px(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var mx,mh,gx,xx,vx,n0=!1,pl=[],ei=null,ti=null,ni=null,ha=new Map,da=new Map,Kr=[],lT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Up(e,t){switch(e){case"focusin":case"focusout":ei=null;break;case"dragenter":case"dragleave":ti=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":ha.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":da.delete(t.pointerId)}}function Co(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=$a(t),t!==null&&mh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function cT(e,t,n,r,i){switch(t){case"focusin":return ei=Co(ei,e,t,n,r,i),!0;case"dragenter":return ti=Co(ti,e,t,n,r,i),!0;case"mouseover":return ni=Co(ni,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return ha.set(s,Co(ha.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,da.set(s,Co(da.get(s)||null,e,t,n,r,i)),!0}return!1}function _x(e){var t=Oi(e.target);if(t!==null){var n=ss(t);if(n!==null){if(t=n.tag,t===13){if(t=ax(n),t!==null){e.blockedOn=t,vx(e.priority,function(){gx(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=r0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Qf=r,n.target.dispatchEvent(r),Qf=null}else return t=$a(n),t!==null&&mh(t),e.blockedOn=n,!1;t.shift()}return!0}function Wp(e,t,n){jl(e)&&n.delete(t)}function uT(){n0=!1,ei!==null&&jl(ei)&&(ei=null),ti!==null&&jl(ti)&&(ti=null),ni!==null&&jl(ni)&&(ni=null),ha.forEach(Wp),da.forEach(Wp)}function ko(e,t){e.blockedOn===t&&(e.blockedOn=null,n0||(n0=!0,Sn.unstable_scheduleCallback(Sn.unstable_NormalPriority,uT)))}function pa(e){function t(i){return ko(i,e)}if(0<pl.length){ko(pl[0],e);for(var n=1;n<pl.length;n++){var r=pl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(ei!==null&&ko(ei,e),ti!==null&&ko(ti,e),ni!==null&&ko(ni,e),ha.forEach(t),da.forEach(t),n=0;n<Kr.length;n++)r=Kr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Kr.length&&(n=Kr[0],n.blockedOn===null);)_x(n),n.blockedOn===null&&Kr.shift()}var Ms=jr.ReactCurrentBatchConfig,tc=!0;function fT(e,t,n,r){var i=Me,s=Ms.transition;Ms.transition=null;try{Me=1,gh(e,t,n,r)}finally{Me=i,Ms.transition=s}}function hT(e,t,n,r){var i=Me,s=Ms.transition;Ms.transition=null;try{Me=4,gh(e,t,n,r)}finally{Me=i,Ms.transition=s}}function gh(e,t,n,r){if(tc){var i=r0(e,t,n,r);if(i===null)tf(e,t,r,nc,n),Up(e,r);else if(cT(i,e,t,n,r))r.stopPropagation();else if(Up(e,r),t&4&&-1<lT.indexOf(e)){for(;i!==null;){var s=$a(i);if(s!==null&&mx(s),s=r0(e,t,n,r),s===null&&tf(e,t,r,nc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else tf(e,t,r,null,n)}}var nc=null;function r0(e,t,n,r){if(nc=null,e=hh(r),e=Oi(e),e!==null)if(t=ss(e),t===null)e=null;else if(n=t.tag,n===13){if(e=ax(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return nc=e,null}function yx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZE()){case dh:return 1;case fx:return 4;case Zl:case eT:return 16;case hx:return 536870912;default:return 16}default:return 16}}var qr=null,xh=null,Ul=null;function wx(){if(Ul)return Ul;var e,t=xh,n=t.length,r,i="value"in qr?qr.value:qr.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return Ul=i.slice(e,1<r?1-r:void 0)}function Wl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ml(){return!0}function zp(){return!1}function An(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in e)e.hasOwnProperty(a)&&(n=e[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ml:zp,this.isPropagationStopped=zp,this}return rt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),t}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vh=An(lo),Va=rt({},lo,{view:0,detail:0}),dT=An(Va),Gu,Ku,Ao,eu=rt({},Va,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_h,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ao&&(Ao&&e.type==="mousemove"?(Gu=e.screenX-Ao.screenX,Ku=e.screenY-Ao.screenY):Ku=Gu=0,Ao=e),Gu)},movementY:function(e){return"movementY"in e?e.movementY:Ku}}),Hp=An(eu),pT=rt({},eu,{dataTransfer:0}),mT=An(pT),gT=rt({},Va,{relatedTarget:0}),Xu=An(gT),xT=rt({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),vT=An(xT),_T=rt({},lo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yT=An(_T),wT=rt({},lo,{data:0}),Vp=An(wT),ET={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ST={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CT(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ST[e])?!!t[e]:!1}function _h(){return CT}var kT=rt({},Va,{key:function(e){if(e.key){var t=ET[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Wl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TT[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_h,charCode:function(e){return e.type==="keypress"?Wl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Wl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),AT=An(kT),IT=rt({},eu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$p=An(IT),RT=rt({},Va,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_h}),NT=An(RT),FT=rt({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),OT=An(FT),DT=rt({},eu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),PT=An(DT),LT=[9,13,27,32],yh=Rr&&"CompositionEvent"in window,Vo=null;Rr&&"documentMode"in document&&(Vo=document.documentMode);var bT=Rr&&"TextEvent"in window&&!Vo,Ex=Rr&&(!yh||Vo&&8<Vo&&11>=Vo),Gp=String.fromCharCode(32),Kp=!1;function Tx(e,t){switch(e){case"keyup":return LT.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Es=!1;function MT(e,t){switch(e){case"compositionend":return Sx(t);case"keypress":return t.which!==32?null:(Kp=!0,Gp);case"textInput":return e=t.data,e===Gp&&Kp?null:e;default:return null}}function BT(e,t){if(Es)return e==="compositionend"||!yh&&Tx(e,t)?(e=wx(),Ul=xh=qr=null,Es=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ex&&t.locale!=="ko"?null:t.data;default:return null}}var jT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!jT[e.type]:t==="textarea"}function Cx(e,t,n,r){nx(r),t=rc(t,"onChange"),0<t.length&&(n=new vh("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var $o=null,ma=null;function UT(e){bx(e,0)}function tu(e){var t=Cs(e);if(Yg(t))return e}function WT(e,t){if(e==="change")return t}var kx=!1;if(Rr){var Yu;if(Rr){var qu="oninput"in document;if(!qu){var Yp=document.createElement("div");Yp.setAttribute("oninput","return;"),qu=typeof Yp.oninput=="function"}Yu=qu}else Yu=!1;kx=Yu&&(!document.documentMode||9<document.documentMode)}function qp(){$o&&($o.detachEvent("onpropertychange",Ax),ma=$o=null)}function Ax(e){if(e.propertyName==="value"&&tu(ma)){var t=[];Cx(t,ma,e,hh(e)),ox(UT,t)}}function zT(e,t,n){e==="focusin"?(qp(),$o=t,ma=n,$o.attachEvent("onpropertychange",Ax)):e==="focusout"&&qp()}function HT(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return tu(ma)}function VT(e,t){if(e==="click")return tu(t)}function $T(e,t){if(e==="input"||e==="change")return tu(t)}function GT(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tr=typeof Object.is=="function"?Object.is:GT;function ga(e,t){if(tr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jf.call(t,i)||!tr(e[i],t[i]))return!1}return!0}function Qp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jp(e,t){var n=Qp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qp(n)}}function Ix(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ix(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Rx(){for(var e=window,t=ql();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ql(e.document)}return t}function wh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function KT(e){var t=Rx(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ix(n.ownerDocument.documentElement,n)){if(r!==null&&wh(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=Jp(n,s);var o=Jp(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var XT=Rr&&"documentMode"in document&&11>=document.documentMode,Ts=null,i0=null,Go=null,s0=!1;function Zp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;s0||Ts==null||Ts!==ql(r)||(r=Ts,"selectionStart"in r&&wh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Go&&ga(Go,r)||(Go=r,r=rc(i0,"onSelect"),0<r.length&&(t=new vh("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ts)))}function gl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ss={animationend:gl("Animation","AnimationEnd"),animationiteration:gl("Animation","AnimationIteration"),animationstart:gl("Animation","AnimationStart"),transitionend:gl("Transition","TransitionEnd")},Qu={},Nx={};Rr&&(Nx=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function nu(e){if(Qu[e])return Qu[e];if(!Ss[e])return e;var t=Ss[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Nx)return Qu[e]=t[n];return e}var Fx=nu("animationend"),Ox=nu("animationiteration"),Dx=nu("animationstart"),Px=nu("transitionend"),Lx=new Map,e1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vi(e,t){Lx.set(e,t),is(t,[e])}for(var Ju=0;Ju<e1.length;Ju++){var Zu=e1[Ju],YT=Zu.toLowerCase(),qT=Zu[0].toUpperCase()+Zu.slice(1);vi(YT,"on"+qT)}vi(Fx,"onAnimationEnd");vi(Ox,"onAnimationIteration");vi(Dx,"onAnimationStart");vi("dblclick","onDoubleClick");vi("focusin","onFocus");vi("focusout","onBlur");vi(Px,"onTransitionEnd");Ys("onMouseEnter",["mouseout","mouseover"]);Ys("onMouseLeave",["mouseout","mouseover"]);Ys("onPointerEnter",["pointerout","pointerover"]);Ys("onPointerLeave",["pointerout","pointerover"]);is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));is("onBeforeInput",["compositionend","keypress","textInput","paste"]);is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QT=new Set("cancel close invalid load scroll toggle".split(" ").concat(Uo));function t1(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,YE(r,t,void 0,e),e.currentTarget=null}function bx(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;t1(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;t1(i,a,c),s=l}}}if(Jl)throw e=e0,Jl=!1,e0=null,e}function Ke(e,t){var n=t[u0];n===void 0&&(n=t[u0]=new Set);var r=e+"__bubble";n.has(r)||(Mx(t,e,2,!1),n.add(r))}function ef(e,t,n){var r=0;t&&(r|=4),Mx(n,e,r,t)}var xl="_reactListening"+Math.random().toString(36).slice(2);function xa(e){if(!e[xl]){e[xl]=!0,Vg.forEach(function(n){n!=="selectionchange"&&(QT.has(n)||ef(n,!1,e),ef(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xl]||(t[xl]=!0,ef("selectionchange",!1,t))}}function Mx(e,t,n,r){switch(yx(t)){case 1:var i=fT;break;case 4:i=hT;break;default:i=gh}n=i.bind(null,t,n,e),i=void 0,!Zf||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function tf(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Oi(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}ox(function(){var c=s,u=hh(n),h=[];e:{var f=Lx.get(e);if(f!==void 0){var p=vh,g=e;switch(e){case"keypress":if(Wl(n)===0)break e;case"keydown":case"keyup":p=AT;break;case"focusin":g="focus",p=Xu;break;case"focusout":g="blur",p=Xu;break;case"beforeblur":case"afterblur":p=Xu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=mT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=NT;break;case Fx:case Ox:case Dx:p=vT;break;case Px:p=OT;break;case"scroll":p=dT;break;case"wheel":p=PT;break;case"copy":case"cut":case"paste":p=yT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=$p}var m=(t&4)!==0,w=!m&&e==="scroll",_=m?f!==null?f+"Capture":null:f;m=[];for(var x=c,y;x!==null;){y=x;var I=y.stateNode;if(y.tag===5&&I!==null&&(y=I,_!==null&&(I=fa(x,_),I!=null&&m.push(va(x,I,y)))),w)break;x=x.return}0<m.length&&(f=new p(f,g,null,n,u),h.push({event:f,listeners:m}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",f&&n!==Qf&&(g=n.relatedTarget||n.fromElement)&&(Oi(g)||g[Nr]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=n.relatedTarget||n.toElement,p=c,g=g?Oi(g):null,g!==null&&(w=ss(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(m=Hp,I="onMouseLeave",_="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(m=$p,I="onPointerLeave",_="onPointerEnter",x="pointer"),w=p==null?f:Cs(p),y=g==null?f:Cs(g),f=new m(I,x+"leave",p,n,u),f.target=w,f.relatedTarget=y,I=null,Oi(u)===c&&(m=new m(_,x+"enter",g,n,u),m.target=y,m.relatedTarget=w,I=m),w=I,p&&g)t:{for(m=p,_=g,x=0,y=m;y;y=ds(y))x++;for(y=0,I=_;I;I=ds(I))y++;for(;0<x-y;)m=ds(m),x--;for(;0<y-x;)_=ds(_),y--;for(;x--;){if(m===_||_!==null&&m===_.alternate)break t;m=ds(m),_=ds(_)}m=null}else m=null;p!==null&&n1(h,f,p,m,!1),g!==null&&w!==null&&n1(h,w,g,m,!0)}}e:{if(f=c?Cs(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var O=WT;else if(Xp(f))if(kx)O=$T;else{O=HT;var z=zT}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=VT);if(O&&(O=O(e,c))){Cx(h,O,n,u);break e}z&&z(e,f,c),e==="focusout"&&(z=f._wrapperState)&&z.controlled&&f.type==="number"&&Gf(f,"number",f.value)}switch(z=c?Cs(c):window,e){case"focusin":(Xp(z)||z.contentEditable==="true")&&(Ts=z,i0=c,Go=null);break;case"focusout":Go=i0=Ts=null;break;case"mousedown":s0=!0;break;case"contextmenu":case"mouseup":case"dragend":s0=!1,Zp(h,n,u);break;case"selectionchange":if(XT)break;case"keydown":case"keyup":Zp(h,n,u)}var N;if(yh)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Es?Tx(e,n)&&(D="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(D="onCompositionStart");D&&(Ex&&n.locale!=="ko"&&(Es||D!=="onCompositionStart"?D==="onCompositionEnd"&&Es&&(N=wx()):(qr=u,xh="value"in qr?qr.value:qr.textContent,Es=!0)),z=rc(c,D),0<z.length&&(D=new Vp(D,e,null,n,u),h.push({event:D,listeners:z}),N?D.data=N:(N=Sx(n),N!==null&&(D.data=N)))),(N=bT?MT(e,n):BT(e,n))&&(c=rc(c,"onBeforeInput"),0<c.length&&(u=new Vp("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=N))}bx(h,t)})}function va(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rc(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=fa(e,n),s!=null&&r.unshift(va(e,s,i)),s=fa(e,t),s!=null&&r.push(va(e,s,i))),e=e.return}return r}function ds(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function n1(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=fa(n,s),l!=null&&o.unshift(va(n,l,a))):i||(l=fa(n,s),l!=null&&o.push(va(n,l,a)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var JT=/\r\n?/g,ZT=/\u0000|\uFFFD/g;function r1(e){return(typeof e=="string"?e:""+e).replace(JT,`
`).replace(ZT,"")}function vl(e,t,n){if(t=r1(t),r1(e)!==t&&n)throw Error(Q(425))}function ic(){}var o0=null,a0=null;function l0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var c0=typeof setTimeout=="function"?setTimeout:void 0,eS=typeof clearTimeout=="function"?clearTimeout:void 0,i1=typeof Promise=="function"?Promise:void 0,tS=typeof queueMicrotask=="function"?queueMicrotask:typeof i1<"u"?function(e){return i1.resolve(null).then(e).catch(nS)}:c0;function nS(e){setTimeout(function(){throw e})}function nf(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),pa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);pa(t)}function ri(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function s1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var co=Math.random().toString(36).slice(2),lr="__reactFiber$"+co,_a="__reactProps$"+co,Nr="__reactContainer$"+co,u0="__reactEvents$"+co,rS="__reactListeners$"+co,iS="__reactHandles$"+co;function Oi(e){var t=e[lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Nr]||n[lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=s1(e);e!==null;){if(n=e[lr])return n;e=s1(e)}return t}e=n,n=e.parentNode}return null}function $a(e){return e=e[lr]||e[Nr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Cs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function ru(e){return e[_a]||null}var f0=[],ks=-1;function _i(e){return{current:e}}function Ye(e){0>ks||(e.current=f0[ks],f0[ks]=null,ks--)}function Ge(e,t){ks++,f0[ks]=e.current,e.current=t}var hi={},Gt=_i(hi),an=_i(!1),Hi=hi;function qs(e,t){var n=e.type.contextTypes;if(!n)return hi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ln(e){return e=e.childContextTypes,e!=null}function sc(){Ye(an),Ye(Gt)}function o1(e,t,n){if(Gt.current!==hi)throw Error(Q(168));Ge(Gt,t),Ge(an,n)}function Bx(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(Q(108,zE(e)||"Unknown",i));return rt({},n,r)}function oc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||hi,Hi=Gt.current,Ge(Gt,e),Ge(an,an.current),!0}function a1(e,t,n){var r=e.stateNode;if(!r)throw Error(Q(169));n?(e=Bx(e,t,Hi),r.__reactInternalMemoizedMergedChildContext=e,Ye(an),Ye(Gt),Ge(Gt,e)):Ye(an),Ge(an,n)}var vr=null,iu=!1,rf=!1;function jx(e){vr===null?vr=[e]:vr.push(e)}function sS(e){iu=!0,jx(e)}function yi(){if(!rf&&vr!==null){rf=!0;var e=0,t=Me;try{var n=vr;for(Me=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}vr=null,iu=!1}catch(i){throw vr!==null&&(vr=vr.slice(e+1)),ux(dh,yi),i}finally{Me=t,rf=!1}}return null}var As=[],Is=0,ac=null,lc=0,Fn=[],On=0,Vi=null,_r=1,yr="";function ki(e,t){As[Is++]=lc,As[Is++]=ac,ac=e,lc=t}function Ux(e,t,n){Fn[On++]=_r,Fn[On++]=yr,Fn[On++]=Vi,Vi=e;var r=_r;e=yr;var i=32-Qn(r)-1;r&=~(1<<i),n+=1;var s=32-Qn(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,_r=1<<32-Qn(t)+i|n<<i|r,yr=s+e}else _r=1<<s|n<<i|r,yr=e}function Eh(e){e.return!==null&&(ki(e,1),Ux(e,1,0))}function Th(e){for(;e===ac;)ac=As[--Is],As[Is]=null,lc=As[--Is],As[Is]=null;for(;e===Vi;)Vi=Fn[--On],Fn[On]=null,yr=Fn[--On],Fn[On]=null,_r=Fn[--On],Fn[On]=null}var En=null,wn=null,Qe=!1,$n=null;function Wx(e,t){var n=Dn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function l1(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,En=e,wn=ri(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,En=e,wn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Vi!==null?{id:_r,overflow:yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Dn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,En=e,wn=null,!0):!1;default:return!1}}function h0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function d0(e){if(Qe){var t=wn;if(t){var n=t;if(!l1(e,t)){if(h0(e))throw Error(Q(418));t=ri(n.nextSibling);var r=En;t&&l1(e,t)?Wx(r,n):(e.flags=e.flags&-4097|2,Qe=!1,En=e)}}else{if(h0(e))throw Error(Q(418));e.flags=e.flags&-4097|2,Qe=!1,En=e}}}function c1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;En=e}function _l(e){if(e!==En)return!1;if(!Qe)return c1(e),Qe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!l0(e.type,e.memoizedProps)),t&&(t=wn)){if(h0(e))throw zx(),Error(Q(418));for(;t;)Wx(e,t),t=ri(t.nextSibling)}if(c1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){wn=ri(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}wn=null}}else wn=En?ri(e.stateNode.nextSibling):null;return!0}function zx(){for(var e=wn;e;)e=ri(e.nextSibling)}function Qs(){wn=En=null,Qe=!1}function Sh(e){$n===null?$n=[e]:$n.push(e)}var oS=jr.ReactCurrentBatchConfig;function Io(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,e))}return e}function yl(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function u1(e){var t=e._init;return t(e._payload)}function Hx(e){function t(_,x){if(e){var y=_.deletions;y===null?(_.deletions=[x],_.flags|=16):y.push(x)}}function n(_,x){if(!e)return null;for(;x!==null;)t(_,x),x=x.sibling;return null}function r(_,x){for(_=new Map;x!==null;)x.key!==null?_.set(x.key,x):_.set(x.index,x),x=x.sibling;return _}function i(_,x){return _=ai(_,x),_.index=0,_.sibling=null,_}function s(_,x,y){return _.index=y,e?(y=_.alternate,y!==null?(y=y.index,y<x?(_.flags|=2,x):y):(_.flags|=2,x)):(_.flags|=1048576,x)}function o(_){return e&&_.alternate===null&&(_.flags|=2),_}function a(_,x,y,I){return x===null||x.tag!==6?(x=ff(y,_.mode,I),x.return=_,x):(x=i(x,y),x.return=_,x)}function l(_,x,y,I){var O=y.type;return O===ws?u(_,x,y.props.children,I,y.key):x!==null&&(x.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===$r&&u1(O)===x.type)?(I=i(x,y.props),I.ref=Io(_,x,y),I.return=_,I):(I=Xl(y.type,y.key,y.props,null,_.mode,I),I.ref=Io(_,x,y),I.return=_,I)}function c(_,x,y,I){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=hf(y,_.mode,I),x.return=_,x):(x=i(x,y.children||[]),x.return=_,x)}function u(_,x,y,I,O){return x===null||x.tag!==7?(x=ji(y,_.mode,I,O),x.return=_,x):(x=i(x,y),x.return=_,x)}function h(_,x,y){if(typeof x=="string"&&x!==""||typeof x=="number")return x=ff(""+x,_.mode,y),x.return=_,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case cl:return y=Xl(x.type,x.key,x.props,null,_.mode,y),y.ref=Io(_,null,x),y.return=_,y;case ys:return x=hf(x,_.mode,y),x.return=_,x;case $r:var I=x._init;return h(_,I(x._payload),y)}if(Bo(x)||To(x))return x=ji(x,_.mode,y,null),x.return=_,x;yl(_,x)}return null}function f(_,x,y,I){var O=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return O!==null?null:a(_,x,""+y,I);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case cl:return y.key===O?l(_,x,y,I):null;case ys:return y.key===O?c(_,x,y,I):null;case $r:return O=y._init,f(_,x,O(y._payload),I)}if(Bo(y)||To(y))return O!==null?null:u(_,x,y,I,null);yl(_,y)}return null}function p(_,x,y,I,O){if(typeof I=="string"&&I!==""||typeof I=="number")return _=_.get(y)||null,a(x,_,""+I,O);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case cl:return _=_.get(I.key===null?y:I.key)||null,l(x,_,I,O);case ys:return _=_.get(I.key===null?y:I.key)||null,c(x,_,I,O);case $r:var z=I._init;return p(_,x,y,z(I._payload),O)}if(Bo(I)||To(I))return _=_.get(y)||null,u(x,_,I,O,null);yl(x,I)}return null}function g(_,x,y,I){for(var O=null,z=null,N=x,D=x=0,L=null;N!==null&&D<y.length;D++){N.index>D?(L=N,N=null):L=N.sibling;var P=f(_,N,y[D],I);if(P===null){N===null&&(N=L);break}e&&N&&P.alternate===null&&t(_,N),x=s(P,x,D),z===null?O=P:z.sibling=P,z=P,N=L}if(D===y.length)return n(_,N),Qe&&ki(_,D),O;if(N===null){for(;D<y.length;D++)N=h(_,y[D],I),N!==null&&(x=s(N,x,D),z===null?O=N:z.sibling=N,z=N);return Qe&&ki(_,D),O}for(N=r(_,N);D<y.length;D++)L=p(N,_,D,y[D],I),L!==null&&(e&&L.alternate!==null&&N.delete(L.key===null?D:L.key),x=s(L,x,D),z===null?O=L:z.sibling=L,z=L);return e&&N.forEach(function(H){return t(_,H)}),Qe&&ki(_,D),O}function m(_,x,y,I){var O=To(y);if(typeof O!="function")throw Error(Q(150));if(y=O.call(y),y==null)throw Error(Q(151));for(var z=O=null,N=x,D=x=0,L=null,P=y.next();N!==null&&!P.done;D++,P=y.next()){N.index>D?(L=N,N=null):L=N.sibling;var H=f(_,N,P.value,I);if(H===null){N===null&&(N=L);break}e&&N&&H.alternate===null&&t(_,N),x=s(H,x,D),z===null?O=H:z.sibling=H,z=H,N=L}if(P.done)return n(_,N),Qe&&ki(_,D),O;if(N===null){for(;!P.done;D++,P=y.next())P=h(_,P.value,I),P!==null&&(x=s(P,x,D),z===null?O=P:z.sibling=P,z=P);return Qe&&ki(_,D),O}for(N=r(_,N);!P.done;D++,P=y.next())P=p(N,_,D,P.value,I),P!==null&&(e&&P.alternate!==null&&N.delete(P.key===null?D:P.key),x=s(P,x,D),z===null?O=P:z.sibling=P,z=P);return e&&N.forEach(function(K){return t(_,K)}),Qe&&ki(_,D),O}function w(_,x,y,I){if(typeof y=="object"&&y!==null&&y.type===ws&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case cl:e:{for(var O=y.key,z=x;z!==null;){if(z.key===O){if(O=y.type,O===ws){if(z.tag===7){n(_,z.sibling),x=i(z,y.props.children),x.return=_,_=x;break e}}else if(z.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===$r&&u1(O)===z.type){n(_,z.sibling),x=i(z,y.props),x.ref=Io(_,z,y),x.return=_,_=x;break e}n(_,z);break}else t(_,z);z=z.sibling}y.type===ws?(x=ji(y.props.children,_.mode,I,y.key),x.return=_,_=x):(I=Xl(y.type,y.key,y.props,null,_.mode,I),I.ref=Io(_,x,y),I.return=_,_=I)}return o(_);case ys:e:{for(z=y.key;x!==null;){if(x.key===z)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){n(_,x.sibling),x=i(x,y.children||[]),x.return=_,_=x;break e}else{n(_,x);break}else t(_,x);x=x.sibling}x=hf(y,_.mode,I),x.return=_,_=x}return o(_);case $r:return z=y._init,w(_,x,z(y._payload),I)}if(Bo(y))return g(_,x,y,I);if(To(y))return m(_,x,y,I);yl(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,x!==null&&x.tag===6?(n(_,x.sibling),x=i(x,y),x.return=_,_=x):(n(_,x),x=ff(y,_.mode,I),x.return=_,_=x),o(_)):n(_,x)}return w}var Js=Hx(!0),Vx=Hx(!1),cc=_i(null),uc=null,Rs=null,Ch=null;function kh(){Ch=Rs=uc=null}function Ah(e){var t=cc.current;Ye(cc),e._currentValue=t}function p0(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Bs(e,t){uc=e,Ch=Rs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(rn=!0),e.firstContext=null)}function bn(e){var t=e._currentValue;if(Ch!==e)if(e={context:e,memoizedValue:t,next:null},Rs===null){if(uc===null)throw Error(Q(308));Rs=e,uc.dependencies={lanes:0,firstContext:e}}else Rs=Rs.next=e;return t}var Di=null;function Ih(e){Di===null?Di=[e]:Di.push(e)}function $x(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,Ih(t)):(n.next=i.next,i.next=n),t.interleaved=n,Fr(e,r)}function Fr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Gr=!1;function Rh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ii(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Fr(e,n)}return i=r.interleaved,i===null?(t.next=t,Ih(r)):(t.next=i.next,i.next=t),r.interleaved=t,Fr(e,n)}function zl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ph(e,n)}}function f1(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function fc(e,t,n,r){var i=e.updateQueue;Gr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=e.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=e,m=a;switch(f=t,p=n,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(p,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,f=typeof g=="function"?g.call(p,h,f):g,f==null)break e;h=rt({},h,f);break e;case 2:Gr=!0}}a.callback!==null&&a.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(1);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Gi|=o,e.lanes=o,e.memoizedState=h}}function h1(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Q(191,i));i.call(r)}}}var Ga={},fr=_i(Ga),ya=_i(Ga),wa=_i(Ga);function Pi(e){if(e===Ga)throw Error(Q(174));return e}function Nh(e,t){switch(Ge(wa,t),Ge(ya,e),Ge(fr,Ga),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Xf(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Xf(t,e)}Ye(fr),Ge(fr,t)}function Zs(){Ye(fr),Ye(ya),Ye(wa)}function Kx(e){Pi(wa.current);var t=Pi(fr.current),n=Xf(t,e.type);t!==n&&(Ge(ya,e),Ge(fr,n))}function Fh(e){ya.current===e&&(Ye(fr),Ye(ya))}var et=_i(0);function hc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var sf=[];function Oh(){for(var e=0;e<sf.length;e++)sf[e]._workInProgressVersionPrimary=null;sf.length=0}var Hl=jr.ReactCurrentDispatcher,of=jr.ReactCurrentBatchConfig,$i=0,nt=null,xt=null,wt=null,dc=!1,Ko=!1,Ea=0,aS=0;function Ut(){throw Error(Q(321))}function Dh(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!tr(e[n],t[n]))return!1;return!0}function Ph(e,t,n,r,i,s){if($i=s,nt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Hl.current=e===null||e.memoizedState===null?fS:hS,e=n(r,i),Ko){s=0;do{if(Ko=!1,Ea=0,25<=s)throw Error(Q(301));s+=1,wt=xt=null,t.updateQueue=null,Hl.current=dS,e=n(r,i)}while(Ko)}if(Hl.current=pc,t=xt!==null&&xt.next!==null,$i=0,wt=xt=nt=null,dc=!1,t)throw Error(Q(300));return e}function Lh(){var e=Ea!==0;return Ea=0,e}function ar(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?nt.memoizedState=wt=e:wt=wt.next=e,wt}function Mn(){if(xt===null){var e=nt.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=wt===null?nt.memoizedState:wt.next;if(t!==null)wt=t,xt=e;else{if(e===null)throw Error(Q(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},wt===null?nt.memoizedState=wt=e:wt=wt.next=e}return wt}function Ta(e,t){return typeof t=="function"?t(e):t}function af(e){var t=Mn(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=xt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if(($i&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,nt.lanes|=u,Gi|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,tr(r,t.memoizedState)||(rn=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,nt.lanes|=s,Gi|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function lf(e){var t=Mn(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);tr(s,t.memoizedState)||(rn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Xx(){}function Yx(e,t){var n=nt,r=Mn(),i=t(),s=!tr(r.memoizedState,i);if(s&&(r.memoizedState=i,rn=!0),r=r.queue,bh(Jx.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||wt!==null&&wt.memoizedState.tag&1){if(n.flags|=2048,Sa(9,Qx.bind(null,n,r,i,t),void 0,null),At===null)throw Error(Q(349));$i&30||qx(n,t,i)}return i}function qx(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=nt.updateQueue,t===null?(t={lastEffect:null,stores:null},nt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Qx(e,t,n,r){t.value=n,t.getSnapshot=r,Zx(t)&&ev(e)}function Jx(e,t,n){return n(function(){Zx(t)&&ev(e)})}function Zx(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tr(e,n)}catch{return!0}}function ev(e){var t=Fr(e,1);t!==null&&Jn(t,e,1,-1)}function d1(e){var t=ar();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ta,lastRenderedState:e},t.queue=e,e=e.dispatch=uS.bind(null,nt,e),[t.memoizedState,e]}function Sa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=nt.updateQueue,t===null?(t={lastEffect:null,stores:null},nt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function tv(){return Mn().memoizedState}function Vl(e,t,n,r){var i=ar();nt.flags|=e,i.memoizedState=Sa(1|t,n,void 0,r===void 0?null:r)}function su(e,t,n,r){var i=Mn();r=r===void 0?null:r;var s=void 0;if(xt!==null){var o=xt.memoizedState;if(s=o.destroy,r!==null&&Dh(r,o.deps)){i.memoizedState=Sa(t,n,s,r);return}}nt.flags|=e,i.memoizedState=Sa(1|t,n,s,r)}function p1(e,t){return Vl(8390656,8,e,t)}function bh(e,t){return su(2048,8,e,t)}function nv(e,t){return su(4,2,e,t)}function rv(e,t){return su(4,4,e,t)}function iv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function sv(e,t,n){return n=n!=null?n.concat([e]):null,su(4,4,iv.bind(null,t,e),n)}function Mh(){}function ov(e,t){var n=Mn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Dh(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function av(e,t){var n=Mn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Dh(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function lv(e,t,n){return $i&21?(tr(n,t)||(n=dx(),nt.lanes|=n,Gi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,rn=!0),e.memoizedState=n)}function lS(e,t){var n=Me;Me=n!==0&&4>n?n:4,e(!0);var r=of.transition;of.transition={};try{e(!1),t()}finally{Me=n,of.transition=r}}function cv(){return Mn().memoizedState}function cS(e,t,n){var r=oi(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},uv(e))fv(t,n);else if(n=$x(e,t,n,r),n!==null){var i=Qt();Jn(n,e,r,i),hv(n,t,r)}}function uS(e,t,n){var r=oi(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(uv(e))fv(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,tr(a,o)){var l=t.interleaved;l===null?(i.next=i,Ih(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=$x(e,t,i,r),n!==null&&(i=Qt(),Jn(n,e,r,i),hv(n,t,r))}}function uv(e){var t=e.alternate;return e===nt||t!==null&&t===nt}function fv(e,t){Ko=dc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function hv(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ph(e,n)}}var pc={readContext:bn,useCallback:Ut,useContext:Ut,useEffect:Ut,useImperativeHandle:Ut,useInsertionEffect:Ut,useLayoutEffect:Ut,useMemo:Ut,useReducer:Ut,useRef:Ut,useState:Ut,useDebugValue:Ut,useDeferredValue:Ut,useTransition:Ut,useMutableSource:Ut,useSyncExternalStore:Ut,useId:Ut,unstable_isNewReconciler:!1},fS={readContext:bn,useCallback:function(e,t){return ar().memoizedState=[e,t===void 0?null:t],e},useContext:bn,useEffect:p1,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Vl(4194308,4,iv.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vl(4,2,e,t)},useMemo:function(e,t){var n=ar();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ar();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=cS.bind(null,nt,e),[r.memoizedState,e]},useRef:function(e){var t=ar();return e={current:e},t.memoizedState=e},useState:d1,useDebugValue:Mh,useDeferredValue:function(e){return ar().memoizedState=e},useTransition:function(){var e=d1(!1),t=e[0];return e=lS.bind(null,e[1]),ar().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=nt,i=ar();if(Qe){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=t(),At===null)throw Error(Q(349));$i&30||qx(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,p1(Jx.bind(null,r,s,e),[e]),r.flags|=2048,Sa(9,Qx.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=ar(),t=At.identifierPrefix;if(Qe){var n=yr,r=_r;n=(r&~(1<<32-Qn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Ea++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=aS++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hS={readContext:bn,useCallback:ov,useContext:bn,useEffect:bh,useImperativeHandle:sv,useInsertionEffect:nv,useLayoutEffect:rv,useMemo:av,useReducer:af,useRef:tv,useState:function(){return af(Ta)},useDebugValue:Mh,useDeferredValue:function(e){var t=Mn();return lv(t,xt.memoizedState,e)},useTransition:function(){var e=af(Ta)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:Xx,useSyncExternalStore:Yx,useId:cv,unstable_isNewReconciler:!1},dS={readContext:bn,useCallback:ov,useContext:bn,useEffect:bh,useImperativeHandle:sv,useInsertionEffect:nv,useLayoutEffect:rv,useMemo:av,useReducer:lf,useRef:tv,useState:function(){return lf(Ta)},useDebugValue:Mh,useDeferredValue:function(e){var t=Mn();return xt===null?t.memoizedState=e:lv(t,xt.memoizedState,e)},useTransition:function(){var e=lf(Ta)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:Xx,useSyncExternalStore:Yx,useId:cv,unstable_isNewReconciler:!1};function Hn(e,t){if(e&&e.defaultProps){t=rt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function m0(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:rt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ou={isMounted:function(e){return(e=e._reactInternals)?ss(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Qt(),i=oi(e),s=Sr(r,i);s.payload=t,n!=null&&(s.callback=n),t=ii(e,s,i),t!==null&&(Jn(t,e,i,r),zl(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Qt(),i=oi(e),s=Sr(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=ii(e,s,i),t!==null&&(Jn(t,e,i,r),zl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Qt(),r=oi(e),i=Sr(n,r);i.tag=2,t!=null&&(i.callback=t),t=ii(e,i,r),t!==null&&(Jn(t,e,r,n),zl(t,e,r))}};function m1(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!ga(n,r)||!ga(i,s):!0}function dv(e,t,n){var r=!1,i=hi,s=t.contextType;return typeof s=="object"&&s!==null?s=bn(s):(i=ln(t)?Hi:Gt.current,r=t.contextTypes,s=(r=r!=null)?qs(e,i):hi),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ou,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function g1(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ou.enqueueReplaceState(t,t.state,null)}function g0(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Rh(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=bn(s):(s=ln(t)?Hi:Gt.current,i.context=qs(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(m0(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ou.enqueueReplaceState(i,i.state,null),fc(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function eo(e,t){try{var n="",r=t;do n+=WE(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function cf(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function x0(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pS=typeof WeakMap=="function"?WeakMap:Map;function pv(e,t,n){n=Sr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){gc||(gc=!0,A0=r),x0(e,t)},n}function mv(e,t,n){n=Sr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){x0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){x0(e,t),typeof r!="function"&&(si===null?si=new Set([this]):si.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function x1(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new pS;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=IS.bind(null,e,t,n),t.then(e,e))}function v1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function _1(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Sr(-1,1),t.tag=2,ii(n,t,1))),n.lanes|=1),e)}var mS=jr.ReactCurrentOwner,rn=!1;function Xt(e,t,n,r){t.child=e===null?Vx(t,null,n,r):Js(t,e.child,n,r)}function y1(e,t,n,r,i){n=n.render;var s=t.ref;return Bs(t,i),r=Ph(e,t,n,r,s,i),n=Lh(),e!==null&&!rn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Or(e,t,i)):(Qe&&n&&Eh(t),t.flags|=1,Xt(e,t,r,i),t.child)}function w1(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!$h(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,gv(e,t,s,r,i)):(e=Xl(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ga,n(o,r)&&e.ref===t.ref)return Or(e,t,i)}return t.flags|=1,e=ai(s,r),e.ref=t.ref,e.return=t,t.child=e}function gv(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(ga(s,r)&&e.ref===t.ref)if(rn=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(rn=!0);else return t.lanes=e.lanes,Or(e,t,i)}return v0(e,t,n,r,i)}function xv(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(Fs,gn),gn|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ge(Fs,gn),gn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ge(Fs,gn),gn|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ge(Fs,gn),gn|=r;return Xt(e,t,i,n),t.child}function vv(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function v0(e,t,n,r,i){var s=ln(n)?Hi:Gt.current;return s=qs(t,s),Bs(t,i),n=Ph(e,t,n,r,s,i),r=Lh(),e!==null&&!rn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Or(e,t,i)):(Qe&&r&&Eh(t),t.flags|=1,Xt(e,t,n,i),t.child)}function E1(e,t,n,r,i){if(ln(n)){var s=!0;oc(t)}else s=!1;if(Bs(t,i),t.stateNode===null)$l(e,t),dv(t,n,r),g0(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=bn(c):(c=ln(n)?Hi:Gt.current,c=qs(t,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&g1(t,o,r,c),Gr=!1;var f=t.memoizedState;o.state=f,fc(t,r,o,i),l=t.memoizedState,a!==r||f!==l||an.current||Gr?(typeof u=="function"&&(m0(t,n,u,r),l=t.memoizedState),(a=Gr||m1(t,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Gx(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Hn(t.type,a),o.props=c,h=t.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=bn(l):(l=ln(n)?Hi:Gt.current,l=qs(t,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&g1(t,o,r,l),Gr=!1,f=t.memoizedState,o.state=f,fc(t,r,o,i);var g=t.memoizedState;a!==h||f!==g||an.current||Gr?(typeof p=="function"&&(m0(t,n,p,r),g=t.memoizedState),(c=Gr||m1(t,n,c,r,f,g,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),o.props=r,o.state=g,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return _0(e,t,n,r,s,i)}function _0(e,t,n,r,i,s){vv(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&a1(t,n,!1),Or(e,t,s);r=t.stateNode,mS.current=t;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Js(t,e.child,null,s),t.child=Js(t,null,a,s)):Xt(e,t,a,s),t.memoizedState=r.state,i&&a1(t,n,!0),t.child}function _v(e){var t=e.stateNode;t.pendingContext?o1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&o1(e,t.context,!1),Nh(e,t.containerInfo)}function T1(e,t,n,r,i){return Qs(),Sh(i),t.flags|=256,Xt(e,t,n,r),t.child}var y0={dehydrated:null,treeContext:null,retryLane:0};function w0(e){return{baseLanes:e,cachePool:null,transitions:null}}function yv(e,t,n){var r=t.pendingProps,i=et.current,s=!1,o=(t.flags&128)!==0,a;if((a=o)||(a=e!==null&&e.memoizedState===null?!1:(i&2)!==0),a?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ge(et,i&1),e===null)return d0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cu(o,r,0,null),e=ji(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=w0(n),t.memoizedState=y0,e):Bh(t,o));if(i=e.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return gS(e,t,o,r,a,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=ai(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ai(a,s):(s=ji(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?w0(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=y0,r}return s=e.child,e=s.sibling,r=ai(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Bh(e,t){return t=cu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function wl(e,t,n,r){return r!==null&&Sh(r),Js(t,e.child,null,n),e=Bh(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function gS(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=cf(Error(Q(422))),wl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=cu({mode:"visible",children:r.children},i,0,null),s=ji(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&Js(t,e.child,null,o),t.child.memoizedState=w0(o),t.memoizedState=y0,s);if(!(t.mode&1))return wl(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Q(419)),r=cf(s,r,void 0),wl(e,t,o,r)}if(a=(o&e.childLanes)!==0,rn||a){if(r=At,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Fr(e,i),Jn(r,e,i,-1))}return Vh(),r=cf(Error(Q(421))),wl(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=RS.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,wn=ri(i.nextSibling),En=t,Qe=!0,$n=null,e!==null&&(Fn[On++]=_r,Fn[On++]=yr,Fn[On++]=Vi,_r=e.id,yr=e.overflow,Vi=t),t=Bh(t,r.children),t.flags|=4096,t)}function S1(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),p0(e.return,t,n)}function uf(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function wv(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Xt(e,t,r.children,n),r=et.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&S1(e,n,t);else if(e.tag===19)S1(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ge(et,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&hc(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),uf(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&hc(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}uf(t,!0,n,null,s);break;case"together":uf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function $l(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Or(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Gi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,n=ai(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ai(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function xS(e,t,n){switch(t.tag){case 3:_v(t),Qs();break;case 5:Kx(t);break;case 1:ln(t.type)&&oc(t);break;case 4:Nh(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ge(cc,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ge(et,et.current&1),t.flags|=128,null):n&t.child.childLanes?yv(e,t,n):(Ge(et,et.current&1),e=Or(e,t,n),e!==null?e.sibling:null);Ge(et,et.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return wv(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ge(et,et.current),r)break;return null;case 22:case 23:return t.lanes=0,xv(e,t,n)}return Or(e,t,n)}var Ev,E0,Tv,Sv;Ev=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};E0=function(){};Tv=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Pi(fr.current);var s=null;switch(n){case"input":i=Vf(e,i),r=Vf(e,r),s=[];break;case"select":i=rt({},i,{value:void 0}),r=rt({},r,{value:void 0}),s=[];break;case"textarea":i=Kf(e,i),r=Kf(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ic)}Yf(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ca.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ca.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ke("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Sv=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ro(e,t){if(!Qe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Wt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function vS(e,t,n){var r=t.pendingProps;switch(Th(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(t),null;case 1:return ln(t.type)&&sc(),Wt(t),null;case 3:return r=t.stateNode,Zs(),Ye(an),Ye(Gt),Oh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(_l(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,$n!==null&&(N0($n),$n=null))),E0(e,t),Wt(t),null;case 5:Fh(t);var i=Pi(wa.current);if(n=t.type,e!==null&&t.stateNode!=null)Tv(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Q(166));return Wt(t),null}if(e=Pi(fr.current),_l(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[lr]=t,r[_a]=s,e=(t.mode&1)!==0,n){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(i=0;i<Uo.length;i++)Ke(Uo[i],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":Dp(r,s),Ke("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ke("invalid",r);break;case"textarea":Lp(r,s),Ke("invalid",r)}Yf(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&vl(r.textContent,a,e),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&vl(r.textContent,a,e),i=["children",""+a]):ca.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ke("scroll",r)}switch(n){case"input":ul(r),Pp(r,s,!0);break;case"textarea":ul(r),bp(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ic)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Jg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[lr]=t,e[_a]=r,Ev(e,t,!1,!1),t.stateNode=e;e:{switch(o=qf(n,r),n){case"dialog":Ke("cancel",e),Ke("close",e),i=r;break;case"iframe":case"object":case"embed":Ke("load",e),i=r;break;case"video":case"audio":for(i=0;i<Uo.length;i++)Ke(Uo[i],e);i=r;break;case"source":Ke("error",e),i=r;break;case"img":case"image":case"link":Ke("error",e),Ke("load",e),i=r;break;case"details":Ke("toggle",e),i=r;break;case"input":Dp(e,r),i=Vf(e,r),Ke("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=rt({},r,{value:void 0}),Ke("invalid",e);break;case"textarea":Lp(e,r),i=Kf(e,r),Ke("invalid",e);break;default:i=r}Yf(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?tx(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Zg(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ua(e,l):typeof l=="number"&&ua(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ca.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ke("scroll",e):l!=null&&lh(e,s,l,o))}switch(n){case"input":ul(e),Pp(e,r,!1);break;case"textarea":ul(e),bp(e);break;case"option":r.value!=null&&e.setAttribute("value",""+fi(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Ps(e,!!r.multiple,s,!1):r.defaultValue!=null&&Ps(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ic)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Wt(t),null;case 6:if(e&&t.stateNode!=null)Sv(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Q(166));if(n=Pi(wa.current),Pi(fr.current),_l(t)){if(r=t.stateNode,n=t.memoizedProps,r[lr]=t,(s=r.nodeValue!==n)&&(e=En,e!==null))switch(e.tag){case 3:vl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vl(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[lr]=t,t.stateNode=r}return Wt(t),null;case 13:if(Ye(et),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Qe&&wn!==null&&t.mode&1&&!(t.flags&128))zx(),Qs(),t.flags|=98560,s=!1;else if(s=_l(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(Q(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Q(317));s[lr]=t}else Qs(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Wt(t),s=!1}else $n!==null&&(N0($n),$n=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||et.current&1?_t===0&&(_t=3):Vh())),t.updateQueue!==null&&(t.flags|=4),Wt(t),null);case 4:return Zs(),E0(e,t),e===null&&xa(t.stateNode.containerInfo),Wt(t),null;case 10:return Ah(t.type._context),Wt(t),null;case 17:return ln(t.type)&&sc(),Wt(t),null;case 19:if(Ye(et),s=t.memoizedState,s===null)return Wt(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)Ro(s,!1);else{if(_t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=hc(e),o!==null){for(t.flags|=128,Ro(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ge(et,et.current&1|2),t.child}e=e.sibling}s.tail!==null&&ft()>to&&(t.flags|=128,r=!0,Ro(s,!1),t.lanes=4194304)}else{if(!r)if(e=hc(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ro(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Qe)return Wt(t),null}else 2*ft()-s.renderingStartTime>to&&n!==1073741824&&(t.flags|=128,r=!0,Ro(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ft(),t.sibling=null,n=et.current,Ge(et,r?n&1|2:n&1),t):(Wt(t),null);case 22:case 23:return Hh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?gn&1073741824&&(Wt(t),t.subtreeFlags&6&&(t.flags|=8192)):Wt(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function _S(e,t){switch(Th(t),t.tag){case 1:return ln(t.type)&&sc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zs(),Ye(an),Ye(Gt),Oh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Fh(t),null;case 13:if(Ye(et),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));Qs()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ye(et),null;case 4:return Zs(),null;case 10:return Ah(t.type._context),null;case 22:case 23:return Hh(),null;case 24:return null;default:return null}}var El=!1,zt=!1,yS=typeof WeakSet=="function"?WeakSet:Set,fe=null;function Ns(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){st(e,t,r)}else n.current=null}function T0(e,t,n){try{n()}catch(r){st(e,t,r)}}var C1=!1;function wS(e,t){if(o0=tc,e=Rx(),wh(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=e,f=null;t:for(;;){for(var p;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===i&&(a=o),f===s&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(a0={focusedElem:e,selectionRange:n},tc=!1,fe=t;fe!==null;)if(t=fe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,fe=e;else for(;fe!==null;){t=fe;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,w=g.memoizedState,_=t.stateNode,x=_.getSnapshotBeforeUpdate(t.elementType===t.type?m:Hn(t.type,m),w);_.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(I){st(t,t.return,I)}if(e=t.sibling,e!==null){e.return=t.return,fe=e;break}fe=t.return}return g=C1,C1=!1,g}function Xo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&T0(t,n,s)}i=i.next}while(i!==r)}}function au(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function S0(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Cv(e){var t=e.alternate;t!==null&&(e.alternate=null,Cv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[lr],delete t[_a],delete t[u0],delete t[rS],delete t[iS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kv(e){return e.tag===5||e.tag===3||e.tag===4}function k1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function C0(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ic));else if(r!==4&&(e=e.child,e!==null))for(C0(e,t,n),e=e.sibling;e!==null;)C0(e,t,n),e=e.sibling}function k0(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(k0(e,t,n),e=e.sibling;e!==null;)k0(e,t,n),e=e.sibling}var Rt=null,Vn=!1;function Hr(e,t,n){for(n=n.child;n!==null;)Av(e,t,n),n=n.sibling}function Av(e,t,n){if(ur&&typeof ur.onCommitFiberUnmount=="function")try{ur.onCommitFiberUnmount(Zc,n)}catch{}switch(n.tag){case 5:zt||Ns(n,t);case 6:var r=Rt,i=Vn;Rt=null,Hr(e,t,n),Rt=r,Vn=i,Rt!==null&&(Vn?(e=Rt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Rt.removeChild(n.stateNode));break;case 18:Rt!==null&&(Vn?(e=Rt,n=n.stateNode,e.nodeType===8?nf(e.parentNode,n):e.nodeType===1&&nf(e,n),pa(e)):nf(Rt,n.stateNode));break;case 4:r=Rt,i=Vn,Rt=n.stateNode.containerInfo,Vn=!0,Hr(e,t,n),Rt=r,Vn=i;break;case 0:case 11:case 14:case 15:if(!zt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&T0(n,t,o),i=i.next}while(i!==r)}Hr(e,t,n);break;case 1:if(!zt&&(Ns(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){st(n,t,a)}Hr(e,t,n);break;case 21:Hr(e,t,n);break;case 22:n.mode&1?(zt=(r=zt)||n.memoizedState!==null,Hr(e,t,n),zt=r):Hr(e,t,n);break;default:Hr(e,t,n)}}function A1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new yS),t.forEach(function(r){var i=NS.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Un(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,a=o;e:for(;a!==null;){switch(a.tag){case 5:Rt=a.stateNode,Vn=!1;break e;case 3:Rt=a.stateNode.containerInfo,Vn=!0;break e;case 4:Rt=a.stateNode.containerInfo,Vn=!0;break e}a=a.return}if(Rt===null)throw Error(Q(160));Av(s,o,i),Rt=null,Vn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){st(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Iv(t,e),t=t.sibling}function Iv(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Un(t,e),rr(e),r&4){try{Xo(3,e,e.return),au(3,e)}catch(m){st(e,e.return,m)}try{Xo(5,e,e.return)}catch(m){st(e,e.return,m)}}break;case 1:Un(t,e),rr(e),r&512&&n!==null&&Ns(n,n.return);break;case 5:if(Un(t,e),rr(e),r&512&&n!==null&&Ns(n,n.return),e.flags&32){var i=e.stateNode;try{ua(i,"")}catch(m){st(e,e.return,m)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,a=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&qg(i,s),qf(a,o);var c=qf(a,s);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?tx(i,h):u==="dangerouslySetInnerHTML"?Zg(i,h):u==="children"?ua(i,h):lh(i,u,h,c)}switch(a){case"input":$f(i,s);break;case"textarea":Qg(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Ps(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?Ps(i,!!s.multiple,s.defaultValue,!0):Ps(i,!!s.multiple,s.multiple?[]:"",!1))}i[_a]=s}catch(m){st(e,e.return,m)}}break;case 6:if(Un(t,e),rr(e),r&4){if(e.stateNode===null)throw Error(Q(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){st(e,e.return,m)}}break;case 3:if(Un(t,e),rr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pa(t.containerInfo)}catch(m){st(e,e.return,m)}break;case 4:Un(t,e),rr(e);break;case 13:Un(t,e),rr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Wh=ft())),r&4&&A1(e);break;case 22:if(u=n!==null&&n.memoizedState!==null,e.mode&1?(zt=(c=zt)||u,Un(t,e),zt=c):Un(t,e),rr(e),r&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(fe=e,u=e.child;u!==null;){for(h=fe=u;fe!==null;){switch(f=fe,p=f.child,f.tag){case 0:case 11:case 14:case 15:Xo(4,f,f.return);break;case 1:Ns(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){st(r,n,m)}}break;case 5:Ns(f,f.return);break;case 22:if(f.memoizedState!==null){R1(h);continue}}p!==null?(p.return=f,fe=p):R1(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ex("display",o))}catch(m){st(e,e.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){st(e,e.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Un(t,e),rr(e),r&4&&A1(e);break;case 21:break;default:Un(t,e),rr(e)}}function rr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(kv(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ua(i,""),r.flags&=-33);var s=k1(e);k0(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=k1(e);C0(e,a,o);break;default:throw Error(Q(161))}}catch(l){st(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ES(e,t,n){fe=e,Rv(e)}function Rv(e,t,n){for(var r=(e.mode&1)!==0;fe!==null;){var i=fe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||El;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||zt;a=El;var c=zt;if(El=o,(zt=l)&&!c)for(fe=i;fe!==null;)o=fe,l=o.child,o.tag===22&&o.memoizedState!==null?N1(i):l!==null?(l.return=o,fe=l):N1(i);for(;s!==null;)fe=s,Rv(s),s=s.sibling;fe=i,El=a,zt=c}I1(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,fe=s):I1(e)}}function I1(e){for(;fe!==null;){var t=fe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:zt||au(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!zt)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Hn(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&h1(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}h1(t,o,n)}break;case 5:var a=t.stateNode;if(n===null&&t.flags&4){n=a;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&pa(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}zt||t.flags&512&&S0(t)}catch(f){st(t,t.return,f)}}if(t===e){fe=null;break}if(n=t.sibling,n!==null){n.return=t.return,fe=n;break}fe=t.return}}function R1(e){for(;fe!==null;){var t=fe;if(t===e){fe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,fe=n;break}fe=t.return}}function N1(e){for(;fe!==null;){var t=fe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(l){st(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){st(t,i,l)}}var s=t.return;try{S0(t)}catch(l){st(t,s,l)}break;case 5:var o=t.return;try{S0(t)}catch(l){st(t,o,l)}}}catch(l){st(t,t.return,l)}if(t===e){fe=null;break}var a=t.sibling;if(a!==null){a.return=t.return,fe=a;break}fe=t.return}}var TS=Math.ceil,mc=jr.ReactCurrentDispatcher,jh=jr.ReactCurrentOwner,Pn=jr.ReactCurrentBatchConfig,Re=0,At=null,dt=null,Lt=0,gn=0,Fs=_i(0),_t=0,Ca=null,Gi=0,lu=0,Uh=0,Yo=null,nn=null,Wh=0,to=1/0,xr=null,gc=!1,A0=null,si=null,Tl=!1,Qr=null,xc=0,qo=0,I0=null,Gl=-1,Kl=0;function Qt(){return Re&6?ft():Gl!==-1?Gl:Gl=ft()}function oi(e){return e.mode&1?Re&2&&Lt!==0?Lt&-Lt:oS.transition!==null?(Kl===0&&(Kl=dx()),Kl):(e=Me,e!==0||(e=window.event,e=e===void 0?16:yx(e.type)),e):1}function Jn(e,t,n,r){if(50<qo)throw qo=0,I0=null,Error(Q(185));Ha(e,n,r),(!(Re&2)||e!==At)&&(e===At&&(!(Re&2)&&(lu|=n),_t===4&&Xr(e,Lt)),cn(e,r),n===1&&Re===0&&!(t.mode&1)&&(to=ft()+500,iu&&yi()))}function cn(e,t){var n=e.callbackNode;oT(e,t);var r=ec(e,e===At?Lt:0);if(r===0)n!==null&&jp(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&jp(n),t===1)e.tag===0?sS(F1.bind(null,e)):jx(F1.bind(null,e)),tS(function(){!(Re&6)&&yi()}),n=null;else{switch(px(r)){case 1:n=dh;break;case 4:n=fx;break;case 16:n=Zl;break;case 536870912:n=hx;break;default:n=Zl}n=Mv(n,Nv.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Nv(e,t){if(Gl=-1,Kl=0,Re&6)throw Error(Q(327));var n=e.callbackNode;if(js()&&e.callbackNode!==n)return null;var r=ec(e,e===At?Lt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=vc(e,r);else{t=r;var i=Re;Re|=2;var s=Ov();(At!==e||Lt!==t)&&(xr=null,to=ft()+500,Bi(e,t));do try{kS();break}catch(a){Fv(e,a)}while(1);kh(),mc.current=s,Re=i,dt!==null?t=0:(At=null,Lt=0,t=_t)}if(t!==0){if(t===2&&(i=t0(e),i!==0&&(r=i,t=R0(e,i))),t===1)throw n=Ca,Bi(e,0),Xr(e,r),cn(e,ft()),n;if(t===6)Xr(e,r);else{if(i=e.current.alternate,!(r&30)&&!SS(i)&&(t=vc(e,r),t===2&&(s=t0(e),s!==0&&(r=s,t=R0(e,s))),t===1))throw n=Ca,Bi(e,0),Xr(e,r),cn(e,ft()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(Q(345));case 2:Ai(e,nn,xr);break;case 3:if(Xr(e,r),(r&130023424)===r&&(t=Wh+500-ft(),10<t)){if(ec(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Qt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=c0(Ai.bind(null,e,nn,xr),t);break}Ai(e,nn,xr);break;case 4:if(Xr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-Qn(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TS(r/1960))-r,10<r){e.timeoutHandle=c0(Ai.bind(null,e,nn,xr),r);break}Ai(e,nn,xr);break;case 5:Ai(e,nn,xr);break;default:throw Error(Q(329))}}}return cn(e,ft()),e.callbackNode===n?Nv.bind(null,e):null}function R0(e,t){var n=Yo;return e.current.memoizedState.isDehydrated&&(Bi(e,t).flags|=256),e=vc(e,t),e!==2&&(t=nn,nn=n,t!==null&&N0(t)),e}function N0(e){nn===null?nn=e:nn.push.apply(nn,e)}function SS(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!tr(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xr(e,t){for(t&=~Uh,t&=~lu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Qn(t),r=1<<n;e[n]=-1,t&=~r}}function F1(e){if(Re&6)throw Error(Q(327));js();var t=ec(e,0);if(!(t&1))return cn(e,ft()),null;var n=vc(e,t);if(e.tag!==0&&n===2){var r=t0(e);r!==0&&(t=r,n=R0(e,r))}if(n===1)throw n=Ca,Bi(e,0),Xr(e,t),cn(e,ft()),n;if(n===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ai(e,nn,xr),cn(e,ft()),null}function zh(e,t){var n=Re;Re|=1;try{return e(t)}finally{Re=n,Re===0&&(to=ft()+500,iu&&yi())}}function Ki(e){Qr!==null&&Qr.tag===0&&!(Re&6)&&js();var t=Re;Re|=1;var n=Pn.transition,r=Me;try{if(Pn.transition=null,Me=1,e)return e()}finally{Me=r,Pn.transition=n,Re=t,!(Re&6)&&yi()}}function Hh(){gn=Fs.current,Ye(Fs)}function Bi(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,eS(n)),dt!==null)for(n=dt.return;n!==null;){var r=n;switch(Th(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&sc();break;case 3:Zs(),Ye(an),Ye(Gt),Oh();break;case 5:Fh(r);break;case 4:Zs();break;case 13:Ye(et);break;case 19:Ye(et);break;case 10:Ah(r.type._context);break;case 22:case 23:Hh()}n=n.return}if(At=e,dt=e=ai(e.current,null),Lt=gn=t,_t=0,Ca=null,Uh=lu=Gi=0,nn=Yo=null,Di!==null){for(t=0;t<Di.length;t++)if(n=Di[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Di=null}return e}function Fv(e,t){do{var n=dt;try{if(kh(),Hl.current=pc,dc){for(var r=nt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}dc=!1}if($i=0,wt=xt=nt=null,Ko=!1,Ea=0,jh.current=null,n===null||n.return===null){_t=1,Ca=t,dt=null;break}e:{var s=e,o=n.return,a=n,l=t;if(t=Lt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=v1(o);if(p!==null){p.flags&=-257,_1(p,o,a,s,t),p.mode&1&&x1(s,c,t),t=p,l=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){x1(s,c,t),Vh();break e}l=Error(Q(426))}}else if(Qe&&a.mode&1){var w=v1(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),_1(w,o,a,s,t),Sh(eo(l,a));break e}}s=l=eo(l,a),_t!==4&&(_t=2),Yo===null?Yo=[s]:Yo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var _=pv(s,l,t);f1(s,_);break e;case 1:a=l;var x=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(si===null||!si.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var I=mv(s,a,t);f1(s,I);break e}}s=s.return}while(s!==null)}Pv(n)}catch(O){t=O,dt===n&&n!==null&&(dt=n=n.return);continue}break}while(1)}function Ov(){var e=mc.current;return mc.current=pc,e===null?pc:e}function Vh(){(_t===0||_t===3||_t===2)&&(_t=4),At===null||!(Gi&268435455)&&!(lu&268435455)||Xr(At,Lt)}function vc(e,t){var n=Re;Re|=2;var r=Ov();(At!==e||Lt!==t)&&(xr=null,Bi(e,t));do try{CS();break}catch(i){Fv(e,i)}while(1);if(kh(),Re=n,mc.current=r,dt!==null)throw Error(Q(261));return At=null,Lt=0,_t}function CS(){for(;dt!==null;)Dv(dt)}function kS(){for(;dt!==null&&!QE();)Dv(dt)}function Dv(e){var t=bv(e.alternate,e,gn);e.memoizedProps=e.pendingProps,t===null?Pv(e):dt=t,jh.current=null}function Pv(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=_S(n,t),n!==null){n.flags&=32767,dt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,dt=null;return}}else if(n=vS(n,t,gn),n!==null){dt=n;return}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);_t===0&&(_t=5)}function Ai(e,t,n){var r=Me,i=Pn.transition;try{Pn.transition=null,Me=1,AS(e,t,n,r)}finally{Pn.transition=i,Me=r}return null}function AS(e,t,n,r){do js();while(Qr!==null);if(Re&6)throw Error(Q(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(aT(e,s),e===At&&(dt=At=null,Lt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Tl||(Tl=!0,Mv(Zl,function(){return js(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Pn.transition,Pn.transition=null;var o=Me;Me=1;var a=Re;Re|=4,jh.current=null,wS(e,n),Iv(n,e),KT(a0),tc=!!o0,a0=o0=null,e.current=n,ES(n),JE(),Re=a,Me=o,Pn.transition=s}else e.current=n;if(Tl&&(Tl=!1,Qr=e,xc=i),s=e.pendingLanes,s===0&&(si=null),tT(n.stateNode),cn(e,ft()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(gc)throw gc=!1,e=A0,A0=null,e;return xc&1&&e.tag!==0&&js(),s=e.pendingLanes,s&1?e===I0?qo++:(qo=0,I0=e):qo=0,yi(),null}function js(){if(Qr!==null){var e=px(xc),t=Pn.transition,n=Me;try{if(Pn.transition=null,Me=16>e?16:e,Qr===null)var r=!1;else{if(e=Qr,Qr=null,xc=0,Re&6)throw Error(Q(331));var i=Re;for(Re|=4,fe=e.current;fe!==null;){var s=fe,o=s.child;if(fe.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(fe=c;fe!==null;){var u=fe;switch(u.tag){case 0:case 11:case 15:Xo(8,u,s)}var h=u.child;if(h!==null)h.return=u,fe=h;else for(;fe!==null;){u=fe;var f=u.sibling,p=u.return;if(Cv(u),u===c){fe=null;break}if(f!==null){f.return=p,fe=f;break}fe=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}fe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,fe=o;else e:for(;fe!==null;){if(s=fe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xo(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,fe=_;break e}fe=s.return}}var x=e.current;for(fe=x;fe!==null;){o=fe;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,fe=y;else e:for(o=x;fe!==null;){if(a=fe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:au(9,a)}}catch(O){st(a,a.return,O)}if(a===o){fe=null;break e}var I=a.sibling;if(I!==null){I.return=a.return,fe=I;break e}fe=a.return}}if(Re=i,yi(),ur&&typeof ur.onPostCommitFiberRoot=="function")try{ur.onPostCommitFiberRoot(Zc,e)}catch{}r=!0}return r}finally{Me=n,Pn.transition=t}}return!1}function O1(e,t,n){t=eo(n,t),t=pv(e,t,1),e=ii(e,t,1),t=Qt(),e!==null&&(Ha(e,1,t),cn(e,t))}function st(e,t,n){if(e.tag===3)O1(e,e,n);else for(;t!==null;){if(t.tag===3){O1(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(si===null||!si.has(r))){e=eo(n,e),e=mv(t,e,1),t=ii(t,e,1),e=Qt(),t!==null&&(Ha(t,1,e),cn(t,e));break}}t=t.return}}function IS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Qt(),e.pingedLanes|=e.suspendedLanes&n,At===e&&(Lt&n)===n&&(_t===4||_t===3&&(Lt&130023424)===Lt&&500>ft()-Wh?Bi(e,0):Uh|=n),cn(e,t)}function Lv(e,t){t===0&&(e.mode&1?(t=dl,dl<<=1,!(dl&130023424)&&(dl=4194304)):t=1);var n=Qt();e=Fr(e,t),e!==null&&(Ha(e,t,n),cn(e,n))}function RS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Lv(e,n)}function NS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(t),Lv(e,n)}var bv;bv=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||an.current)rn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return rn=!1,xS(e,t,n);rn=!!(e.flags&131072)}else rn=!1,Qe&&t.flags&1048576&&Ux(t,lc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;$l(e,t),e=t.pendingProps;var i=qs(t,Gt.current);Bs(t,n),i=Ph(null,t,r,e,i,n);var s=Lh();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ln(r)?(s=!0,oc(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Rh(t),i.updater=ou,t.stateNode=i,i._reactInternals=t,g0(t,r,e,n),t=_0(null,t,r,!0,s,n)):(t.tag=0,Qe&&s&&Eh(t),Xt(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch($l(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=OS(r),e=Hn(r,e),i){case 0:t=v0(null,t,r,e,n);break e;case 1:t=E1(null,t,r,e,n);break e;case 11:t=y1(null,t,r,e,n);break e;case 14:t=w1(null,t,r,Hn(r.type,e),n);break e}throw Error(Q(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Hn(r,i),v0(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Hn(r,i),E1(e,t,r,i,n);case 3:e:{if(_v(t),e===null)throw Error(Q(387));r=t.pendingProps,s=t.memoizedState,i=s.element,Gx(e,t),fc(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=eo(Error(Q(423)),t),t=T1(e,t,r,n,i);break e}else if(r!==i){i=eo(Error(Q(424)),t),t=T1(e,t,r,n,i);break e}else for(wn=ri(t.stateNode.containerInfo.firstChild),En=t,Qe=!0,$n=null,n=Vx(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qs(),r===i){t=Or(e,t,n);break e}Xt(e,t,r,n)}t=t.child}return t;case 5:return Kx(t),e===null&&d0(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,l0(r,i)?o=null:s!==null&&l0(r,s)&&(t.flags|=32),vv(e,t),Xt(e,t,o,n),t.child;case 6:return e===null&&d0(t),null;case 13:return yv(e,t,n);case 4:return Nh(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Js(t,null,r,n):Xt(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Hn(r,i),y1(e,t,r,i,n);case 7:return Xt(e,t,t.pendingProps,n),t.child;case 8:return Xt(e,t,t.pendingProps.children,n),t.child;case 12:return Xt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ge(cc,r._currentValue),r._currentValue=o,s!==null)if(tr(s.value,o)){if(s.children===i.children&&!an.current){t=Or(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Sr(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),p0(s.return,n,t),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Q(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),p0(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Xt(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Bs(t,n),i=bn(i),r=r(i),t.flags|=1,Xt(e,t,r,n),t.child;case 14:return r=t.type,i=Hn(r,t.pendingProps),i=Hn(r.type,i),w1(e,t,r,i,n);case 15:return gv(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Hn(r,i),$l(e,t),t.tag=1,ln(r)?(e=!0,oc(t)):e=!1,Bs(t,n),dv(t,r,i),g0(t,r,i,n),_0(null,t,r,!0,e,n);case 19:return wv(e,t,n);case 22:return xv(e,t,n)}throw Error(Q(156,t.tag))};function Mv(e,t){return ux(e,t)}function FS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(e,t,n,r){return new FS(e,t,n,r)}function $h(e){return e=e.prototype,!(!e||!e.isReactComponent)}function OS(e){if(typeof e=="function")return $h(e)?1:0;if(e!=null){if(e=e.$$typeof,e===uh)return 11;if(e===fh)return 14}return 2}function ai(e,t){var n=e.alternate;return n===null?(n=Dn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Xl(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")$h(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ws:return ji(n.children,i,s,t);case ch:o=8,i|=8;break;case Uf:return e=Dn(12,n,t,i|2),e.elementType=Uf,e.lanes=s,e;case Wf:return e=Dn(13,n,t,i),e.elementType=Wf,e.lanes=s,e;case zf:return e=Dn(19,n,t,i),e.elementType=zf,e.lanes=s,e;case Kg:return cu(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $g:o=10;break e;case Gg:o=9;break e;case uh:o=11;break e;case fh:o=14;break e;case $r:o=16,r=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=Dn(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function ji(e,t,n,r){return e=Dn(7,e,r,t),e.lanes=n,e}function cu(e,t,n,r){return e=Dn(22,e,r,t),e.elementType=Kg,e.lanes=n,e.stateNode={isHidden:!1},e}function ff(e,t,n){return e=Dn(6,e,null,t),e.lanes=n,e}function hf(e,t,n){return t=Dn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function DS(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$u(0),this.expirationTimes=$u(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$u(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Gh(e,t,n,r,i,s,o,a,l){return e=new DS(e,t,n,a,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Dn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rh(s),e}function PS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ys,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Bv(e){if(!e)return hi;e=e._reactInternals;e:{if(ss(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ln(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var n=e.type;if(ln(n))return Bx(e,n,t)}return t}function jv(e,t,n,r,i,s,o,a,l){return e=Gh(n,r,!0,e,i,s,o,a,l),e.context=Bv(null),n=e.current,r=Qt(),i=oi(n),s=Sr(r,i),s.callback=t??null,ii(n,s,i),e.current.lanes=i,Ha(e,i,r),cn(e,r),e}function uu(e,t,n,r){var i=t.current,s=Qt(),o=oi(i);return n=Bv(n),t.context===null?t.context=n:t.pendingContext=n,t=Sr(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ii(i,t,o),e!==null&&(Jn(e,i,o,s),zl(e,i,o)),o}function _c(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function D1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Kh(e,t){D1(e,t),(e=e.alternate)&&D1(e,t)}function LS(){return null}var Uv=typeof reportError=="function"?reportError:function(e){console.error(e)};function Xh(e){this._internalRoot=e}fu.prototype.render=Xh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));uu(e,t,null,null)};fu.prototype.unmount=Xh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ki(function(){uu(null,e,null,null)}),t[Nr]=null}};function fu(e){this._internalRoot=e}fu.prototype.unstable_scheduleHydration=function(e){if(e){var t=xx();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Kr.length&&t!==0&&t<Kr[n].priority;n++);Kr.splice(n,0,e),n===0&&_x(e)}};function Yh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function P1(){}function bS(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=_c(o);s.call(c)}}var o=jv(t,r,e,0,null,!1,!1,"",P1);return e._reactRootContainer=o,e[Nr]=o.current,xa(e.nodeType===8?e.parentNode:e),Ki(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=_c(l);a.call(c)}}var l=Gh(e,0,!1,null,null,!1,!1,"",P1);return e._reactRootContainer=l,e[Nr]=l.current,xa(e.nodeType===8?e.parentNode:e),Ki(function(){uu(t,l,n,r)}),l}function du(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=_c(o);a.call(l)}}uu(t,o,e,i)}else o=bS(n,t,e,i,r);return _c(o)}mx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=jo(t.pendingLanes);n!==0&&(ph(t,n|1),cn(t,ft()),!(Re&6)&&(to=ft()+500,yi()))}break;case 13:Ki(function(){var r=Fr(e,1);if(r!==null){var i=Qt();Jn(r,e,1,i)}}),Kh(e,1)}};mh=function(e){if(e.tag===13){var t=Fr(e,134217728);if(t!==null){var n=Qt();Jn(t,e,134217728,n)}Kh(e,134217728)}};gx=function(e){if(e.tag===13){var t=oi(e),n=Fr(e,t);if(n!==null){var r=Qt();Jn(n,e,t,r)}Kh(e,t)}};xx=function(){return Me};vx=function(e,t){var n=Me;try{return Me=e,t()}finally{Me=n}};Jf=function(e,t,n){switch(t){case"input":if($f(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ru(r);if(!i)throw Error(Q(90));Yg(r),$f(r,i)}}}break;case"textarea":Qg(e,n);break;case"select":t=n.value,t!=null&&Ps(e,!!n.multiple,t,!1)}};ix=zh;sx=Ki;var MS={usingClientEntryPoint:!1,Events:[$a,Cs,ru,nx,rx,zh]},No={findFiberByHostInstance:Oi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BS={bundleType:No.bundleType,version:No.version,rendererPackageName:No.rendererPackageName,rendererConfig:No.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=lx(e),e===null?null:e.stateNode},findFiberByHostInstance:No.findFiberByHostInstance||LS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sl.isDisabled&&Sl.supportsFiber)try{Zc=Sl.inject(BS),ur=Sl}catch{}}kn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MS;kn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yh(t))throw Error(Q(200));return PS(e,t,null,n)};kn.createRoot=function(e,t){if(!Yh(e))throw Error(Q(299));var n=!1,r="",i=Uv;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Gh(e,1,!1,null,null,n,!1,r,i),e[Nr]=t.current,xa(e.nodeType===8?e.parentNode:e),new Xh(t)};kn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=lx(t),e=e===null?null:e.stateNode,e};kn.flushSync=function(e){return Ki(e)};kn.hydrate=function(e,t,n){if(!hu(t))throw Error(Q(200));return du(null,e,t,!0,n)};kn.hydrateRoot=function(e,t,n){if(!Yh(e))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Uv;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=jv(t,null,e,1,n??null,i,!1,s,o),e[Nr]=t.current,xa(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new fu(t)};kn.render=function(e,t,n){if(!hu(t))throw Error(Q(200));return du(null,e,t,!1,n)};kn.unmountComponentAtNode=function(e){if(!hu(e))throw Error(Q(40));return e._reactRootContainer?(Ki(function(){du(null,null,e,!1,function(){e._reactRootContainer=null,e[Nr]=null})}),!0):!1};kn.unstable_batchedUpdates=zh;kn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!hu(n))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return du(e,t,n,!1,r)};kn.version="18.3.1-next-f1338f8080-20240426";function Wv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Wv)}catch(e){console.error(e)}}Wv(),Wg.exports=kn;var zv=Wg.exports;const qh=Rg(zv);var L1=zv;Bf.createRoot=L1.createRoot,Bf.hydrateRoot=L1.hydrateRoot;const jS=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(e,t){if(!e)throw uo(t)},uo=function(e){return new Error("Firebase Database ("+Hv.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},US=function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=e[n++],o=e[n++],a=e[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(l&1023))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return t.join("")},Qh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const s=e[i],o=i+1<e.length,a=o?e[i+1]:0,l=i+2<e.length,c=l?e[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),r.push(n[u],n[h],n[f],n[p])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Vv(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):US(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const s=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const c=i<e.length?n[e.charAt(i)]:64;++i;const h=i<e.length?n[e.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new WS;const f=s<<2|a>>4;if(r.push(f),c!==64){const p=a<<4&240|c>>2;if(r.push(p),h!==64){const g=c<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class WS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $v=function(e){const t=Vv(e);return Qh.encodeByteArray(t,!0)},yc=function(e){return $v(e).replace(/\./g,"")},F0=function(e){try{return Qh.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(e){return Gv(void 0,e)}function Gv(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const n=t;return new Date(n.getTime());case Object:e===void 0&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)!t.hasOwnProperty(n)||!HS(n)||(e[n]=Gv(e[n],t[n]));return e}function HS(e){return e!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=()=>VS().__FIREBASE_DEFAULTS__,GS=()=>{if(typeof process>"u"||typeof process.env>"u")return;const e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},KS=()=>{if(typeof document>"u")return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=e&&F0(e[1]);return t&&JSON.parse(t)},Kv=()=>{try{return jS()||$S()||GS()||KS()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},XS=e=>{var t,n;return(n=(t=Kv())==null?void 0:t.emulatorHosts)==null?void 0:n[e]},Xv=e=>{const t=XS(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return t[0]==="["?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Yv=()=>{var e;return(e=Kv())==null?void 0:e.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,n)=>{this.resolve=t,this.reject=n})}wrapCallback(t){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(n):t(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function qv(e){return(await fetch(e,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qv(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e},a="";return[yc(JSON.stringify(n)),yc(JSON.stringify(o)),a].join(".")}const Qo={};function YS(){const e={prod:[],emulator:[]};for(const t of Object.keys(Qo))Qo[t]?e.emulator.push(t):e.prod.push(t);return e}function qS(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}let b1=!1;function Jv(e,t){if(typeof window>"u"||typeof document>"u"||!Ka(window.location.host)||Qo[e]===t||Qo[e]||b1)return;Qo[e]=t;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",s=YS().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{b1=!0,o()},f}function u(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=qS(r),p=n("text"),g=document.getElementById(p)||document.createElement("span"),m=n("learnmore"),w=document.getElementById(m)||document.createElement("a"),_=n("preprendIcon"),x=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const y=f.element;a(y),u(w,m);const I=c();l(x,_),y.append(x,g,w,I),document.body.appendChild(y)}s?(g.innerText="Preview backend disconnected.",x.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(x.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Zv(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(QS())}function JS(){const e=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof e=="object"&&e.id!==void 0}function ZS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function e_(){return Hv.NODE_ADMIN===!0}function t_(){try{return typeof indexedDB=="object"}catch{return!1}}function n_(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;t(((s=i.error)==null?void 0:s.message)||"")}}catch(n){t(n)}})}function eC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tC="FirebaseError";class wi extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=tC,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mu.prototype.create)}}class mu{constructor(t,n,r){this.service=t,this.serviceName=n,this.errors=r}create(t,...n){const r=n[0]||{},i=`${this.service}/${t}`,s=this.errors[t],o=s?nC(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new wi(i,a,r)}}function nC(e,t){return e.replace(rC,(n,r)=>{const i=t[r];return i!=null?String(i):`<${r}?>`})}const rC=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ka(e){return JSON.parse(e)}function Tt(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=ka(F0(s[0])||""),n=ka(F0(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:t,claims:n,data:r,signature:i}},iC=function(e){const t=r_(e),n=t.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},sC=function(e){const t=r_(e).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function no(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}function M1(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function wc(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Aa(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const s=e[i],o=t[i];if(B1(s)&&B1(o)){if(!Aa(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function B1(e){return e!==null&&typeof e=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(i=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,n){n||(n=0);const r=this.W_;if(typeof t=="string")for(let h=0;h<16;h++)r[h]=t.charCodeAt(n)<<24|t.charCodeAt(n+1)<<16|t.charCodeAt(n+2)<<8|t.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)r[h]=t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3],n+=4;for(let h=16;h<80;h++){const f=r[h-3]^r[h-8]^r[h-14]^r[h-16];r[h]=(f<<1|f>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):h<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);const f=(i<<5|i>>>27)+c+l+u+r[h]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=f}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(t,n){if(t==null)return;n===void 0&&(n=t.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<n;)if(s[o]=t.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=t[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const t=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)t[r]=this.chain_[i]>>s&255,++r;return t}}function Jh(e,t){return`${e} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,ee(r<e.length,"Surrogate pair missing trail surrogate.");const o=e.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},gu=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=1e3,uC=2,fC=4*60*60*1e3,hC=.5;function j1(e,t=cC,n=uC){const r=t*Math.pow(n,e),i=Math.round(hC*r*(Math.random()-.5)*2);return Math.min(fC,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(e){return e&&e._delegate?e._delegate:e}class hr{constructor(t,n,r){this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(t,n){this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const n=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(n)){const r=new pu;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(t){const n=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),r=(t==null?void 0:t.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(mC(t))try{this.getOrInitializeService({instanceIdentifier:Ii})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(t=Ii){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ii){return this.instances.has(t)}getOptions(t=Ii){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:n={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(t,n){const r=this.normalizeInstanceIdentifier(n),i=this.onInitCallbacks.get(r)??new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(t,n)}catch{}}getOrInitializeService({instanceIdentifier:t,options:n={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pC(t),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}return r||null}normalizeInstanceIdentifier(t=Ii){return this.component?this.component.multipleInstances?t:Ii:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pC(e){return e===Ii?void 0:e}function mC(e){return e.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const n=this.getProvider(t.name);if(n.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);n.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const n=new dC(t,this);return this.providers.set(t,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"})(Ve||(Ve={}));const xC={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},vC=Ve.INFO,_C={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},yC=(e,t,...n)=>{if(t<e.logLevel)return;const r=new Date().toISOString(),i=_C[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Zh{constructor(t){this.name=t,this._logLevel=vC,this._logHandler=yC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ve))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?xC[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...t),this._logHandler(this,Ve.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...t),this._logHandler(this,Ve.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...t),this._logHandler(this,Ve.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...t),this._logHandler(this,Ve.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...t),this._logHandler(this,Ve.ERROR,...t)}}const wC=(e,t)=>t.some(n=>e instanceof n);let U1,W1;function EC(){return U1||(U1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TC(){return W1||(W1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const i_=new WeakMap,O0=new WeakMap,s_=new WeakMap,df=new WeakMap,ed=new WeakMap;function SC(e){const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("success",s),e.removeEventListener("error",o)},s=()=>{n(li(e.result)),i()},o=()=>{r(e.error),i()};e.addEventListener("success",s),e.addEventListener("error",o)});return t.then(n=>{n instanceof IDBCursor&&i_.set(n,e)}).catch(()=>{}),ed.set(t,e),t}function CC(e){if(O0.has(e))return;const t=new Promise((n,r)=>{const i=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",o),e.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",s),e.addEventListener("error",o),e.addEventListener("abort",o)});O0.set(e,t)}let D0={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return O0.get(e);if(t==="objectStoreNames")return e.objectStoreNames||s_.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return li(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function kC(e){D0=e(D0)}function AC(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const r=e.call(pf(this),t,...n);return s_.set(r,t.sort?t.sort():[t]),li(r)}:TC().includes(e)?function(...t){return e.apply(pf(this),t),li(i_.get(this))}:function(...t){return li(e.apply(pf(this),t))}}function IC(e){return typeof e=="function"?AC(e):(e instanceof IDBTransaction&&CC(e),wC(e,EC())?new Proxy(e,D0):e)}function li(e){if(e instanceof IDBRequest)return SC(e);if(df.has(e))return df.get(e);const t=IC(e);return t!==e&&(df.set(e,t),ed.set(t,e)),t}const pf=e=>ed.get(e);function o_(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=li(o);return r&&o.addEventListener("upgradeneeded",l=>{r(li(o.result),l.oldVersion,l.newVersion,li(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const RC=["get","getKey","getAll","getAllKeys","count"],NC=["put","add","delete","clear"],mf=new Map;function z1(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(mf.get(t))return mf.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=NC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||RC.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return mf.set(t,s),s}kC(e=>({...e,get:(t,n,r)=>z1(t,n)||e.get(t,n,r),has:(t,n)=>!!z1(t,n)||e.has(t,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(OC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function OC(e){const t=e.getComponent();return(t==null?void 0:t.type)==="VERSION"}const P0="@firebase/app",H1="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dr=new Zh("@firebase/app"),DC="@firebase/app-compat",PC="@firebase/analytics-compat",LC="@firebase/analytics",bC="@firebase/app-check-compat",MC="@firebase/app-check",BC="@firebase/auth",jC="@firebase/auth-compat",UC="@firebase/database",WC="@firebase/data-connect",zC="@firebase/database-compat",HC="@firebase/functions",VC="@firebase/functions-compat",$C="@firebase/installations",GC="@firebase/installations-compat",KC="@firebase/messaging",XC="@firebase/messaging-compat",YC="@firebase/performance",qC="@firebase/performance-compat",QC="@firebase/remote-config",JC="@firebase/remote-config-compat",ZC="@firebase/storage",e4="@firebase/storage-compat",t4="@firebase/firestore",n4="@firebase/ai",r4="@firebase/firestore-compat",i4="firebase",s4="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="[DEFAULT]",o4={[P0]:"fire-core",[DC]:"fire-core-compat",[LC]:"fire-analytics",[PC]:"fire-analytics-compat",[MC]:"fire-app-check",[bC]:"fire-app-check-compat",[BC]:"fire-auth",[jC]:"fire-auth-compat",[UC]:"fire-rtdb",[WC]:"fire-data-connect",[zC]:"fire-rtdb-compat",[HC]:"fire-fn",[VC]:"fire-fn-compat",[$C]:"fire-iid",[GC]:"fire-iid-compat",[KC]:"fire-fcm",[XC]:"fire-fcm-compat",[YC]:"fire-perf",[qC]:"fire-perf-compat",[QC]:"fire-rc",[JC]:"fire-rc-compat",[ZC]:"fire-gcs",[e4]:"fire-gcs-compat",[t4]:"fire-fst",[r4]:"fire-fst-compat",[n4]:"fire-vertex","fire-js":"fire-js",[i4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ec=new Map,a4=new Map,b0=new Map;function V1(e,t){try{e.container.addComponent(t)}catch(n){Dr.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Pr(e){const t=e.name;if(b0.has(t))return Dr.debug(`There were multiple attempts to register component ${t}.`),!1;b0.set(t,e);for(const n of Ec.values())V1(n,e);for(const n of a4.values())V1(n,e);return!0}function fo(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function a_(e){return e==null?!1:e.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ci=new mu("app","Firebase",l4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(t,n,r){this._isDeleted=!1,this._options={...t},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new hr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ci.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_=s4;function c_(e,t={}){let n=e;typeof t!="object"&&(t={name:t});const r={name:L0,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!="string"||!i)throw ci.create("bad-app-name",{appName:String(i)});if(n||(n=Yv()),!n)throw ci.create("no-options");const s=Ec.get(i);if(s){if(Aa(n,s.options)&&Aa(r,s.config))return s;throw ci.create("duplicate-app",{appName:i})}const o=new gC(i);for(const l of b0.values())o.addComponent(l);const a=new c4(n,r,o);return Ec.set(i,a),a}function td(e=L0){const t=Ec.get(e);if(!t&&e===L0&&Yv())return c_();if(!t)throw ci.create("no-app",{appName:e});return t}function Ln(e,t,n){let r=o4[e]??e;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const o=[`Unable to register library "${r}" with version "${t}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Dr.warn(o.join(" "));return}Pr(new hr(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4="firebase-heartbeat-database",f4=1,Ia="firebase-heartbeat-store";let gf=null;function u_(){return gf||(gf=o_(u4,f4,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Ia)}catch(n){console.warn(n)}}}}).catch(e=>{throw ci.create("idb-open",{originalErrorMessage:e.message})})),gf}async function h4(e){try{const n=(await u_()).transaction(Ia),r=await n.objectStore(Ia).get(f_(e));return await n.done,r}catch(t){if(t instanceof wi)Dr.warn(t.message);else{const n=ci.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});Dr.warn(n.message)}}}async function $1(e,t){try{const r=(await u_()).transaction(Ia,"readwrite");await r.objectStore(Ia).put(t,f_(e)),await r.done}catch(n){if(n instanceof wi)Dr.warn(n.message);else{const r=ci.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Dr.warn(r.message)}}}function f_(e){return`${e.name}!${e.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4=1024,p4=30;class m4{constructor(t){this.container=t,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new x4(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var t,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=G1();if(((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>p4){const o=v4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Dr.warn(r)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=G1(),{heartbeatsToSend:r,unsentEntries:i}=g4(this._heartbeatsCache.heartbeats),s=yc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Dr.warn(n),""}}}function G1(){return new Date().toISOString().substring(0,10)}function g4(e,t=d4){const n=[];let r=e.slice();for(const i of e){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),K1(n)>t){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),K1(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class x4{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return t_()?n_().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await h4(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return $1(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const r=await this.read();return $1(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...t.heartbeats]})}else return}}function K1(e){return yc(JSON.stringify({version:2,heartbeats:e})).length}function v4(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(e){Pr(new hr("platform-logger",t=>new FC(t),"PRIVATE")),Pr(new hr("heartbeat",t=>new m4(t),"PRIVATE")),Ln(P0,H1,e),Ln(P0,H1,"esm2020"),Ln("fire-js","")}_4("");var y4="firebase",w4="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln(y4,w4,"app");const X1="@firebase/database",Y1="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h_="";function E4(e){h_=e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T4{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,n){n==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Tt(n))}get(t){const n=this.domStorage_.getItem(this.prefixedName_(t));return n==null?null:ka(n)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,n){n==null?delete this.cache_[t]:this.cache_[t]=n}get(t){return Ur(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=function(e){try{if(typeof window<"u"&&typeof window[e]<"u"){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new T4(t)}}catch{}return new S4},Li=d_("localStorage"),M0=d_("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us=new Zh("@firebase/database"),C4=function(){let e=1;return function(){return e++}}(),p_=function(e){const t=lC(e),n=new aC;n.update(t);const r=n.digest();return Qh.encodeByteArray(r)},Xa=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?t+=Xa.apply(null,r):typeof r=="object"?t+=Tt(r):t+=r,t+=" "}return t};let Ui=null,q1=!0;const k4=function(e,t){ee(!t||e===!0||e===!1,"Can't turn on custom loggers persistently."),e===!0?(Us.logLevel=Ve.VERBOSE,Ui=Us.log.bind(Us),t&&M0.set("logging_enabled",!0)):typeof e=="function"?Ui=e:(Ui=null,M0.remove("logging_enabled"))},Ht=function(...e){if(q1===!0&&(q1=!1,Ui===null&&M0.get("logging_enabled")===!0&&k4(!0)),Ui){const t=Xa.apply(null,e);Ui(t)}},Ya=function(e){return function(...t){Ht(e,...t)}},B0=function(...e){const t="FIREBASE INTERNAL ERROR: "+Xa(...e);Us.error(t)},Lr=function(...e){const t=`FIREBASE FATAL ERROR: ${Xa(...e)}`;throw Us.error(t),new Error(t)},un=function(...e){const t="FIREBASE WARNING: "+Xa(...e);Us.warn(t)},A4=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&un("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},m_=function(e){return typeof e=="number"&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},I4=function(e){if(document.readyState==="complete")e();else{let t=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ro="[MIN_NAME]",Xi="[MAX_NAME]",ho=function(e,t){if(e===t)return 0;if(e===ro||t===Xi)return-1;if(t===ro||e===Xi)return 1;{const n=Q1(e),r=Q1(t);return n!==null?r!==null?n-r===0?e.length-t.length:n-r:-1:r!==null?1:e<t?-1:1}},R4=function(e,t){return e===t?0:e<t?-1:1},Fo=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Tt(t))},nd=function(e){if(typeof e!="object"||e===null)return Tt(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)r!==0&&(n+=","),n+=Tt(t[r]),n+=":",n+=nd(e[t[r]]);return n+="}",n},g_=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function hn(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const x_=function(e){ee(!m_(e),"Invalid JSON number");const t=11,n=52,r=(1<<t-1)-1;let i,s,o,a,l;e===0?(s=0,o=0,i=1/e===-1/0?1:0):(i=e<0,e=Math.abs(e),e>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(e)/Math.LN2),r),s=a+r,o=Math.round(e*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(e/Math.pow(2,1-r-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=t;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const u=c.join("");let h="";for(l=0;l<64;l+=8){let f=parseInt(u.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),h=h+f}return h.toLowerCase()},N4=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},F4=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function O4(e,t){let n="Unknown Error";e==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":e==="permission_denied"?n="Client doesn't have permission to access the desired data.":e==="unavailable"&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}const D4=new RegExp("^-?(0*)\\d{1,10}$"),P4=-2147483648,L4=2147483647,Q1=function(e){if(D4.test(e)){const t=Number(e);if(t>=P4&&t<=L4)return t}return null},po=function(e){try{e()}catch(t){setTimeout(()=>{const n=t.stack||"";throw un("Exception was thrown by user callback.",n),t},Math.floor(0))}},b4=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Jo=function(e,t){const n=setTimeout(e,t);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(t,n){this.appCheckProvider=n,this.appName=t.name,a_(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(r=>this.appCheck=r)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(n,r):n(null)},0)})}addTokenChangeListener(t){var n;(n=this.appCheckProvider)==null||n.get().then(r=>r.addTokenListener(t))}notifyForInvalidToken(){un(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(t,n,r){this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(n=>n&&n.code==="auth/token-not-initialized"?(Ht("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(n,r):n(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(n=>n.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(n=>n.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',un(t)}}class Ws{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Ws.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd="5",v_="v",__="s",y_="r",w_="f",E_=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,T_="ls",S_="p",j0="ac",C_="websocket",k_="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(t,n,r,i,s=!1,o="",a=!1,l=!1,c=null){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this.emulatorOptions=c,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Li.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Li.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${n}`}}function j4(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams}function I_(e,t,n){ee(typeof t=="string","typeof type must == string"),ee(typeof n=="object","typeof params must == object");let r;if(t===C_)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===k_)r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);j4(e)&&(n.ns=e.namespace);const i=[];return hn(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(){this.counters_={}}incrementCounter(t,n=1){Ur(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=n}get(){return zS(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xf={},vf={};function id(e){const t=e.toString();return xf[t]||(xf[t]=new U4),xf[t]}function W4(e,t){const n=e.toString();return vf[n]||(vf[n]=t()),vf[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,n){this.closeAfterResponse=t,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,n){for(this.pendingResponses[t]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&po(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1="start",H4="close",V4="pLPCommand",$4="pRTLPCB",R_="id",N_="pw",F_="ser",G4="cb",K4="seg",X4="ts",Y4="d",q4="dframe",O_=1870,D_=30,Q4=O_-D_,J4=25e3,Z4=3e4;class Os{constructor(t,n,r,i,s,o,a){this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ya(t),this.stats_=id(n),this.urlFn=l=>(this.appCheckToken&&(l[j0]=this.appCheckToken),I_(n,k_,l))}open(t,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new z4(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Z4)),I4(()=>{if(this.isClosed_)return;this.scriptTagHolder=new sd((...s)=>{const[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===J1)this.id=a,this.password=l;else if(o===H4)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[J1]="t",r[F_]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[G4]=this.scriptTagHolder.uniqueCallbackIdentifier),r[v_]=rd,this.transportSessionId&&(r[__]=this.transportSessionId),this.lastSessionId&&(r[T_]=this.lastSessionId),this.applicationId&&(r[S_]=this.applicationId),this.appCheckToken&&(r[j0]=this.appCheckToken),typeof location<"u"&&location.hostname&&E_.test(location.hostname)&&(r[y_]=w_);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Os.forceAllow_=!0}static forceDisallow(){Os.forceDisallow_=!0}static isAvailable(){return Os.forceAllow_?!0:!Os.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!N4()&&!F4()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const n=Tt(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=$v(n),i=g_(r,Q4);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(t,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[q4]="t",r[R_]=t,r[N_]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const n=Tt(t).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class sd{constructor(t,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=C4(),window[V4+this.uniqueCallbackIdentifier]=t,window[$4+this.uniqueCallbackIdentifier]=n,this.myIFrame=sd.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Ht("frame writing exception"),a.stack&&Ht(a.stack),Ht(a)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Ht("No IE domain setting required")}catch{const r=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,n){for(this.myID=t,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[R_]=this.myID,t[N_]=this.myPW,t[F_]=this.currentSerial;let n=this.urlFn(t),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+D_+r.length<=O_;){const o=this.pendingSegs.shift();r=r+"&"+K4+i+"="+o.seg+"&"+X4+i+"="+o.ts+"&"+Y4+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(t,n,r){this.pendingSegs.push({seg:t,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(t,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(J4)),s=()=>{clearTimeout(i),r()};this.addTag(t,s)}addTag(t,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Ht("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e3=16384,t3=45e3;let Tc=null;typeof MozWebSocket<"u"?Tc=MozWebSocket:typeof WebSocket<"u"&&(Tc=WebSocket);class Gn{constructor(t,n,r,i,s,o,a){this.connId=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ya(this.connId),this.stats_=id(n),this.connURL=Gn.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(t,n,r,i,s){const o={};return o[v_]=rd,typeof location<"u"&&location.hostname&&E_.test(location.hostname)&&(o[y_]=w_),n&&(o[__]=n),r&&(o[T_]=r),i&&(o[j0]=i),s&&(o[S_]=s),I_(t,C_,o)}open(t,n){this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Li.set("previous_websocket_failure",!0);try{let r;e_(),this.mySock=new Tc(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Gn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&Tc!==null&&!Gn.forceDisallow_}static previouslyFailed(){return Li.isInMemoryStorage||Li.get("previous_websocket_failure")===!0}markConnectionHealthy(){Li.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=ka(n);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(ee(this.frames===null,"We already have a frame buffer"),t.length<=6){const n=Number(t);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const n=t.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const n=Tt(t);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=g_(n,e3);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(t3))}sendString_(t){try{this.mySock.send(t)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Gn.responsesRequiredToBeHealthy=2;Gn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{static get ALL_TRANSPORTS(){return[Os,Gn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const n=Gn&&Gn.isAvailable();let r=n&&!Gn.previouslyFailed();if(t.webSocketOnly&&(n||un("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Gn];else{const i=this.transports_=[];for(const s of Ra.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Ra.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ra.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=6e4,r3=5e3,i3=10*1024,s3=100*1024,_f="t",Z1="d",o3="s",em="r",a3="e",tm="o",nm="a",rm="n",im="p",l3="h";class c3{constructor(t,n,r,i,s,o,a,l,c,u){this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ya("c:"+this.id+":"),this.transportManager_=new Ra(n),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=Jo(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>s3?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>i3?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return n=>{t===this.conn_?this.onConnectionLost_(n):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return n=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(n):t===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(t){const n={t:"d",d:t};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(_f in t){const n=t[_f];n===nm?this.upgradeIfSecondaryHealthy_():n===em?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===tm&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const n=Fo("t",t),r=Fo("d",t);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:im,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:nm,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:rm,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const n=Fo("t",t),r=Fo("d",t);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const n=Fo(_f,t);if(Z1 in t){const r=t[Z1];if(n===l3){const i={...r};this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===rm){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===o3?this.onConnectionShutdown_(r):n===em?this.onReset_(r):n===a3?B0("Server Error: "+r):n===tm?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):B0("Unknown control packet command: "+n)}}onHandshake_(t){const n=t.ts,r=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),rd!==r&&un("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Jo(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(n3))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,n){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Jo(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(r3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:im,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Li.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{put(t,n,r,i){}merge(t,n,r,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,n,r){}onDisconnectMerge(t,n,r){}onDisconnectCancel(t,n){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(t){this.allowedEvents_=t,this.listeners_={},ee(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...n){if(Array.isArray(this.listeners_[t])){const r=[...this.listeners_[t]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(t,n,r){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:n,context:r});const i=this.getInitialEvent(t);i&&n.apply(r,i)}off(t,n,r){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(t){ee(this.allowedEvents_.find(n=>n===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc extends L_{static getInstance(){return new Sc}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Zv()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return ee(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm=32,om=768;class ze{constructor(t,n){if(n===void 0){this.pieces_=t.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}toString(){let t="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(t+="/"+this.pieces_[n]);return t||"/"}}function De(){return new ze("")}function Ee(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function di(e){return e.pieces_.length-e.pieceNum_}function $e(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new ze(e.pieces_,t)}function b_(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function u3(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)e.pieces_[n]!==""&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}function M_(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function B_(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ze(t,0)}function vt(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof ze)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const r=t.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new ze(n,0)}function Ce(e){return e.pieceNum_>=e.pieces_.length}function sn(e,t){const n=Ee(e),r=Ee(t);if(n===null)return t;if(n===r)return sn($e(e),$e(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function od(e,t){if(di(e)!==di(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Xn(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(di(e)>di(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class f3{constructor(t,n){this.errorPrefix_=n,this.parts_=M_(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=gu(this.parts_[r]);j_(this)}}function h3(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=gu(t),j_(e)}function d3(e){const t=e.parts_.pop();e.byteLength_-=gu(t),e.parts_.length>0&&(e.byteLength_-=1)}function j_(e){if(e.byteLength_>om)throw new Error(e.errorPrefix_+"has a key path longer than "+om+" bytes ("+e.byteLength_+").");if(e.parts_.length>sm)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+sm+") or object contains a cycle "+Ri(e))}function Ri(e){return e.parts_.length===0?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad extends L_{static getInstance(){return new ad}constructor(){super(["visible"]);let t,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[t];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(t){return ee(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=1e3,p3=60*5*1e3,am=30*1e3,m3=1.3,g3=3e4,x3="server_kill",lm=3;class Cr extends P_{constructor(t,n,r,i,s,o,a,l){if(super(),this.repoInfo_=t,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Cr.nextPersistentConnectionId_++,this.log_=Ya("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Oo,this.maxReconnectDelay_=p3,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!e_())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ad.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Sc.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,r){const i=++this.requestNumber_,s={r:i,a:t,b:n};this.log_(Tt(s)),ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(t){this.initConnection_();const n=new pu,i={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(t,n,r,i){this.initConnection_();const s=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),ee(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ee(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:t,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const n=this.outstandingGets_[t];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(t){const n=t.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";t.tag&&(s.q=n._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,c=a.s;Cr.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===t&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(r,i),t.onComplete&&t.onComplete(c,l))})}static warnOnListenWarnings_(t,n){if(t&&typeof t=="object"&&Ur(t,"w")){const r=no(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();un(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||sC(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=am)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,n=iC(t)?"auth":"gauth",r={cred:t};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const n=t.s,r=t.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(t,n){const r=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),ee(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,t._queryObject,n)}sendUnlisten_(t,n,r,i){this.log_("Unlisten on "+t+" for "+n);const s={p:t},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(t,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,n,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:n,onComplete:r})}onDisconnectMerge(t,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,n,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:n,onComplete:r})}onDisconnectCancel(t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(t,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(t,n,r,i){this.putInternal("p",t,n,r,i)}merge(t,n,r,i){this.putInternal("m",t,n,r,i)}putInternal(t,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:t,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(t){const n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(t){if(this.connected_){const n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Tt(t));const n=t.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,n){this.log_("handleServerMessage",t,n),t==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):t==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):t==="c"?this.onListenRevoked_(n.p,n.q):t==="ac"?this.onAuthRevoked_(n.s,n.d):t==="apc"?this.onAppCheckRevoked_(n.s,n.d):t==="sd"?this.onSecurityDebugPacket_(n):B0("Unrecognized action received from server: "+Tt(t)+`
Are you using the latest client?`)}onReady_(t,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Oo,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Oo,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>g3&&(this.reconnectDelay_=Oo),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let n=Math.max(0,this.reconnectDelay_-t);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*m3)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Cr.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},c=function(h){ee(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Ht("getToken() completed but was canceled"):(Ht("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,a=new c3(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,p=>{un(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(x3)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&un(h),l())}}}interrupt(t){Ht("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ht("Resuming connection for reason: "+t),delete this.interruptReasons_[t],M1(this.interruptReasons_)&&(this.reconnectDelay_=Oo,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const n=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const n=this.outstandingPuts_[t];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,n){let r;n?r=n.map(s=>nd(s)).join("$"):r="default";const i=this.removeListen_(t,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,n){const r=new ze(t).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(t,n){Ht("Auth token revoked: "+t+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=lm&&(this.reconnectDelay_=am,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,n){Ht("App check token revoked: "+t+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=lm&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const n of t.values())this.sendListen_(n);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let n="js";t["sdk."+n+"."+h_.replace(/\./g,"-")]=1,Zv()?t["framework.cordova"]=1:ZS()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Sc.getInstance().currentlyOnline();return M1(this.interruptReasons_)&&t}}Cr.nextPersistentConnectionId_=0;Cr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(t,n){this.name=t,this.node=n}static Wrap(t,n){return new Te(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,n){const r=new Te(ro,t),i=new Te(ro,n);return this.compare(r,i)!==0}minPost(){return Te.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cl;class U_ extends xu{static get __EMPTY_NODE(){return Cl}static set __EMPTY_NODE(t){Cl=t}compare(t,n){return ho(t.name,n.name)}isDefinedOn(t){throw uo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,n){return!1}minPost(){return Te.MIN}maxPost(){return new Te(Xi,Cl)}makePost(t,n){return ee(typeof t=="string","KeyIndex indexValue must always be a string."),new Te(t,Cl)}toString(){return".key"}}const zs=new U_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(t,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!t.isEmpty();)if(t=t,o=n?r(t.key,n):1,i&&(o*=-1),o<0)this.isReverse_?t=t.left:t=t.right;else if(o===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(t.key,t.value):n={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Et{constructor(t,n,r,i,s){this.key=t,this.value=n,this.color=r??Et.RED,this.left=i??on.EMPTY_NODE,this.right=s??on.EMPTY_NODE}copy(t,n,r,i,s){return new Et(t??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,n,r){let i=this;const s=r(t,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(t,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(t,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return on.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,n){let r,i;if(r=this,n(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(t,r.key)===0){if(r.right.isEmpty())return on.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,n)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Et.RED=!0;Et.BLACK=!1;class v3{copy(t,n,r,i,s){return this}insert(t,n,r){return new Et(t,n,null)}remove(t,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class on{constructor(t,n=on.EMPTY_NODE){this.comparator_=t,this.root_=n}insert(t,n){return new on(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Et.BLACK,null,null))}remove(t){return new on(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Et.BLACK,null,null))}get(t){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(t,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(t){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(t,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new kl(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,n){return new kl(this.root_,t,this.comparator_,!1,n)}getReverseIteratorFrom(t,n){return new kl(this.root_,t,this.comparator_,!0,n)}getReverseIterator(t){return new kl(this.root_,null,this.comparator_,!0,t)}}on.EMPTY_NODE=new v3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _3(e,t){return ho(e.name,t.name)}function ld(e,t){return ho(e,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U0;function y3(e){U0=e}const W_=function(e){return typeof e=="number"?"number:"+x_(e):"string:"+e},z_=function(e){if(e.isLeafNode()){const t=e.val();ee(typeof t=="string"||typeof t=="number"||typeof t=="object"&&Ur(t,".sv"),"Priority must be a string or number.")}else ee(e===U0||e.isEmpty(),"priority of unexpected type.");ee(e===U0||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm;class yt{static set __childrenNodeConstructor(t){cm=t}static get __childrenNodeConstructor(){return cm}constructor(t,n=yt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,ee(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),z_(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new yt(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:yt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ce(t)?this:Ee(t)===".priority"?this.priorityNode_:yt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,n){return null}updateImmediateChild(t,n){return t===".priority"?this.updatePriority(n):n.isEmpty()&&t!==".priority"?this:yt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}updateChild(t,n){const r=Ee(t);return r===null?n:n.isEmpty()&&r!==".priority"?this:(ee(r!==".priority"||di(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,yt.__childrenNodeConstructor.EMPTY_NODE.updateChild($e(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,n){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+W_(this.priorityNode_.val())+":");const n=typeof this.value_;t+=n+":",n==="number"?t+=x_(this.value_):t+=this.value_,this.lazyHash_=p_(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===yt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof yt.__childrenNodeConstructor?-1:(ee(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,r=typeof this.value_,i=yt.VALUE_TYPE_ORDER.indexOf(n),s=yt.VALUE_TYPE_ORDER.indexOf(r);return ee(i>=0,"Unknown leaf type: "+n),ee(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const n=t;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}yt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H_,V_;function w3(e){H_=e}function E3(e){V_=e}class T3 extends xu{compare(t,n){const r=t.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?ho(t.name,n.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,n){return!t.getPriority().equals(n.getPriority())}minPost(){return Te.MIN}maxPost(){return new Te(Xi,new yt("[PRIORITY-POST]",V_))}makePost(t,n){const r=H_(t);return new Te(n,new yt("[PRIORITY-POST]",r))}toString(){return".priority"}}const at=new T3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=Math.log(2);class C3{constructor(t){const n=s=>parseInt(Math.log(s)/S3,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(t+1),this.current_=this.count-1;const i=r(this.count);this.bits_=t+1&i}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Cc=function(e,t,n,r){e.sort(t);const i=function(l,c){const u=c-l;let h,f;if(u===0)return null;if(u===1)return h=e[l],f=n?n(h):h,new Et(f,h.node,Et.BLACK,null,null);{const p=parseInt(u/2,10)+l,g=i(l,p),m=i(p+1,c);return h=e[p],f=n?n(h):h,new Et(f,h.node,Et.BLACK,g,m)}},s=function(l){let c=null,u=null,h=e.length;const f=function(g,m){const w=h-g,_=h;h-=g;const x=i(w+1,_),y=e[w],I=n?n(y):y;p(new Et(I,y.node,m,null,x))},p=function(g){c?(c.left=g,c=g):(u=g,c=g)};for(let g=0;g<l.count;++g){const m=l.nextBitIsOne(),w=Math.pow(2,l.count-(g+1));m?f(w,Et.BLACK):(f(w,Et.BLACK),f(w,Et.RED))}return u},o=new C3(e.length),a=s(o);return new on(r||t,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yf;const ps={};class wr{static get Default(){return ee(ps&&at,"ChildrenNode.ts has not been loaded"),yf=yf||new wr({".priority":ps},{".priority":at}),yf}constructor(t,n){this.indexes_=t,this.indexSet_=n}get(t){const n=no(this.indexes_,t);if(!n)throw new Error("No index defined for "+t);return n instanceof on?n:null}hasIndex(t){return Ur(this.indexSet_,t.toString())}addIndex(t,n){ee(t!==zs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(Te.Wrap);let o=s.getNext();for(;o;)i=i||t.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Cc(r,t.getCompare()):a=ps;const l=t.toString(),c={...this.indexSet_};c[l]=t;const u={...this.indexes_};return u[l]=a,new wr(u,c)}addToIndexes(t,n){const r=wc(this.indexes_,(i,s)=>{const o=no(this.indexSet_,s);if(ee(o,"Missing index implementation for "+s),i===ps)if(o.isDefinedOn(t.node)){const a=[],l=n.getIterator(Te.Wrap);let c=l.getNext();for(;c;)c.name!==t.name&&a.push(c),c=l.getNext();return a.push(t),Cc(a,o.getCompare())}else return ps;else{const a=n.get(t.name);let l=i;return a&&(l=l.remove(new Te(t.name,a))),l.insert(t,t.node)}});return new wr(r,this.indexSet_)}removeFromIndexes(t,n){const r=wc(this.indexes_,i=>{if(i===ps)return i;{const s=n.get(t.name);return s?i.remove(new Te(t.name,s)):i}});return new wr(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Do;class xe{static get EMPTY_NODE(){return Do||(Do=new xe(new on(ld),null,wr.Default))}constructor(t,n,r){this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&z_(this.priorityNode_),this.children_.isEmpty()&&ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Do}updatePriority(t){return this.children_.isEmpty()?this:new xe(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const n=this.children_.get(t);return n===null?Do:n}}getChild(t){const n=Ee(t);return n===null?this:this.getImmediateChild(n).getChild($e(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,n){if(ee(n,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(n);{const r=new Te(t,n);let i,s;n.isEmpty()?(i=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Do:this.priorityNode_;return new xe(i,o,s)}}updateChild(t,n){const r=Ee(t);if(r===null)return n;{ee(Ee(t)!==".priority"||di(t)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild($e(t),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(at,(o,a)=>{n[o]=a.val(t),r++,s&&xe.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!t&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+W_(this.getPriority().val())+":"),this.forEachChild(at,(n,r)=>{const i=r.hash();i!==""&&(t+=":"+n+":"+i)}),this.lazyHash_=t===""?"":p_(t)}return this.lazyHash_}getPredecessorChildName(t,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new Te(t,n));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const n=this.resolveIndex_(t);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(t){const n=this.getFirstChildName(t);return n?new Te(n,this.children_.get(n)):null}getLastChildName(t){const n=this.resolveIndex_(t);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(t){const n=this.getLastChildName(t);return n?new Te(n,this.children_.get(n)):null}forEachChild(t,n){const r=this.resolveIndex_(t);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(t,i=>i);{const i=this.children_.getIteratorFrom(t.name,Te.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,t)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(t,i=>i);{const i=this.children_.getReverseIteratorFrom(t.name,Te.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,t)>0;)i.getNext(),s=i.peek();return i}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===qa?-1:0}withIndex(t){if(t===zs||this.indexMap_.hasIndex(t))return this;{const n=this.indexMap_.addIndex(t,this.children_);return new xe(this.children_,this.priorityNode_,n)}}isIndexed(t){return t===zs||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const n=t;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(at),i=n.getIterator(at);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(t){return t===zs?null:this.indexMap_.get(t.toString())}}xe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class k3 extends xe{constructor(){super(new on(ld),xe.EMPTY_NODE,wr.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return xe.EMPTY_NODE}isEmpty(){return!1}}const qa=new k3;Object.defineProperties(Te,{MIN:{value:new Te(ro,xe.EMPTY_NODE)},MAX:{value:new Te(Xi,qa)}});U_.__EMPTY_NODE=xe.EMPTY_NODE;yt.__childrenNodeConstructor=xe;y3(qa);E3(qa);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3=!0;function Ft(e,t=null){if(e===null)return xe.EMPTY_NODE;if(typeof e=="object"&&".priority"in e&&(t=e[".priority"]),ee(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof e=="object"&&".value"in e&&e[".value"]!==null&&(e=e[".value"]),typeof e!="object"||".sv"in e){const n=e;return new yt(n,Ft(t))}if(!(e instanceof Array)&&A3){const n=[];let r=!1;if(hn(e,(o,a)=>{if(o.substring(0,1)!=="."){const l=Ft(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new Te(o,l)))}}),n.length===0)return xe.EMPTY_NODE;const s=Cc(n,_3,o=>o.name,ld);if(r){const o=Cc(n,at.getCompare());return new xe(s,Ft(t),new wr({".priority":o},{".priority":at}))}else return new xe(s,Ft(t),wr.Default)}else{let n=xe.EMPTY_NODE;return hn(e,(r,i)=>{if(Ur(e,r)&&r.substring(0,1)!=="."){const s=Ft(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Ft(t))}}w3(Ft);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I3 extends xu{constructor(t){super(),this.indexPath_=t,ee(!Ce(t)&&Ee(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,n){const r=this.extractChild(t.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?ho(t.name,n.name):s}makePost(t,n){const r=Ft(t),i=xe.EMPTY_NODE.updateChild(this.indexPath_,r);return new Te(n,i)}maxPost(){const t=xe.EMPTY_NODE.updateChild(this.indexPath_,qa);return new Te(Xi,t)}toString(){return M_(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3 extends xu{compare(t,n){const r=t.node.compareTo(n.node);return r===0?ho(t.name,n.name):r}isDefinedOn(t){return!0}indexedValueChanged(t,n){return!t.equals(n)}minPost(){return Te.MIN}maxPost(){return Te.MAX}makePost(t,n){const r=Ft(t);return new Te(n,r)}toString(){return".value"}}const N3=new R3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(e){return{type:"value",snapshotNode:e}}function io(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Na(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Fa(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function F3(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(t){this.index_=t}updateChild(t,n,r,i,s,o){ee(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?t.hasChild(n)?o.trackChildChange(Na(n,a)):ee(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(io(n,r)):o.trackChildChange(Fa(n,r,a))),t.isLeafNode()&&r.isEmpty())?t:t.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(t,n,r){return r!=null&&(t.isLeafNode()||t.forEachChild(at,(i,s)=>{n.hasChild(i)||r.trackChildChange(Na(i,s))}),n.isLeafNode()||n.forEachChild(at,(i,s)=>{if(t.hasChild(i)){const o=t.getImmediateChild(i);o.equals(s)||r.trackChildChange(Fa(i,s,o))}else r.trackChildChange(io(i,s))})),n.withIndex(this.index_)}updatePriority(t,n){return t.isEmpty()?xe.EMPTY_NODE:t.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(t){this.indexedFilter_=new cd(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Oa.getStartPost_(t),this.endPost_=Oa.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,r=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return n&&r}updateChild(t,n,r,i,s,o){return this.matches(new Te(n,r))||(r=xe.EMPTY_NODE),this.indexedFilter_.updateChild(t,n,r,i,s,o)}updateFullNode(t,n,r){n.isLeafNode()&&(n=xe.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(xe.EMPTY_NODE);const s=this;return n.forEachChild(at,(o,a)=>{s.matches(new Te(o,a))||(i=i.updateImmediateChild(o,xe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,r)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const n=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),n)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const n=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),n)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O3{constructor(t){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Oa(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,n,r,i,s,o){return this.rangedFilter_.matches(new Te(n,r))||(r=xe.EMPTY_NODE),t.getImmediateChild(n).equals(r)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,n,r,i,s,o):this.fullLimitUpdateChild_(t,n,r,s,o)}updateFullNode(t,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=xe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=xe.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(xe.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,xe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,r)}updatePriority(t,n){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,r,i,s){let o;if(this.reverse_){const h=this.index_.getCompare();o=(f,p)=>h(p,f)}else o=this.index_.getCompare();const a=t;ee(a.numChildren()===this.limit_,"");const l=new Te(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let f=i.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===n||a.hasChild(f.name));)f=i.getChildAfterChild(this.index_,f,this.reverse_);const p=f==null?1:o(f,l);if(u&&!r.isEmpty()&&p>=0)return s!=null&&s.trackChildChange(Fa(n,r,h)),a.updateImmediateChild(n,r);{s!=null&&s.trackChildChange(Na(n,h));const m=a.updateImmediateChild(n,xe.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(s!=null&&s.trackChildChange(io(f.name,f.node)),m.updateImmediateChild(f.name,f.node)):m}}else return r.isEmpty()?t:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange(Na(c.name,c.node)),s.trackChildChange(io(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,xe.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=at}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ro}hasEnd(){return this.endSet_}getIndexEndValue(){return ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Xi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ee(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===at}copy(){const t=new ud;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function D3(e){return e.loadsAllData()?new cd(e.getIndex()):e.hasLimit()?new O3(e):new Oa(e)}function um(e){const t={};if(e.isDefault())return t;let n;if(e.index_===at?n="$priority":e.index_===N3?n="$value":e.index_===zs?n="$key":(ee(e.index_ instanceof I3,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Tt(n),e.startSet_){const r=e.startAfterSet_?"startAfter":"startAt";t[r]=Tt(e.indexStartValue_),e.startNameSet_&&(t[r]+=","+Tt(e.indexStartName_))}if(e.endSet_){const r=e.endBeforeSet_?"endBefore":"endAt";t[r]=Tt(e.indexEndValue_),e.endNameSet_&&(t[r]+=","+Tt(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function fm(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;n===""&&(e.isViewFromLeft()?n="l":n="r"),t.vf=n}return e.index_!==at&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc extends P_{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return n!==void 0?"tag$"+n:(ee(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,n,r,i){super(),this.repoInfo_=t,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Ya("p:rest:"),this.listens_={}}listen(t,n,r,i){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const o=kc.getListenId_(t,r),a={};this.listens_[o]=a;const l=um(t._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(s,h,!1,r),no(this.listens_,o)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",i(f,null)}})}unlisten(t,n){const r=kc.getListenId_(t,n);delete this.listens_[r]}get(t){const n=um(t._queryParams),r=t._path.toString(),i=new pu;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(t){}restRequest_(t,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+oC(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ka(a.responseText)}catch{un("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&un("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(){this.rootNode_=xe.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,n){this.rootNode_=this.rootNode_.updateChild(t,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ac(){return{value:null,children:new Map}}function G_(e,t,n){if(Ce(t))e.value=n,e.children.clear();else if(e.value!==null)e.value=e.value.updateChild(t,n);else{const r=Ee(t);e.children.has(r)||e.children.set(r,Ac());const i=e.children.get(r);t=$e(t),G_(i,t,n)}}function W0(e,t,n){e.value!==null?n(t,e.value):L3(e,(r,i)=>{const s=new ze(t.toString()+"/"+r);W0(i,s,n)})}function L3(e,t){e.children.forEach((n,r)=>{t(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b3{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),n={...t};return this.last_&&hn(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hm=10*1e3,M3=30*1e3,B3=5*60*1e3;class j3{constructor(t,n){this.server_=n,this.statsToReport_={},this.statsListener_=new b3(t);const r=hm+(M3-hm)*Math.random();Jo(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const t=this.statsListener_.get(),n={};let r=!1;hn(t,(i,s)=>{s>0&&Ur(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Jo(this.reportStats_.bind(this),Math.floor(Math.random()*2*B3))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yn;(function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Yn||(Yn={}));function K_(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function fd(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function hd(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(t,n,r){this.path=t,this.affectedTree=n,this.revert=r,this.type=Yn.ACK_USER_WRITE,this.source=K_()}operationForChild(t){if(Ce(this.path)){if(this.affectedTree.value!=null)return ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new ze(t));return new Ic(De(),n,this.revert)}}else return ee(Ee(this.path)===t,"operationForChild called for unrelated child."),new Ic($e(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(t,n){this.source=t,this.path=n,this.type=Yn.LISTEN_COMPLETE}operationForChild(t){return Ce(this.path)?new Da(this.source,De()):new Da(this.source,$e(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(t,n,r){this.source=t,this.path=n,this.snap=r,this.type=Yn.OVERWRITE}operationForChild(t){return Ce(this.path)?new Yi(this.source,De(),this.snap.getImmediateChild(t)):new Yi(this.source,$e(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(t,n,r){this.source=t,this.path=n,this.children=r,this.type=Yn.MERGE}operationForChild(t){if(Ce(this.path)){const n=this.children.subtree(new ze(t));return n.isEmpty()?null:n.value?new Yi(this.source,De(),n.value):new Pa(this.source,De(),n)}else return ee(Ee(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Pa(this.source,$e(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(t,n,r){this.node_=t,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Ce(t))return this.isFullyInitialized()&&!this.filtered_;const n=Ee(t);return this.isCompleteForChild(n)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U3{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function W3(e,t,n,r){const i=[],s=[];return t.forEach(o=>{o.type==="child_changed"&&e.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(F3(o.childName,o.snapshotNode))}),Po(e,i,"child_removed",t,r,n),Po(e,i,"child_added",t,r,n),Po(e,i,"child_moved",s,r,n),Po(e,i,"child_changed",t,r,n),Po(e,i,"value",t,r,n),i}function Po(e,t,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,l)=>H3(e,a,l)),o.forEach(a=>{const l=z3(e,a,s);i.forEach(c=>{c.respondsTo(a.type)&&t.push(c.createEvent(l,e.query_))})})}function z3(e,t,n){return t.type==="value"||t.type==="child_removed"||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}function H3(e,t,n){if(t.childName==null||n.childName==null)throw uo("Should only compare child_ events.");const r=new Te(t.childName,t.snapshotNode),i=new Te(n.childName,n.snapshotNode);return e.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(e,t){return{eventCache:e,serverCache:t}}function Zo(e,t,n,r){return vu(new qi(t,n,r),e.serverCache)}function X_(e,t,n,r){return vu(e.eventCache,new qi(t,n,r))}function z0(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Qi(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wf;const V3=()=>(wf||(wf=new on(R4)),wf);class Xe{static fromObject(t){let n=new Xe(null);return hn(t,(r,i)=>{n=n.set(new ze(r),i)}),n}constructor(t,n=V3()){this.value=t,this.children=n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,n){if(this.value!=null&&n(this.value))return{path:De(),value:this.value};if(Ce(t))return null;{const r=Ee(t),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue($e(t),n);return s!=null?{path:vt(new ze(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Ce(t))return this;{const n=Ee(t),r=this.children.get(n);return r!==null?r.subtree($e(t)):new Xe(null)}}set(t,n){if(Ce(t))return new Xe(n,this.children);{const r=Ee(t),s=(this.children.get(r)||new Xe(null)).set($e(t),n),o=this.children.insert(r,s);return new Xe(this.value,o)}}remove(t){if(Ce(t))return this.children.isEmpty()?new Xe(null):new Xe(null,this.children);{const n=Ee(t),r=this.children.get(n);if(r){const i=r.remove($e(t));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new Xe(null):new Xe(this.value,s)}else return this}}get(t){if(Ce(t))return this.value;{const n=Ee(t),r=this.children.get(n);return r?r.get($e(t)):null}}setTree(t,n){if(Ce(t))return n;{const r=Ee(t),s=(this.children.get(r)||new Xe(null)).setTree($e(t),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new Xe(this.value,o)}}fold(t){return this.fold_(De(),t)}fold_(t,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(vt(t,i),n)}),n(t,this.value,r)}findOnPath(t,n){return this.findOnPath_(t,De(),n)}findOnPath_(t,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(Ce(t))return null;{const s=Ee(t),o=this.children.get(s);return o?o.findOnPath_($e(t),vt(n,s),r):null}}foreachOnPath(t,n){return this.foreachOnPath_(t,De(),n)}foreachOnPath_(t,n,r){if(Ce(t))return this;{this.value&&r(n,this.value);const i=Ee(t),s=this.children.get(i);return s?s.foreachOnPath_($e(t),vt(n,i),r):new Xe(null)}}foreach(t){this.foreach_(De(),t)}foreach_(t,n){this.children.inorderTraversal((r,i)=>{i.foreach_(vt(t,r),n)}),this.value&&n(t,this.value)}foreachChild(t){this.children.inorderTraversal((n,r)=>{r.value&&t(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(t){this.writeTree_=t}static empty(){return new Zn(new Xe(null))}}function ea(e,t,n){if(Ce(t))return new Zn(new Xe(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(r!=null){const i=r.path;let s=r.value;const o=sn(i,t);return s=s.updateChild(o,n),new Zn(e.writeTree_.set(i,s))}else{const i=new Xe(n),s=e.writeTree_.setTree(t,i);return new Zn(s)}}}function dm(e,t,n){let r=e;return hn(n,(i,s)=>{r=ea(r,vt(t,i),s)}),r}function pm(e,t){if(Ce(t))return Zn.empty();{const n=e.writeTree_.setTree(t,new Xe(null));return new Zn(n)}}function H0(e,t){return os(e,t)!=null}function os(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return n!=null?e.writeTree_.get(n.path).getChild(sn(n.path,t)):null}function mm(e){const t=[],n=e.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(at,(r,i)=>{t.push(new Te(r,i))}):e.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&t.push(new Te(r,i.value))}),t}function ui(e,t){if(Ce(t))return e;{const n=os(e,t);return n!=null?new Zn(new Xe(n)):new Zn(e.writeTree_.subtree(t))}}function V0(e){return e.writeTree_.isEmpty()}function so(e,t){return Y_(De(),e.writeTree_,t)}function Y_(e,t,n){if(t.value!=null)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal((i,s)=>{i===".priority"?(ee(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=Y_(vt(e,i),s,n)}),!n.getChild(e).isEmpty()&&r!==null&&(n=n.updateChild(vt(e,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(e,t){return Z_(t,e)}function $3(e,t,n,r,i){ee(r>e.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=ea(e.visibleWrites,t,n)),e.lastWriteId=r}function G3(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}function K3(e,t){const n=e.allWrites.findIndex(a=>a.writeId===t);ee(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const a=e.allWrites[o];a.visible&&(o>=n&&X3(a,r.path)?i=!1:Xn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return Y3(e),!0;if(r.snap)e.visibleWrites=pm(e.visibleWrites,r.path);else{const a=r.children;hn(a,l=>{e.visibleWrites=pm(e.visibleWrites,vt(r.path,l))})}return!0}else return!1}function X3(e,t){if(e.snap)return Xn(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Xn(vt(e.path,n),t))return!0;return!1}function Y3(e){e.visibleWrites=q_(e.allWrites,q3,De()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}function q3(e){return e.visible}function q_(e,t,n){let r=Zn.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const o=s.path;let a;if(s.snap)Xn(n,o)?(a=sn(n,o),r=ea(r,a,s.snap)):Xn(o,n)&&(a=sn(o,n),r=ea(r,De(),s.snap.getChild(a)));else if(s.children){if(Xn(n,o))a=sn(n,o),r=dm(r,a,s.children);else if(Xn(o,n))if(a=sn(o,n),Ce(a))r=dm(r,De(),s.children);else{const l=no(s.children,Ee(a));if(l){const c=l.getChild($e(a));r=ea(r,De(),c)}}}else throw uo("WriteRecord should have .snap or .children")}}return r}function Q_(e,t,n,r,i){if(!r&&!i){const s=os(e.visibleWrites,t);if(s!=null)return s;{const o=ui(e.visibleWrites,t);if(V0(o))return n;if(n==null&&!H0(o,De()))return null;{const a=n||xe.EMPTY_NODE;return so(o,a)}}}else{const s=ui(e.visibleWrites,t);if(!i&&V0(s))return n;if(!i&&n==null&&!H0(s,De()))return null;{const o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(Xn(c.path,t)||Xn(t,c.path))},a=q_(e.allWrites,o,t),l=n||xe.EMPTY_NODE;return so(a,l)}}}function Q3(e,t,n){let r=xe.EMPTY_NODE;const i=os(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(at,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=ui(e.visibleWrites,t);return n.forEachChild(at,(o,a)=>{const l=so(ui(s,new ze(o)),a);r=r.updateImmediateChild(o,l)}),mm(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=ui(e.visibleWrites,t);return mm(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function J3(e,t,n,r,i){ee(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=vt(t,n);if(H0(e.visibleWrites,s))return null;{const o=ui(e.visibleWrites,s);return V0(o)?i.getChild(n):so(o,i.getChild(n))}}function Z3(e,t,n,r){const i=vt(t,n),s=os(e.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=ui(e.visibleWrites,i);return so(o,r.getNode().getImmediateChild(n))}else return null}function ek(e,t){return os(e.visibleWrites,t)}function tk(e,t,n,r,i,s,o){let a;const l=ui(e.visibleWrites,t),c=os(l,De());if(c!=null)a=c;else if(n!=null)a=so(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),f=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let p=f.getNext();for(;p&&u.length<i;)h(p,r)!==0&&u.push(p),p=f.getNext();return u}else return[]}function nk(){return{visibleWrites:Zn.empty(),allWrites:[],lastWriteId:-1}}function Rc(e,t,n,r){return Q_(e.writeTree,e.treePath,t,n,r)}function pd(e,t){return Q3(e.writeTree,e.treePath,t)}function gm(e,t,n,r){return J3(e.writeTree,e.treePath,t,n,r)}function Nc(e,t){return ek(e.writeTree,vt(e.treePath,t))}function rk(e,t,n,r,i,s){return tk(e.writeTree,e.treePath,t,n,r,i,s)}function md(e,t,n){return Z3(e.writeTree,e.treePath,t,n)}function J_(e,t){return Z_(vt(e.treePath,t),e.writeTree)}function Z_(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(){this.changeMap=new Map}trackChildChange(t){const n=t.type,r=t.childName;ee(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),ee(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Fa(r,t.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Na(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,io(r,t.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Fa(r,t.snapshotNode,i.oldSnap));else throw uo("Illegal combination of changes: "+t+" occurred after "+i)}else this.changeMap.set(r,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{getCompleteChild(t){return null}getChildAfterChild(t,n,r){return null}}const ey=new sk;class gd{constructor(t,n,r=null){this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(t){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(t))return n.getNode().getImmediateChild(t);{const r=this.optCompleteServerCache_!=null?new qi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return md(this.writes_,t,r)}}getChildAfterChild(t,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Qi(this.viewCache_),s=rk(this.writes_,i,n,1,r,t);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(e){return{filter:e}}function ak(e,t){ee(t.eventCache.getNode().isIndexed(e.filter.getIndex()),"Event snap not indexed"),ee(t.serverCache.getNode().isIndexed(e.filter.getIndex()),"Server snap not indexed")}function lk(e,t,n,r,i){const s=new ik;let o,a;if(n.type===Yn.OVERWRITE){const c=n;c.source.fromUser?o=$0(e,t,c.path,c.snap,r,i,s):(ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!Ce(c.path),o=Fc(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===Yn.MERGE){const c=n;c.source.fromUser?o=uk(e,t,c.path,c.children,r,i,s):(ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=G0(e,t,c.path,c.children,r,i,a,s))}else if(n.type===Yn.ACK_USER_WRITE){const c=n;c.revert?o=dk(e,t,c.path,r,i,s):o=fk(e,t,c.path,c.affectedTree,r,i,s)}else if(n.type===Yn.LISTEN_COMPLETE)o=hk(e,t,n.path,r,s);else throw uo("Unknown operation type: "+n.type);const l=s.getChanges();return ck(t,o,l),{viewCache:o,changes:l}}function ck(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=z0(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push($_(z0(t)))}}function ty(e,t,n,r,i,s){const o=t.eventCache;if(Nc(r,n)!=null)return t;{let a,l;if(Ce(n))if(ee(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const c=Qi(t),u=c instanceof xe?c:xe.EMPTY_NODE,h=pd(r,u);a=e.filter.updateFullNode(t.eventCache.getNode(),h,s)}else{const c=Rc(r,Qi(t));a=e.filter.updateFullNode(t.eventCache.getNode(),c,s)}else{const c=Ee(n);if(c===".priority"){ee(di(n)===1,"Can't have a priority with additional path components");const u=o.getNode();l=t.serverCache.getNode();const h=gm(r,n,u,l);h!=null?a=e.filter.updatePriority(u,h):a=o.getNode()}else{const u=$e(n);let h;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const f=gm(r,n,o.getNode(),l);f!=null?h=o.getNode().getImmediateChild(c).updateChild(u,f):h=o.getNode().getImmediateChild(c)}else h=md(r,c,t.serverCache);h!=null?a=e.filter.updateChild(o.getNode(),c,h,u,i,s):a=o.getNode()}}return Zo(t,a,o.isFullyInitialized()||Ce(n),e.filter.filtersNodes())}}function Fc(e,t,n,r,i,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(Ce(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),p,null)}else{const p=Ee(n);if(!l.isCompleteForPath(n)&&di(n)>1)return t;const g=$e(n),w=l.getNode().getImmediateChild(p).updateChild(g,r);p===".priority"?c=u.updatePriority(l.getNode(),w):c=u.updateChild(l.getNode(),p,w,g,ey,null)}const h=X_(t,c,l.isFullyInitialized()||Ce(n),u.filtersNodes()),f=new gd(i,h,s);return ty(e,h,n,i,f,a)}function $0(e,t,n,r,i,s,o){const a=t.eventCache;let l,c;const u=new gd(i,t,s);if(Ce(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,o),l=Zo(t,c,!0,e.filter.filtersNodes());else{const h=Ee(n);if(h===".priority")c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Zo(t,c,a.isFullyInitialized(),a.isFiltered());else{const f=$e(n),p=a.getNode().getImmediateChild(h);let g;if(Ce(f))g=r;else{const m=u.getCompleteChild(h);m!=null?b_(f)===".priority"&&m.getChild(B_(f)).isEmpty()?g=m:g=m.updateChild(f,r):g=xe.EMPTY_NODE}if(p.equals(g))l=t;else{const m=e.filter.updateChild(a.getNode(),h,g,f,u,o);l=Zo(t,m,a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function xm(e,t){return e.eventCache.isCompleteForChild(t)}function uk(e,t,n,r,i,s,o){let a=t;return r.foreach((l,c)=>{const u=vt(n,l);xm(t,Ee(u))&&(a=$0(e,a,u,c,i,s,o))}),r.foreach((l,c)=>{const u=vt(n,l);xm(t,Ee(u))||(a=$0(e,a,u,c,i,s,o))}),a}function vm(e,t,n){return n.foreach((r,i)=>{t=t.updateChild(r,i)}),t}function G0(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l=t,c;Ce(n)?c=r:c=new Xe(null).setTree(n,r);const u=t.serverCache.getNode();return c.children.inorderTraversal((h,f)=>{if(u.hasChild(h)){const p=t.serverCache.getNode().getImmediateChild(h),g=vm(e,p,f);l=Fc(e,l,new ze(h),g,i,s,o,a)}}),c.children.inorderTraversal((h,f)=>{const p=!t.serverCache.isCompleteForChild(h)&&f.value===null;if(!u.hasChild(h)&&!p){const g=t.serverCache.getNode().getImmediateChild(h),m=vm(e,g,f);l=Fc(e,l,new ze(h),m,i,s,o,a)}}),l}function fk(e,t,n,r,i,s,o){if(Nc(i,n)!=null)return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(r.value!=null){if(Ce(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Fc(e,t,n,l.getNode().getChild(n),i,s,a,o);if(Ce(n)){let c=new Xe(null);return l.getNode().forEachChild(zs,(u,h)=>{c=c.set(new ze(u),h)}),G0(e,t,n,c,i,s,a,o)}else return t}else{let c=new Xe(null);return r.foreach((u,h)=>{const f=vt(n,u);l.isCompleteForPath(f)&&(c=c.set(u,l.getNode().getChild(f)))}),G0(e,t,n,c,i,s,a,o)}}function hk(e,t,n,r,i){const s=t.serverCache,o=X_(t,s.getNode(),s.isFullyInitialized()||Ce(n),s.isFiltered());return ty(e,o,n,r,ey,i)}function dk(e,t,n,r,i,s){let o;if(Nc(r,n)!=null)return t;{const a=new gd(r,t,i),l=t.eventCache.getNode();let c;if(Ce(n)||Ee(n)===".priority"){let u;if(t.serverCache.isFullyInitialized())u=Rc(r,Qi(t));else{const h=t.serverCache.getNode();ee(h instanceof xe,"serverChildren would be complete if leaf node"),u=pd(r,h)}u=u,c=e.filter.updateFullNode(l,u,s)}else{const u=Ee(n);let h=md(r,u,t.serverCache);h==null&&t.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=e.filter.updateChild(l,u,h,$e(n),a,s):t.eventCache.getNode().hasChild(u)?c=e.filter.updateChild(l,u,xe.EMPTY_NODE,$e(n),a,s):c=l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=Rc(r,Qi(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||Nc(r,De())!=null,Zo(t,c,o,e.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(t,n){this.query_=t,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new cd(r.getIndex()),s=D3(r);this.processor_=ok(s);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(xe.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(xe.EMPTY_NODE,a.getNode(),null),u=new qi(l,o.isFullyInitialized(),i.filtersNodes()),h=new qi(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=vu(h,u),this.eventGenerator_=new U3(this.query_)}get query(){return this.query_}}function mk(e){return e.viewCache_.serverCache.getNode()}function gk(e,t){const n=Qi(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ce(t)&&!n.getImmediateChild(Ee(t)).isEmpty())?n.getChild(t):null}function _m(e){return e.eventRegistrations_.length===0}function xk(e,t){e.eventRegistrations_.push(t)}function ym(e,t,n){const r=[];if(n){ee(t==null,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(t){let i=[];for(let s=0;s<e.eventRegistrations_.length;++s){const o=e.eventRegistrations_[s];if(!o.matches(t))i.push(o);else if(t.hasAnyCallback()){i=i.concat(e.eventRegistrations_.slice(s+1));break}}e.eventRegistrations_=i}else e.eventRegistrations_=[];return r}function wm(e,t,n,r){t.type===Yn.MERGE&&t.source.queryId!==null&&(ee(Qi(e.viewCache_),"We should always have a full cache before handling merges"),ee(z0(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=lk(e.processor_,i,t,n,r);return ak(e.processor_,s.viewCache),ee(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,ny(e,s.changes,s.viewCache.eventCache.getNode(),null)}function vk(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(at,(s,o)=>{r.push(io(s,o))}),n.isFullyInitialized()&&r.push($_(n.getNode())),ny(e,r,n.getNode(),t)}function ny(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return W3(e.eventGenerator_,t,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oc;class _k{constructor(){this.views=new Map}}function yk(e){ee(!Oc,"__referenceConstructor has already been defined"),Oc=e}function wk(){return ee(Oc,"Reference.ts has not been loaded"),Oc}function Ek(e){return e.views.size===0}function xd(e,t,n,r){const i=t.source.queryId;if(i!==null){const s=e.views.get(i);return ee(s!=null,"SyncTree gave us an op for an invalid query."),wm(s,t,n,r)}else{let s=[];for(const o of e.views.values())s=s.concat(wm(o,t,n,r));return s}}function Tk(e,t,n,r,i){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let a=Rc(n,i?r:null),l=!1;a?l=!0:r instanceof xe?(a=pd(n,r),l=!1):(a=xe.EMPTY_NODE,l=!1);const c=vu(new qi(a,l,!1),new qi(r,i,!1));return new pk(t,c)}return o}function Sk(e,t,n,r,i,s){const o=Tk(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),xk(o,n),vk(o,n)}function Ck(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=pi(e);if(i==="default")for(const[l,c]of e.views.entries())o=o.concat(ym(c,n,r)),_m(c)&&(e.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=e.views.get(i);l&&(o=o.concat(ym(l,n,r)),_m(l)&&(e.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!pi(e)&&s.push(new(wk())(t._repo,t._path)),{removed:s,events:o}}function ry(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Hs(e,t){let n=null;for(const r of e.views.values())n=n||gk(r,t);return n}function iy(e,t){if(t._queryParams.loadsAllData())return _u(e);{const r=t._queryIdentifier;return e.views.get(r)}}function sy(e,t){return iy(e,t)!=null}function pi(e){return _u(e)!=null}function _u(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dc;function kk(e){ee(!Dc,"__referenceConstructor has already been defined"),Dc=e}function Ak(){return ee(Dc,"Reference.ts has not been loaded"),Dc}let Ik=1;class Em{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Xe(null),this.pendingWriteTree_=nk(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function oy(e,t,n,r,i){return $3(e.pendingWriteTree_,t,n,r,i),i?Qa(e,new Yi(K_(),t,n)):[]}function bi(e,t,n=!1){const r=G3(e.pendingWriteTree_,t);if(K3(e.pendingWriteTree_,t)){let s=new Xe(null);return r.snap!=null?s=s.set(De(),!0):hn(r.children,o=>{s=s.set(new ze(o),!0)}),Qa(e,new Ic(r.path,s,n))}else return[]}function yu(e,t,n){return Qa(e,new Yi(fd(),t,n))}function Rk(e,t,n){const r=Xe.fromObject(n);return Qa(e,new Pa(fd(),t,r))}function Nk(e,t){return Qa(e,new Da(fd(),t))}function Fk(e,t,n){const r=_d(e,n);if(r){const i=yd(r),s=i.path,o=i.queryId,a=sn(s,t),l=new Da(hd(o),a);return wd(e,s,l)}else return[]}function K0(e,t,n,r,i=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&(t._queryIdentifier==="default"||sy(o,t))){const l=Ck(o,t,n,r);Ek(o)&&(e.syncPointTree_=e.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!i){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,h=e.syncPointTree_.findOnPath(s,(f,p)=>pi(p));if(u&&!h){const f=e.syncPointTree_.subtree(s);if(!f.isEmpty()){const p=Pk(f);for(let g=0;g<p.length;++g){const m=p[g],w=m.query,_=cy(e,m);e.listenProvider_.startListening(ta(w),Pc(e,w),_.hashFn,_.onComplete)}}}!h&&c.length>0&&!r&&(u?e.listenProvider_.stopListening(ta(t),null):c.forEach(f=>{const p=e.queryToTagMap.get(wu(f));e.listenProvider_.stopListening(ta(f),p)}))}Lk(e,c)}return a}function Ok(e,t,n,r){const i=_d(e,r);if(i!=null){const s=yd(i),o=s.path,a=s.queryId,l=sn(o,t),c=new Yi(hd(a),l,n);return wd(e,o,c)}else return[]}function Dk(e,t,n,r){const i=_d(e,r);if(i){const s=yd(i),o=s.path,a=s.queryId,l=sn(o,t),c=Xe.fromObject(n),u=new Pa(hd(a),l,c);return wd(e,o,u)}else return[]}function Tm(e,t,n,r=!1){const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,(f,p)=>{const g=sn(f,i);s=s||Hs(p,g),o=o||pi(p)});let a=e.syncPointTree_.get(i);a?(o=o||pi(a),s=s||Hs(a,De())):(a=new _k,e.syncPointTree_=e.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=xe.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild((p,g)=>{const m=Hs(g,De());m&&(s=s.updateImmediateChild(p,m))}));const c=sy(a,t);if(!c&&!t._queryParams.loadsAllData()){const f=wu(t);ee(!e.queryToTagMap.has(f),"View does not exist, but we have a tag");const p=bk();e.queryToTagMap.set(f,p),e.tagToQueryMap.set(p,f)}const u=dd(e.pendingWriteTree_,i);let h=Sk(a,t,n,u,s,l);if(!c&&!o&&!r){const f=iy(a,t);h=h.concat(Mk(e,t,f))}return h}function vd(e,t,n){const i=e.pendingWriteTree_,s=e.syncPointTree_.findOnPath(t,(o,a)=>{const l=sn(o,t),c=Hs(a,l);if(c)return c});return Q_(i,t,s,n,!0)}function Qa(e,t){return ay(t,e.syncPointTree_,null,dd(e.pendingWriteTree_,De()))}function ay(e,t,n,r){if(Ce(e.path))return ly(e,t,n,r);{const i=t.get(De());n==null&&i!=null&&(n=Hs(i,De()));let s=[];const o=Ee(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,u=J_(r,o);s=s.concat(ay(a,l,c,u))}return i&&(s=s.concat(xd(i,e,r,n))),s}}function ly(e,t,n,r){const i=t.get(De());n==null&&i!=null&&(n=Hs(i,De()));let s=[];return t.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=J_(r,o),u=e.operationForChild(o);u&&(s=s.concat(ly(u,a,l,c)))}),i&&(s=s.concat(xd(i,e,r,n))),s}function cy(e,t){const n=t.query,r=Pc(e,n);return{hashFn:()=>(mk(t)||xe.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?Fk(e,n._path,r):Nk(e,n._path);{const s=O4(i,n);return K0(e,n,null,s)}}}}function Pc(e,t){const n=wu(t);return e.queryToTagMap.get(n)}function wu(e){return e._path.toString()+"$"+e._queryIdentifier}function _d(e,t){return e.tagToQueryMap.get(t)}function yd(e){const t=e.indexOf("$");return ee(t!==-1&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ze(e.substr(0,t))}}function wd(e,t,n){const r=e.syncPointTree_.get(t);ee(r,"Missing sync point for query tag that we're tracking");const i=dd(e.pendingWriteTree_,t);return xd(r,n,i,null)}function Pk(e){return e.fold((t,n,r)=>{if(n&&pi(n))return[_u(n)];{let i=[];return n&&(i=ry(n)),hn(r,(s,o)=>{i=i.concat(o)}),i}})}function ta(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Ak())(e._repo,e._path):e}function Lk(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const i=wu(r),s=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(s)}}}function bk(){return Ik++}function Mk(e,t,n){const r=t._path,i=Pc(e,t),s=cy(e,n),o=e.listenProvider_.startListening(ta(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)ee(!pi(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,h)=>{if(!Ce(c)&&u&&pi(u))return[_u(u).query];{let f=[];return u&&(f=f.concat(ry(u).map(p=>p.query))),hn(h,(p,g)=>{f=f.concat(g)}),f}});for(let c=0;c<l.length;++c){const u=l[c];e.listenProvider_.stopListening(ta(u),Pc(e,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(t){this.node_=t}getImmediateChild(t){const n=this.node_.getImmediateChild(t);return new Ed(n)}node(){return this.node_}}class Td{constructor(t,n){this.syncTree_=t,this.path_=n}getImmediateChild(t){const n=vt(this.path_,t);return new Td(this.syncTree_,n)}node(){return vd(this.syncTree_,this.path_)}}const Bk=function(e){return e=e||{},e.timestamp=e.timestamp||new Date().getTime(),e},Sm=function(e,t,n){if(!e||typeof e!="object")return e;if(ee(".sv"in e,"Unexpected leaf node or priority contents"),typeof e[".sv"]=="string")return jk(e[".sv"],t,n);if(typeof e[".sv"]=="object")return Uk(e[".sv"],t);ee(!1,"Unexpected server value: "+JSON.stringify(e,null,2))},jk=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:ee(!1,"Unexpected server value: "+e)}},Uk=function(e,t,n){e.hasOwnProperty("increment")||ee(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;typeof r!="number"&&ee(!1,"Unexpected increment value: "+r);const i=t.node();if(ee(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},Wk=function(e,t,n,r){return Sd(t,new Td(n,e),r)},uy=function(e,t,n){return Sd(e,new Ed(t),n)};function Sd(e,t,n){const r=e.getPriority().val(),i=Sm(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const o=e,a=Sm(o.getValue(),t,n);return a!==o.getValue()||i!==o.getPriority().val()?new yt(a,Ft(i)):e}else{const o=e;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new yt(i))),o.forEachChild(at,(a,l)=>{const c=Sd(l,t.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(t="",n=null,r={children:{},childCount:0}){this.name=t,this.parent=n,this.node=r}}function kd(e,t){let n=t instanceof ze?t:new ze(t),r=e,i=Ee(n);for(;i!==null;){const s=no(r.node.children,i)||{children:{},childCount:0};r=new Cd(i,r,s),n=$e(n),i=Ee(n)}return r}function mo(e){return e.node.value}function fy(e,t){e.node.value=t,X0(e)}function hy(e){return e.node.childCount>0}function zk(e){return mo(e)===void 0&&!hy(e)}function Eu(e,t){hn(e.node.children,(n,r)=>{t(new Cd(n,e,r))})}function dy(e,t,n,r){n&&!r&&t(e),Eu(e,i=>{dy(i,t,!0,r)}),n&&r&&t(e)}function Hk(e,t,n){let r=n?e:e.parent;for(;r!==null;){if(t(r))return!0;r=r.parent}return!1}function Ja(e){return new ze(e.parent===null?e.name:Ja(e.parent)+"/"+e.name)}function X0(e){e.parent!==null&&Vk(e.parent,e.name,e)}function Vk(e,t,n){const r=zk(n),i=Ur(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,X0(e)):!r&&!i&&(e.node.children[t]=n.node,e.node.childCount++,X0(e))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $k=/[\[\].#$\/\u0000-\u001F\u007F]/,Gk=/[\[\].#$\u0000-\u001F\u007F]/,Ef=10*1024*1024,py=function(e){return typeof e=="string"&&e.length!==0&&!$k.test(e)},my=function(e){return typeof e=="string"&&e.length!==0&&!Gk.test(e)},Kk=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),my(e)},Xk=function(e,t,n,r){r&&t===void 0||Ad(Jh(e,"value"),t,n)},Ad=function(e,t,n){const r=n instanceof ze?new f3(n,e):n;if(t===void 0)throw new Error(e+"contains undefined "+Ri(r));if(typeof t=="function")throw new Error(e+"contains a function "+Ri(r)+" with contents = "+t.toString());if(m_(t))throw new Error(e+"contains "+t.toString()+" "+Ri(r));if(typeof t=="string"&&t.length>Ef/3&&gu(t)>Ef)throw new Error(e+"contains a string greater than "+Ef+" utf8 bytes "+Ri(r)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let i=!1,s=!1;if(hn(t,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!py(o)))throw new Error(e+" contains an invalid key ("+o+") "+Ri(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);h3(r,o),Ad(e,a,r),d3(r)}),i&&s)throw new Error(e+' contains ".value" child '+Ri(r)+" in addition to actual children.")}},gy=function(e,t,n,r){if(!(r&&n===void 0)&&!my(n))throw new Error(Jh(e,t)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Yk=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),gy(e,t,n,r)},qk=function(e,t){if(Ee(t)===".info")throw new Error(e+" failed = Can't modify data under /.info/")},Qk=function(e,t){const n=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!py(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Kk(n))throw new Error(Jh(e,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Id(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();n!==null&&!od(s,n.path)&&(e.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function xy(e,t,n){Id(e,n),vy(e,r=>od(r,t))}function br(e,t,n){Id(e,n),vy(e,r=>Xn(r,t)||Xn(t,r))}function vy(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){const s=i.path;t(s)?(Zk(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Zk(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(n!==null){e.events[t]=null;const r=n.getEventRunner();Ui&&Ht("event: "+n.toString()),po(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eA="repo_interrupt",tA=25;class nA{constructor(t,n,r,i){this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Jk,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ac(),this.transactionQueueTree_=new Cd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function rA(e,t,n){if(e.stats_=id(e.repoInfo_),e.forceRestClient_||b4())e.server_=new kc(e.repoInfo_,(r,i,s,o)=>{Cm(e,r,i,s,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>km(e,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Tt(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new Cr(e.repoInfo_,t,(r,i,s,o)=>{Cm(e,r,i,s,o)},r=>{km(e,r)},r=>{sA(e,r)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(r=>{e.server_.refreshAuthToken(r)}),e.appCheckProvider_.addTokenChangeListener(r=>{e.server_.refreshAppCheckToken(r.token)}),e.statsReporter_=W4(e.repoInfo_,()=>new j3(e.stats_,e.server_)),e.infoData_=new P3,e.infoSyncTree_=new Em({startListening:(r,i,s,o)=>{let a=[];const l=e.infoData_.getNode(r._path);return l.isEmpty()||(a=yu(e.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Nd(e,"connected",!1),e.serverSyncTree_=new Em({startListening:(r,i,s,o)=>(e.server_.listen(r,s,i,(a,l)=>{const c=o(a,l);br(e.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{e.server_.unlisten(r,i)}})}function iA(e){const n=e.infoData_.getNode(new ze(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Rd(e){return Bk({timestamp:iA(e)})}function Cm(e,t,n,r,i){e.dataUpdateCount++;const s=new ze(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const l=wc(n,c=>Ft(c));o=Dk(e.serverSyncTree_,s,l,i)}else{const l=Ft(n);o=Ok(e.serverSyncTree_,s,l,i)}else if(r){const l=wc(n,c=>Ft(c));o=Rk(e.serverSyncTree_,s,l)}else{const l=Ft(n);o=yu(e.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Tu(e,s)),br(e.eventQueue_,a,o)}function km(e,t){Nd(e,"connected",t),t===!1&&aA(e)}function sA(e,t){hn(t,(n,r)=>{Nd(e,n,r)})}function Nd(e,t,n){const r=new ze("/.info/"+t),i=Ft(n);e.infoData_.updateSnapshot(r,i);const s=yu(e.infoSyncTree_,r,i);br(e.eventQueue_,r,s)}function _y(e){return e.nextWriteId_++}function oA(e,t,n,r,i){Fd(e,"set",{path:t.toString(),value:n,priority:r});const s=Rd(e),o=Ft(n,r),a=vd(e.serverSyncTree_,t),l=uy(o,a,s),c=_y(e),u=oy(e.serverSyncTree_,t,l,c,!0);Id(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),(f,p)=>{const g=f==="ok";g||un("set at "+t+" failed: "+f);const m=bi(e.serverSyncTree_,c,!g);br(e.eventQueue_,t,m),uA(e,i,f,p)});const h=Sy(e,t);Tu(e,h),br(e.eventQueue_,h,[])}function aA(e){Fd(e,"onDisconnectEvents");const t=Rd(e),n=Ac();W0(e.onDisconnect_,De(),(i,s)=>{const o=Wk(i,s,e.serverSyncTree_,t);G_(n,i,o)});let r=[];W0(n,De(),(i,s)=>{r=r.concat(yu(e.serverSyncTree_,i,s));const o=Sy(e,i);Tu(e,o)}),e.onDisconnect_=Ac(),br(e.eventQueue_,De(),r)}function lA(e,t,n){let r;Ee(t._path)===".info"?r=Tm(e.infoSyncTree_,t,n):r=Tm(e.serverSyncTree_,t,n),xy(e.eventQueue_,t._path,r)}function Am(e,t,n){let r;Ee(t._path)===".info"?r=K0(e.infoSyncTree_,t,n):r=K0(e.serverSyncTree_,t,n),xy(e.eventQueue_,t._path,r)}function cA(e){e.persistentConnection_&&e.persistentConnection_.interrupt(eA)}function Fd(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Ht(n,...t)}function uA(e,t,n,r){t&&po(()=>{if(n==="ok")t(null);else{const i=(n||"error").toUpperCase();let s=i;r&&(s+=": "+r);const o=new Error(s);o.code=i,t(o)}})}function yy(e,t,n){return vd(e.serverSyncTree_,t,n)||xe.EMPTY_NODE}function Od(e,t=e.transactionQueueTree_){if(t||Su(e,t),mo(t)){const n=Ey(e,t);ee(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&fA(e,Ja(t),n)}else hy(t)&&Eu(t,n=>{Od(e,n)})}function fA(e,t,n){const r=n.map(c=>c.currentWriteId),i=yy(e,t,r);let s=i;const o=i.hash();for(let c=0;c<n.length;c++){const u=n[c];ee(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=sn(t,u.path);s=s.updateChild(h,u.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,c=>{Fd(e,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let f=0;f<n.length;f++)n[f].status=2,u=u.concat(bi(e.serverSyncTree_,n[f].currentWriteId)),n[f].onComplete&&h.push(()=>n[f].onComplete(null,!0,n[f].currentOutputSnapshotResolved)),n[f].unwatcher();Su(e,kd(e.transactionQueueTree_,t)),Od(e,e.transactionQueueTree_),br(e.eventQueue_,t,u);for(let f=0;f<h.length;f++)po(h[f])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{un("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}Tu(e,t)}},o)}function Tu(e,t){const n=wy(e,t),r=Ja(n),i=Ey(e,n);return hA(e,i,r),r}function hA(e,t,n){if(t.length===0)return;const r=[];let i=[];const o=t.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<t.length;a++){const l=t[a],c=sn(n,l.path);let u=!1,h;if(ee(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,i=i.concat(bi(e.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=tA)u=!0,h="maxretry",i=i.concat(bi(e.serverSyncTree_,l.currentWriteId,!0));else{const f=yy(e,l.path,o);l.currentInputSnapshot=f;const p=t[a].update(f.val());if(p!==void 0){Ad("transaction failed: Data returned ",p,l.path);let g=Ft(p);typeof p=="object"&&p!=null&&Ur(p,".priority")||(g=g.updatePriority(f.getPriority()));const w=l.currentWriteId,_=Rd(e),x=uy(g,f,_);l.currentOutputSnapshotRaw=g,l.currentOutputSnapshotResolved=x,l.currentWriteId=_y(e),o.splice(o.indexOf(w),1),i=i.concat(oy(e.serverSyncTree_,l.path,x,l.currentWriteId,l.applyLocally)),i=i.concat(bi(e.serverSyncTree_,w,!0))}else u=!0,h="nodata",i=i.concat(bi(e.serverSyncTree_,l.currentWriteId,!0))}br(e.eventQueue_,n,i),i=[],u&&(t[a].status=2,function(f){setTimeout(f,Math.floor(0))}(t[a].unwatcher),t[a].onComplete&&(h==="nodata"?r.push(()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot)):r.push(()=>t[a].onComplete(new Error(h),!1,null))))}Su(e,e.transactionQueueTree_);for(let a=0;a<r.length;a++)po(r[a]);Od(e,e.transactionQueueTree_)}function wy(e,t){let n,r=e.transactionQueueTree_;for(n=Ee(t);n!==null&&mo(r)===void 0;)r=kd(r,n),t=$e(t),n=Ee(t);return r}function Ey(e,t){const n=[];return Ty(e,t,n),n.sort((r,i)=>r.order-i.order),n}function Ty(e,t,n){const r=mo(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Eu(t,i=>{Ty(e,i,n)})}function Su(e,t){const n=mo(t);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,fy(t,n.length>0?n:void 0)}Eu(t,r=>{Su(e,r)})}function Sy(e,t){const n=Ja(wy(e,t)),r=kd(e.transactionQueueTree_,t);return Hk(r,i=>{Tf(e,i)}),Tf(e,r),dy(r,i=>{Tf(e,i)}),n}function Tf(e,t){const n=mo(t);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(ee(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(ee(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(bi(e.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?fy(t,void 0):n.length=s+1,br(e.eventQueue_,Ja(t),i);for(let o=0;o<r.length;o++)po(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}t+="/"+i}return t}function pA(e){const t={};e.charAt(0)==="?"&&(e=e.substring(1));for(const n of e.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):un(`Invalid query segment '${n}' in query '${e}'`)}return t}const Im=function(e,t){const n=mA(e),r=n.namespace;n.domain==="firebase.com"&&Lr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Lr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||A4();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new A_(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new ze(n.pathString)}},mA=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof e=="string"){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");u===-1&&(u=e.length);let h=e.indexOf("?");h===-1&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=dA(e.substring(u,h)));const f=pA(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(t.substring(c+1),10)):c=t.length;const p=t.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const g=t.indexOf(".");r=t.substring(0,g).toLowerCase(),n=t.substring(g+1),s=r}"ns"in f&&(s=f.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(t,n,r,i){this.eventType=t,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Tt(this.snapshot.exportVal())}}class ky{constructor(t,n,r){this.eventRegistration=t,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(t,n){this.snapshotCallback=t,this.cancelCallback=n}onValue(t,n){this.snapshotCallback.call(null,t,n)}onCancel(t){return ee(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(t,n,r,i){this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return Ce(this._path)?null:b_(this._path)}get ref(){return new Wr(this._repo,this._path)}get _queryIdentifier(){const t=fm(this._queryParams),n=nd(t);return n==="{}"?"default":n}get _queryObject(){return fm(this._queryParams)}isEqual(t){if(t=Bn(t),!(t instanceof Dd))return!1;const n=this._repo===t._repo,r=od(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+u3(this._path)}}class Wr extends Dd{constructor(t,n){super(t,n,new ud,!1)}get parent(){const t=B_(this._path);return t===null?null:new Wr(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class La{constructor(t,n,r){this._node=t,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const n=new ze(t),r=Lc(this.ref,t);return new La(this._node.getChild(n),r,at)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>t(new La(i,Lc(this.ref,r),at)))}hasChild(t){const n=new ze(t);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ae(e,t){return e=Bn(e),e._checkNotDeleted("ref"),t!==void 0?Lc(e._root,t):e._root}function Lc(e,t){return e=Bn(e),Ee(e._path)===null?Yk("child","path",t,!1):gy("child","path",t,!1),new Wr(e._repo,vt(e._path,t))}function xn(e,t){e=Bn(e),qk("set",e._path),Xk("set",t,e._path,!1);const n=new pu;return oA(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}class Pd{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,n){const r=n._queryParams.getIndex();return new Cy("value",this,new La(t.snapshotNode,new Wr(n._repo,n._path),r))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new ky(this,t,n):null}matches(t){return t instanceof Pd?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Ld{constructor(t,n){this.eventType=t,this.callbackContext=n}respondsTo(t){let n=t==="children_added"?"child_added":t;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(t,n){return this.callbackContext.hasCancelCallback?new ky(this,t,n):null}createEvent(t,n){ee(t.childName!=null,"Child events should have a childName.");const r=Lc(new Wr(n._repo,n._path),t.childName),i=n._queryParams.getIndex();return new Cy(t.type,this,new La(t.snapshotNode,r,i),t.prevName)}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof Ld?this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function xA(e,t,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){const l=n,c=(u,h)=>{Am(e._repo,e,a),l(u,h)};c.userCallback=n.userCallback,c.context=n.context,n=c}const o=new gA(n,s||void 0),a=t==="value"?new Pd(o):new Ld(t,o);return lA(e._repo,e,a),()=>Am(e._repo,e,a)}function tt(e,t,n,r){return xA(e,"value",t,n,r)}yk(Wr);kk(Wr);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="FIREBASE_DATABASE_EMULATOR_HOST",Y0={};let _A=!1;function yA(e,t,n,r){const i=t.lastIndexOf(":"),s=t.substring(0,i),o=Ka(s);e.repoInfo_=new A_(t,o,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}function wA(e,t,n,r,i){let s=r||e.options.databaseURL;s===void 0&&(e.options.projectId||Lr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ht("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o=Im(s,i),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[vA]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=Im(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const u=i&&l?new Ws(Ws.OWNER):new B4(e.name,e.options,t);Qk("Invalid Firebase Database URL",o),Ce(o.path)||Lr("Database URL must point to the root of a Firebase Database (not including a child path).");const h=TA(a,e,u,new M4(e,n));return new SA(h,e)}function EA(e,t){const n=Y0[t];(!n||n[e.key]!==e)&&Lr(`Database ${t}(${e.repoInfo_}) has already been deleted.`),cA(e),delete n[e.key]}function TA(e,t,n,r){let i=Y0[t.name];i||(i={},Y0[t.name]=i);let s=i[e.toURLString()];return s&&Lr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new nA(e,_A,n,r),i[e.toURLString()]=s,s}class SA{constructor(t,n){this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(rA(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Wr(this._repo,De())),this._rootInternal}_delete(){return this._rootInternal!==null&&(EA(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Lr("Cannot call "+t+" on a deleted database.")}}function CA(e=td(),t){const n=fo(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const r=Xv("database");r&&kA(n,...r)}return n}function kA(e,t,n,r={}){e=Bn(e),e._checkNotDeleted("useEmulator");const i=`${t}:${n}`,s=e._repoInternal;if(e._instanceStarted){if(i===e._repoInternal.repoInfo_.host&&Aa(r,s.repoInfo_.emulatorOptions))return;Lr("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let o;if(s.repoInfo_.nodeAdmin)r.mockUserToken&&Lr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Ws(Ws.OWNER);else if(r.mockUserToken){const a=typeof r.mockUserToken=="string"?r.mockUserToken:Qv(r.mockUserToken,e.app.options.projectId);o=new Ws(a)}Ka(t)&&(qv(t),Jv("Database",!0)),yA(s,i,r,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(e){E4(l_),Pr(new hr("database",(t,{instanceIdentifier:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return wA(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Ln(X1,Y1,e),Ln(X1,Y1,"esm2020")}Cr.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)};Cr.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};AA();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="firebasestorage.googleapis.com",Iy="storageBucket",IA=2*60*1e3,RA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut extends wi{constructor(t,n,r=0){super(Sf(t),`Firebase Storage: ${n} (${Sf(t)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ut.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return Sf(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ct;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ct||(ct={}));function Sf(e){return"storage/"+e}function bd(){const e="An unknown error occurred, please check the error payload for server response.";return new ut(ct.UNKNOWN,e)}function NA(e){return new ut(ct.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function FA(e){return new ut(ct.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function OA(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ut(ct.UNAUTHENTICATED,e)}function DA(){return new ut(ct.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function PA(e){return new ut(ct.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function LA(){return new ut(ct.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bA(){return new ut(ct.CANCELED,"User canceled the upload/download.")}function MA(e){return new ut(ct.INVALID_URL,"Invalid URL '"+e+"'.")}function BA(e){return new ut(ct.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function jA(){return new ut(ct.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Iy+"' property when initializing the app?")}function UA(){return new ut(ct.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function WA(){return new ut(ct.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function zA(e){return new ut(ct.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function q0(e){return new ut(ct.INVALID_ARGUMENT,e)}function Ry(){return new ut(ct.APP_DELETED,"The Firebase app was deleted.")}function HA(e){return new ut(ct.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function na(e,t){return new ut(ct.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Lo(e){throw new ut(ct.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Er=class Yl{constructor(t,n){this.bucket=t,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,n){let r;try{r=Yl.makeFromUrl(t,n)}catch{return new Yl(t,"")}if(r.path==="")return r;throw BA(t)}static makeFromUrl(t,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(I){I.path_=decodeURIComponent(I.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",p=new RegExp(`^https?://${h}/${u}/b/${i}/o${f}`,"i"),g={bucket:1,path:3},m=n===Ay?"(?:storage.googleapis.com|storage.cloud.google.com)":n,w="([^?#]*)",_=new RegExp(`^https?://${m}/${i}/${w}`,"i"),y=[{regex:a,indices:l,postModify:s},{regex:p,indices:g,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let I=0;I<y.length;I++){const O=y[I],z=O.regex.exec(t);if(z){const N=z[O.indices.bucket];let D=z[O.indices.path];D||(D=""),r=new Yl(N,D),O.postModify(r);break}}if(r==null)throw MA(t);return r}};class VA{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...w){c||(c=!0,t.apply(null,w))}function h(w){i=setTimeout(()=>{i=null,e(p,l())},w)}function f(){s&&clearTimeout(s)}function p(w,..._){if(c){f();return}if(w){f(),u.call(null,w,..._);return}if(l()||o){f(),u.call(null,w,..._);return}r<64&&(r*=2);let y;a===1?(a=2,y=0):y=(r+Math.random())*1e3,h(y)}let g=!1;function m(w){g||(g=!0,f(),!c&&(i!==null?(w||(a=2),clearTimeout(i),h(0)):w||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,m(!0)},n),m}function GA(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(e){return e!==void 0}function XA(e){return typeof e=="object"&&!Array.isArray(e)}function Md(e){return typeof e=="string"||e instanceof String}function Rm(e){return Bd()&&e instanceof Blob}function Bd(){return typeof Blob<"u"}function Nm(e,t,n,r){if(r<t)throw q0(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw q0(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(e,t,n){let r=t;return n==null&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function Ny(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){const i=t(r)+"="+t(e[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Wi;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Wi||(Wi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YA(e,t){const n=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=t.indexOf(e)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(t,n,r,i,s,o,a,l,c,u,h,f=!0,p=!1){this.url_=t,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,m)=>{this.resolve_=g,this.reject_=m,this.start_()})}start_(){const t=(r,i)=>{if(i){r(!1,new Al(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===Wi.NO_ERROR,l=s.getStatus();if(!a||YA(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===Wi.ABORT;r(!1,new Al(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Al(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());KA(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=bd();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?Ry():bA();o(l)}else{const l=LA();o(l)}};this.canceled_?n(!1,new Al(!1,null,!0)):this.backoffId_=$A(t,n,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&GA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Al{constructor(t,n,r){this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}}function QA(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function JA(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function ZA(e,t){t&&(e["X-Firebase-GMPID"]=t)}function eI(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function tI(e,t,n,r,i,s,o=!0,a=!1){const l=Ny(e.urlParams),c=e.url+l,u=Object.assign({},e.headers);return ZA(u,t),QA(u,n),JA(u,s),eI(u,r),new qA(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rI(...e){const t=nI();if(t!==void 0){const n=new t;for(let r=0;r<e.length;r++)n.append(e[r]);return n.getBlob()}else{if(Bd())return new Blob(e);throw new ut(ct.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function iI(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(e){if(typeof atob>"u")throw zA("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Cf{constructor(t,n){this.data=t,this.contentType=n||null}}function oI(e,t){switch(e){case cr.RAW:return new Cf(Fy(t));case cr.BASE64:case cr.BASE64URL:return new Cf(Oy(e,t));case cr.DATA_URL:return new Cf(lI(t),cI(t))}throw bd()}function Fy(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<e.length-1&&(e.charCodeAt(n+1)&64512)===56320))t.push(239,191,189);else{const s=r,o=e.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(t)}function aI(e){let t;try{t=decodeURIComponent(e)}catch{throw na(cr.DATA_URL,"Malformed data URL.")}return Fy(t)}function Oy(e,t){switch(e){case cr.BASE64:{const i=t.indexOf("-")!==-1,s=t.indexOf("_")!==-1;if(i||s)throw na(e,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case cr.BASE64URL:{const i=t.indexOf("+")!==-1,s=t.indexOf("/")!==-1;if(i||s)throw na(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=sI(t)}catch(i){throw i.message.includes("polyfill")?i:na(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class Dy{constructor(t){this.base64=!1,this.contentType=null;const n=t.match(/^data:([^,]+)?,/);if(n===null)throw na(cr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=uI(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}}function lI(e){const t=new Dy(e);return t.base64?Oy(cr.BASE64,t.rest):aI(t.rest)}function cI(e){return new Dy(e).contentType}function uI(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(t,n){let r=0,i="";Rm(t)?(this.data_=t,r=t.size,i=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(t,n){if(Rm(this.data_)){const r=this.data_,i=iI(r,t,n);return i===null?null:new Yr(i)}else{const r=new Uint8Array(this.data_.buffer,t,n-t);return new Yr(r,!0)}}static getBlob(...t){if(Bd()){const n=t.map(r=>r instanceof Yr?r.data_:r);return new Yr(rI.apply(null,n))}else{const n=t.map(o=>Md(o)?oI(cr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Yr(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Py(e){let t;try{t=JSON.parse(e)}catch{return null}return XA(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function hI(e,t){const n=t.split("/").filter(r=>r.length>0).join("/");return e.length===0?n:e+"/"+n}function Ly(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dI(e,t){return t}class Kt{constructor(t,n,r,i){this.server=t,this.local=n||t,this.writable=!!r,this.xform=i||dI}}let Il=null;function pI(e){return!Md(e)||e.length<2?e:Ly(e)}function by(){if(Il)return Il;const e=[];e.push(new Kt("bucket")),e.push(new Kt("generation")),e.push(new Kt("metageneration")),e.push(new Kt("name","fullPath",!0));function t(s,o){return pI(o)}const n=new Kt("name");n.xform=t,e.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new Kt("size");return i.xform=r,e.push(i),e.push(new Kt("timeCreated")),e.push(new Kt("updated")),e.push(new Kt("md5Hash",null,!0)),e.push(new Kt("cacheControl",null,!0)),e.push(new Kt("contentDisposition",null,!0)),e.push(new Kt("contentEncoding",null,!0)),e.push(new Kt("contentLanguage",null,!0)),e.push(new Kt("contentType",null,!0)),e.push(new Kt("metadata","customMetadata",!0)),Il=e,Il}function mI(e,t){function n(){const r=e.bucket,i=e.fullPath,s=new Er(r,i);return t._makeStorageReference(s)}Object.defineProperty(e,"ref",{get:n})}function gI(e,t,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,t[o.server])}return mI(r,e),r}function My(e,t,n){const r=Py(t);return r===null?null:gI(e,r,n)}function xI(e,t,n,r){const i=Py(t);if(i===null||!Md(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const u=e.bucket,h=e.fullPath,f="/b/"+o(u)+"/o/"+o(h),p=jd(f,n,r),g=Ny({alt:"media",token:c});return p+g})[0]}function vI(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const s=t[i];s.writable&&(n[s.server]=e[s.local])}return JSON.stringify(n)}class By{constructor(t,n,r,i){this.url=t,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(e){if(!e)throw bd()}function _I(e,t){function n(r,i){const s=My(e,i,t);return jy(s!==null),s}return n}function yI(e,t){function n(r,i){const s=My(e,i,t);return jy(s!==null),xI(s,i,e.host,e._protocol)}return n}function Uy(e){function t(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=DA():i=OA():n.getStatus()===402?i=FA(e.bucket):n.getStatus()===403?i=PA(e.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return t}function wI(e){const t=Uy(e);function n(r,i){let s=t(r,i);return r.getStatus()===404&&(s=NA(e.path)),s.serverResponse=i.serverResponse,s}return n}function EI(e,t,n){const r=t.fullServerUrl(),i=jd(r,e.host,e._protocol),s="GET",o=e.maxOperationRetryTime,a=new By(i,s,yI(e,n),o);return a.errorHandler=wI(t),a}function TI(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function SI(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=TI(null,t)),r}function CI(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let y="";for(let I=0;I<2;I++)y=y+Math.random().toString().slice(2);return y}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=SI(t,r,i),u=vI(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",p=Yr.getBlob(h,r,f);if(p===null)throw UA();const g={name:c.fullPath},m=jd(s,e.host,e._protocol),w="POST",_=e.maxUploadRetryTime,x=new By(m,w,_I(e,n),_);return x.urlParams=g,x.headers=o,x.body=p.uploadData(),x.errorHandler=Uy(t),x}class kI{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Wi.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Wi.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Wi.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,n,r,i,s){if(this.sent_)throw Lo("cannot .send() more than once");if(Ka(t)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,t,!0),s!==void 0)for(const o in s)s.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,s[o].toString());return i!==void 0?this.xhr_.send(i):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Lo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Lo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Lo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Lo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class AI extends kI{initXhr(){this.xhr_.responseType="text"}}function Wy(){return new AI}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(t,n){this._service=t,n instanceof Er?this._location=n:this._location=Er.makeFromUrl(n,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,n){return new Ji(t,n)}get root(){const t=new Er(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Ly(this._location.path)}get storage(){return this._service}get parent(){const t=fI(this._location.path);if(t===null)return null;const n=new Er(this._location.bucket,t);return new Ji(this._service,n)}_throwIfRoot(t){if(this._location.path==="")throw HA(t)}}function II(e,t,n){e._throwIfRoot("uploadBytes");const r=CI(e.storage,e._location,by(),new Yr(t,!0),n);return e.storage.makeRequestWithTokens(r,Wy).then(i=>({metadata:i,ref:e}))}function RI(e){e._throwIfRoot("getDownloadURL");const t=EI(e.storage,e._location,by());return e.storage.makeRequestWithTokens(t,Wy).then(n=>{if(n===null)throw WA();return n})}function NI(e,t){const n=hI(e._location.path,t),r=new Er(e._location.bucket,n);return new Ji(e.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FI(e){return/^[A-Za-z]+:\/\//.test(e)}function OI(e,t){return new Ji(e,t)}function zy(e,t){if(e instanceof Ud){const n=e;if(n._bucket==null)throw jA();const r=new Ji(n,n._bucket);return t!=null?zy(r,t):r}else return t!==void 0?NI(e,t):e}function DI(e,t){if(t&&FI(t)){if(e instanceof Ud)return OI(e,t);throw q0("To use ref(service, url), the first argument must be a Storage instance.")}else return zy(e,t)}function Fm(e,t){const n=t==null?void 0:t[Iy];return n==null?null:Er.makeFromBucketSpec(n,e)}function PI(e,t,n,r={}){e.host=`${t}:${n}`;const i=Ka(t);i&&(qv(`https://${e.host}/b`),Jv("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";const{mockUserToken:s}=r;s&&(e._overrideAuthToken=typeof s=="string"?s:Qv(s,e.app.options.projectId))}class Ud{constructor(t,n,r,i,s,o=!1){this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._isUsingEmulator=o,this._bucket=null,this._host=Ay,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=IA,this._maxUploadRetryTime=RA,this._requests=new Set,i!=null?this._bucket=Er.makeFromBucketSpec(i,this._host):this._bucket=Fm(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=Er.makeFromBucketSpec(this._url,t):this._bucket=Fm(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){Nm("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){Nm("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const n=await t.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(a_(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new Ji(this,t)}_makeRequest(t,n,r,i,s=!0){if(this._deleted)return new VA(Ry());{const o=tI(t,this._appId,r,i,n,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(t,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,n,r,i).getPromise()}}const Om="@firebase/storage",Dm="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="storage";function LI(e,t,n){return e=Bn(e),II(e,t,n)}function bI(e){return e=Bn(e),RI(e)}function MI(e,t){return e=Bn(e),DI(e,t)}function BI(e=td(),t){e=Bn(e);const r=fo(e,Hy).getImmediate({identifier:t}),i=Xv("storage");return i&&jI(r,...i),r}function jI(e,t,n,r={}){PI(e,t,n,r)}function UI(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new Ud(n,r,i,t,l_)}function WI(){Pr(new hr(Hy,UI,"PUBLIC").setMultipleInstances(!0)),Ln(Om,Dm,""),Ln(Om,Dm,"esm2020")}WI();const Vy="@firebase/installations",Wd="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=1e4,Gy=`w:${Wd}`,Ky="FIS_v2",zI="https://firebaseinstallations.googleapis.com/v1",HI=60*60*1e3,VI="installations",$I="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Zi=new mu(VI,$I,GI);function Xy(e){return e instanceof wi&&e.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yy({projectId:e}){return`${zI}/projects/${e}/installations`}function qy(e){return{token:e.token,requestStatus:2,expiresIn:XI(e.expiresIn),creationTime:Date.now()}}async function Qy(e,t){const r=(await t.json()).error;return Zi.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Jy({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function KI(e,{refreshToken:t}){const n=Jy(e);return n.append("Authorization",YI(t)),n}async function Zy(e){const t=await e();return t.status>=500&&t.status<600?e():t}function XI(e){return Number(e.replace("s","000"))}function YI(e){return`${Ky} ${e}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qI({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=Yy(e),i=Jy(e),s=t.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={fid:n,authVersion:Ky,appId:e.appId,sdkVersion:Gy},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await Zy(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:qy(c.authToken)}}else throw await Qy("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JI=/^[cdef][\w-]{21}$/,Q0="";function ZI(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const n=eR(e);return JI.test(n)?n:Q0}catch{return Q0}}function eR(e){return QI(e).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(e){return`${e.appName}!${e.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=new Map;function n2(e,t){const n=Cu(e);r2(n,t),tR(n,t)}function r2(e,t){const n=t2.get(e);if(n)for(const r of n)r(t)}function tR(e,t){const n=nR();n&&n.postMessage({key:e,fid:t}),rR()}let Mi=null;function nR(){return!Mi&&"BroadcastChannel"in self&&(Mi=new BroadcastChannel("[Firebase] FID Change"),Mi.onmessage=e=>{r2(e.data.key,e.data.fid)}),Mi}function rR(){t2.size===0&&Mi&&(Mi.close(),Mi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR="firebase-installations-database",sR=1,es="firebase-installations-store";let kf=null;function zd(){return kf||(kf=o_(iR,sR,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(es)}}})),kf}async function bc(e,t){const n=Cu(e),i=(await zd()).transaction(es,"readwrite"),s=i.objectStore(es),o=await s.get(n);return await s.put(t,n),await i.done,(!o||o.fid!==t.fid)&&n2(e,t.fid),t}async function i2(e){const t=Cu(e),r=(await zd()).transaction(es,"readwrite");await r.objectStore(es).delete(t),await r.done}async function ku(e,t){const n=Cu(e),i=(await zd()).transaction(es,"readwrite"),s=i.objectStore(es),o=await s.get(n),a=t(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&n2(e,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hd(e){let t;const n=await ku(e.appConfig,r=>{const i=oR(r),s=aR(e,i);return t=s.registrationPromise,s.installationEntry});return n.fid===Q0?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}function oR(e){const t=e||{fid:ZI(),registrationStatus:0};return s2(t)}function aR(e,t){if(t.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Zi.create("app-offline"));return{installationEntry:t,registrationPromise:i}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=lR(e,n);return{installationEntry:n,registrationPromise:r}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:cR(e)}:{installationEntry:t}}async function lR(e,t){try{const n=await qI(e,t);return bc(e.appConfig,n)}catch(n){throw Xy(n)&&n.customData.serverCode===409?await i2(e.appConfig):await bc(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}async function cR(e){let t=await Pm(e.appConfig);for(;t.registrationStatus===1;)await e2(100),t=await Pm(e.appConfig);if(t.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Hd(e);return r||n}return t}function Pm(e){return ku(e,t=>{if(!t)throw Zi.create("installation-not-found");return s2(t)})}function s2(e){return uR(e)?{fid:e.fid,registrationStatus:0}:e}function uR(e){return e.registrationStatus===1&&e.registrationTime+$y<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fR({appConfig:e,heartbeatServiceProvider:t},n){const r=hR(e,n),i=KI(e,n),s=t.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={installation:{sdkVersion:Gy,appId:e.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await Zy(()=>fetch(r,a));if(l.ok){const c=await l.json();return qy(c)}else throw await Qy("Generate Auth Token",l)}function hR(e,{fid:t}){return`${Yy(e)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vd(e,t=!1){let n;const r=await ku(e.appConfig,s=>{if(!o2(s))throw Zi.create("not-registered");const o=s.authToken;if(!t&&mR(o))return s;if(o.requestStatus===1)return n=dR(e,t),s;{if(!navigator.onLine)throw Zi.create("app-offline");const a=xR(s);return n=pR(e,a),a}});return n?await n:r.authToken}async function dR(e,t){let n=await Lm(e.appConfig);for(;n.authToken.requestStatus===1;)await e2(100),n=await Lm(e.appConfig);const r=n.authToken;return r.requestStatus===0?Vd(e,t):r}function Lm(e){return ku(e,t=>{if(!o2(t))throw Zi.create("not-registered");const n=t.authToken;return vR(n)?{...t,authToken:{requestStatus:0}}:t})}async function pR(e,t){try{const n=await fR(e,t),r={...t,authToken:n};return await bc(e.appConfig,r),n}catch(n){if(Xy(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await i2(e.appConfig);else{const r={...t,authToken:{requestStatus:0}};await bc(e.appConfig,r)}throw n}}function o2(e){return e!==void 0&&e.registrationStatus===2}function mR(e){return e.requestStatus===2&&!gR(e)}function gR(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+HI}function xR(e){const t={requestStatus:1,requestTime:Date.now()};return{...e,authToken:t}}function vR(e){return e.requestStatus===1&&e.requestTime+$y<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _R(e){const t=e,{installationEntry:n,registrationPromise:r}=await Hd(t);return r?r.catch(console.error):Vd(t).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yR(e,t=!1){const n=e;return await wR(n),(await Vd(n,t)).token}async function wR(e){const{registrationPromise:t}=await Hd(e);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(e){if(!e||!e.options)throw Af("App Configuration");if(!e.name)throw Af("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw Af(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function Af(e){return Zi.create("missing-app-config-values",{valueName:e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="installations",TR="installations-internal",SR=e=>{const t=e.getProvider("app").getImmediate(),n=ER(t),r=fo(t,"heartbeat");return{app:t,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},CR=e=>{const t=e.getProvider("app").getImmediate(),n=fo(t,a2).getImmediate();return{getId:()=>_R(n),getToken:i=>yR(n,i)}};function kR(){Pr(new hr(a2,SR,"PUBLIC")),Pr(new hr(TR,CR,"PRIVATE"))}kR();Ln(Vy,Wd);Ln(Vy,Wd,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc="analytics",AR="firebase_id",IR="origin",RR=60*1e3,NR="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",$d="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt=new Zh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Tn=new mu("analytics","Analytics",FR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OR(e){if(!e.startsWith($d)){const t=Tn.create("invalid-gtag-resource",{gtagURL:e});return Jt.warn(t.message),""}return e}function l2(e){return Promise.all(e.map(t=>t.catch(n=>n)))}function DR(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}function PR(e,t){const n=DR("firebase-js-sdk-policy",{createScriptURL:OR}),r=document.createElement("script"),i=`${$d}?l=${e}&id=${t}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function LR(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function bR(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const l=(await l2(n)).find(c=>c.measurementId===i);l&&await t[l.appId]}}catch(a){Jt.error(a)}e("config",i,s)}async function MR(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await l2(n);for(const l of o){const c=a.find(h=>h.measurementId===l),u=c&&t[c.appId];if(u)s.push(u);else{s=[];break}}}s.length===0&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(s){Jt.error(s)}}function BR(e,t,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await MR(e,t,n,a,l)}else if(s==="config"){const[a,l]=o;await bR(e,t,n,r,a,l)}else if(s==="consent"){const[a,l]=o;e("consent",a,l)}else if(s==="get"){const[a,l,c]=o;e("get",a,l,c)}else if(s==="set"){const[a]=o;e("set",a)}else e(s,...o)}catch(a){Jt.error(a)}}return i}function jR(e,t,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=BR(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}function UR(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes($d)&&n.src.includes(e))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=30,zR=1e3;class HR{constructor(t={},n=zR){this.throttleMetadata=t,this.intervalMillis=n}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,n){this.throttleMetadata[t]=n}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const c2=new HR;function VR(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function $R(e){var o;const{appId:t,apiKey:n}=e,r={method:"GET",headers:VR(n)},i=NR.replace("{app-id}",t),s=await fetch(i,r);if(s.status!==200&&s.status!==304){let a="";try{const l=await s.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Tn.create("config-fetch-failed",{httpStatus:s.status,responseMessage:a})}return s.json()}async function GR(e,t=c2,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw Tn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Tn.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new YR;return setTimeout(async()=>{a.abort()},n!==void 0?n:RR),u2({appId:r,apiKey:i,measurementId:s},o,a,t)}async function u2(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=c2){var a;const{appId:s,measurementId:o}=e;try{await KR(r,t)}catch(l){if(o)return Jt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:s,measurementId:o};throw l}try{const l=await $R(e);return i.deleteThrottleMetadata(s),l}catch(l){const c=l;if(!XR(c)){if(i.deleteThrottleMetadata(s),o)return Jt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:s,measurementId:o};throw l}const u=Number((a=c==null?void 0:c.customData)==null?void 0:a.httpStatus)===503?j1(n,i.intervalMillis,WR):j1(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return i.setThrottleMetadata(s,h),Jt.debug(`Calling attemptFetch again in ${u} millis`),u2(e,h,r,i)}}function KR(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(s),r(Tn.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function XR(e){if(!(e instanceof wi)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return t===429||t===500||t===503||t===504}class YR{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function qR(e,t,n,r,i){if(i&&i.global){e("event",n,r);return}else{const s=await t,o={...r,send_to:s};e("event",n,o)}}async function QR(e,t,n,r){if(r&&r.global){const i={};for(const s of Object.keys(n))i[`user_properties.${s}`]=n[s];return e("set",i),Promise.resolve()}else{const i=await t;e("config",i,{update:!0,user_properties:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JR(){if(t_())try{await n_()}catch(e){return Jt.warn(Tn.create("indexeddb-unavailable",{errorInfo:e==null?void 0:e.toString()}).message),!1}else return Jt.warn(Tn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function ZR(e,t,n,r,i,s,o){const a=GR(e);a.then(f=>{n[f.measurementId]=f.appId,e.options.measurementId&&f.measurementId!==e.options.measurementId&&Jt.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Jt.error(f)),t.push(a);const l=JR().then(f=>{if(f)return r.getId()}),[c,u]=await Promise.all([a,l]);UR(s)||PR(s,c.measurementId),i("js",new Date);const h=(o==null?void 0:o.config)??{};return h[IR]="firebase",h.update=!0,u!=null&&(h[AR]=u),i("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(t){this.app=t}_delete(){return delete Vs[this.app.options.appId],Promise.resolve()}}let Vs={},bm=[];const Mm={};let If="dataLayer",tN="gtag",Bm,Gd,jm=!1;function nN(){const e=[];if(JS()&&e.push("This is a browser extension environment."),eC()||e.push("Cookies are not available."),e.length>0){const t=e.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Tn.create("invalid-analytics-context",{errorInfo:t});Jt.warn(n.message)}}function rN(e,t,n){nN();const r=e.options.appId;if(!r)throw Tn.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)Jt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Tn.create("no-api-key");if(Vs[r]!=null)throw Tn.create("already-exists",{id:r});if(!jm){LR(If);const{wrappedGtag:s,gtagCore:o}=jR(Vs,bm,Mm,If,tN);Gd=s,Bm=o,jm=!0}return Vs[r]=ZR(e,bm,Mm,t,Bm,If,n),new eN(e)}function iN(e=td()){e=Bn(e);const t=fo(e,Mc);return t.isInitialized()?t.getImmediate():sN(e)}function sN(e,t={}){const n=fo(e,Mc);if(n.isInitialized()){const i=n.getImmediate();if(Aa(t,n.getOptions()))return i;throw Tn.create("already-initialized")}return n.initialize({options:t})}function oN(e,t,n){e=Bn(e),QR(Gd,Vs[e.app.options.appId],t,n).catch(r=>Jt.error(r))}function aN(e,t,n,r){e=Bn(e),qR(Gd,Vs[e.app.options.appId],t,n,r).catch(i=>Jt.error(i))}const Um="@firebase/analytics",Wm="0.10.19";function lN(){Pr(new hr(Mc,(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("installations-internal").getImmediate();return rN(r,i,n)},"PUBLIC")),Pr(new hr("analytics-internal",e,"PRIVATE")),Ln(Um,Wm),Ln(Um,Wm,"esm2020");function e(t){try{const n=t.getProvider(Mc).getImmediate();return{logEvent:(r,i,s)=>aN(n,r,i,s),setUserProperties:(r,i)=>oN(n,r,i)}}catch(n){throw Tn.create("interop-component-reg-failed",{reason:n})}}}lN();const cN={apiKey:"AIzaSyDqPrel2q-GHoHWgAYcpTLR_Hvou-XphIY",authDomain:"hjwedding-a7674.firebaseapp.com",projectId:"hjwedding-a7674",storageBucket:"hjwedding-a7674.firebasestorage.app",messagingSenderId:"189631736454",appId:"1:189631736454:web:8b3b0ce172b85f75b4bf07",measurementId:"G-Y1S7Q5CBQG"},Kd=c_(cN);iN(Kd);const Ie=CA(Kd),uN=BI(Kd),fN=()=>{const[e,t]=ce.useState({groomName:"",brideName:"",date:"2026. 11. 21.()",message:`"  , 
   "`});return ce.useEffect(()=>{const n=Ae(Ie,"wedding_info");tt(n,r=>{const i=r.val();i&&t(s=>({...s,...i}))})},[]),d.jsxs("div",{className:"section",style:{position:"relative",padding:"100px 20px",backgroundColor:"#fff",overflow:"hidden",minHeight:"600px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"#333"},children:[e.mainImage&&d.jsx("img",{src:e.mainImage,alt:"Wedding Main",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",objectPosition:"center",opacity:e.mainImageOpacity||.6,zIndex:0},loading:"eager",fetchPriority:"high"}),d.jsxs("div",{style:{position:"relative",zIndex:1,width:"100%",textAlign:"center",color:e.heroTextColor||"#333"},children:[d.jsx("p",{style:{fontSize:"18px",letterSpacing:"2px",marginBottom:"20px",textTransform:"uppercase",color:e.heroTextColor?e.heroTextColor:"#555",fontFamily:e.heroFontFamily||"inherit",opacity:.8},children:"Wedding Invitation"}),d.jsxs("h1",{style:{fontSize:`${e.heroTitleFontSize||32}px`,marginBottom:"15px",fontWeight:"bold",color:e.heroTextColor||"#333",fontFamily:e.heroFontFamily||"inherit"},children:[e.groomName," ",d.jsx("span",{style:{fontSize:`${(e.heroTitleFontSize||32)*.75}px`,fontWeight:"normal"},children:"&"})," ",e.brideName]}),d.jsx("p",{style:{fontSize:`${e.heroDateFontSize||18}px`,color:e.heroTextColor||"#444"},children:e.date}),e.locationName&&d.jsx("p",{style:{fontSize:`${(e.heroDateFontSize||18)*.85}px`,color:e.heroTextColor||"#444",marginBottom:"40px",fontWeight:"400",fontFamily:e.heroFontFamily||"inherit",opacity:.9},children:e.locationName}),d.jsx("div",{style:{marginBottom:"40px"},children:d.jsx("p",{style:{whiteSpace:"pre-line",fontSize:`${e.heroMessageFontSize||16}px`,lineHeight:"2",color:e.heroTextColor||"#333",fontFamily:e.heroFontFamily||"inherit"},children:e.message})})]})]})},hN=()=>{const[e,t]=ce.useState({invitationPoem:`    
    
   

<>, `,invitationTitle:"  .",invitationBody:` 
   
  .

     
   .`});return ce.useEffect(()=>{const n=Ae(Ie,"wedding_info");tt(n,r=>{const i=r.val();i&&t(s=>({...s,invitationPoem:i.invitationPoem||s.invitationPoem,invitationTitle:i.invitationTitle||s.invitationTitle,invitationBody:i.invitationBody||s.invitationBody}))})},[]),d.jsxs("div",{className:"section",style:{backgroundColor:"#fff",padding:"80px 20px",textAlign:"center"},children:[d.jsx("div",{className:"fade-in-up",style:{marginBottom:"60px"},children:d.jsx("p",{style:{fontSize:"15px",lineHeight:"2.2",color:"#555",fontFamily:"'Gowun Dodum', sans-serif",whiteSpace:"pre-line",fontWeight:"500"},children:e.invitationPoem})}),d.jsx("div",{className:"fade-in-up",style:{animationDelay:"0.2s",marginBottom:"30px"},children:d.jsx("h3",{style:{fontSize:"18px",color:"#ff9090",fontWeight:"normal",marginBottom:"0"},children:e.invitationTitle})}),d.jsx("div",{className:"fade-in-up",style:{animationDelay:"0.4s"},children:d.jsx("p",{style:{fontSize:"15px",lineHeight:"2.0",color:"#555",whiteSpace:"pre-line",fontFamily:"'Gowun Dodum', sans-serif"},children:e.invitationBody})}),d.jsx("hr",{style:{width:"50px",border:"1px solid #eee",margin:"60px auto 0"}})]})},dN=()=>{const[e,t]=ce.useState({groomName:"",brideName:"",groomImage:"",brideImage:"",groomHashtags:"",brideHashtags:"",groomIntro:"",brideIntro:""});return ce.useEffect(()=>{const n=Ae(Ie,"wedding_info");tt(n,r=>{const i=r.val();i&&t(s=>({...s,...i}))})},[]),!e.groomImage&&!e.brideImage?null:d.jsxs("div",{className:"section",style:{backgroundColor:"#fafafa",padding:"60px 20px",textAlign:"center"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"40px",maxWidth:"800px",margin:"0 auto"},children:[d.jsxs("div",{className:"fade-in-up",style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[d.jsx("div",{style:{width:"100%",maxWidth:"300px",aspectRatio:"1/1",borderRadius:"4px",overflow:"hidden",marginBottom:"20px",boxShadow:"0 5px 15px rgba(0,0,0,0.1)",backgroundColor:"#eee"},children:e.groomImage?d.jsx("img",{src:e.groomImage,alt:"Groom",style:{width:"100%",height:"100%",objectFit:"cover"}}):d.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#aaa"},children:"No Image"})}),d.jsxs("div",{style:{marginBottom:"10px"},children:[d.jsx("span",{style:{fontSize:"14px",color:"#0066cc",fontWeight:"bold",marginRight:"5px"},children:""}),d.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:e.groomName})]}),e.groomBirth&&d.jsx("p",{style:{color:"#666",fontSize:"14px",margin:"0 0 3px 0"},children:e.groomBirth}),e.groomRegion&&d.jsx("p",{style:{color:"#666",fontSize:"14px",margin:"0 0 20px 0"},children:e.groomRegion}),e.groomHashtags&&d.jsx("p",{style:{color:"#0066cc",fontSize:"14px",marginBottom:"10px",wordBreak:"keep-all"},children:e.groomHashtags}),d.jsx("p",{style:{fontSize:"15px",lineHeight:"1.6",color:"#555",whiteSpace:"pre-line",wordBreak:"keep-all",fontFamily:"'Gowun Dodum', sans-serif"},children:e.groomIntro})]}),d.jsxs("div",{className:"fade-in-up",style:{display:"flex",flexDirection:"column",alignItems:"center",animationDelay:"0.2s"},children:[d.jsx("div",{style:{width:"100%",maxWidth:"300px",aspectRatio:"1/1",borderRadius:"4px",overflow:"hidden",marginBottom:"20px",boxShadow:"0 5px 15px rgba(0,0,0,0.1)",backgroundColor:"#eee"},children:e.brideImage?d.jsx("img",{src:e.brideImage,alt:"Bride",style:{width:"100%",height:"100%",objectFit:"cover"}}):d.jsx("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#aaa"},children:"No Image"})}),d.jsxs("div",{style:{marginBottom:"10px"},children:[d.jsx("span",{style:{fontSize:"14px",color:"#ff6699",fontWeight:"bold",marginRight:"5px"},children:""}),d.jsx("span",{style:{fontSize:"18px",fontWeight:"bold",color:"#333"},children:e.brideName})]}),e.brideBirth&&d.jsx("p",{style:{color:"#666",fontSize:"14px",margin:"0 0 3px 0"},children:e.brideBirth}),e.brideRegion&&d.jsx("p",{style:{color:"#666",fontSize:"14px",margin:"0 0 20px 0"},children:e.brideRegion}),e.brideHashtags&&d.jsx("p",{style:{color:"#ff6699",fontSize:"14px",marginBottom:"10px",wordBreak:"keep-all"},children:e.brideHashtags}),d.jsx("p",{style:{fontSize:"15px",lineHeight:"1.6",color:"#555",whiteSpace:"pre-line",wordBreak:"keep-all",fontFamily:"'Gowun Dodum', sans-serif"},children:e.brideIntro})]})]}),d.jsx("hr",{style:{width:"50px",border:"1px solid #eee",margin:"60px auto 0"}})]})},pN=()=>{const[e,t]=ce.useState({groom:[],bride:[]}),[n,r]=ce.useState(!1);ce.useEffect(()=>{const u=Ae(Ie,"wedding_contacts");tt(u,h=>{const f=h.val();t(p=>({groom:[],bride:[],...f}))})},[]);const i=u=>{navigator.clipboard.writeText(u).then(()=>{alert(` : ${u}`)}).catch(()=>{const h=document.createElement("textarea");h.value=u,document.body.appendChild(h),h.select(),document.execCommand("copy"),document.body.removeChild(h),alert(` : ${u}`)})},s={father:"",mother:"",me:"",older_sister:"",younger_brother:"",maternal_grandmother:"",paternal_grandmother:"",other:""},o=(u,h)=>h==="me"?u==="groom"?"":"":s[h]||h,a=()=>{r(!0),document.body.style.overflow="hidden",document.body.classList.add("rsvp-modal-open")},l=()=>{r(!1),document.body.style.overflow="auto",document.body.classList.remove("rsvp-modal-open")},c=(u,h)=>{const f=u==="groom"?"#5a96c4":"#e88ca6";return d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{marginBottom:"20px",color:f,fontSize:"16px"},children:u==="groom"?"":""}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"25px",alignItems:"center"},children:h.map((p,g)=>d.jsxs("div",{style:{textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"15px",color:"#555",marginBottom:"8px"},children:[d.jsx("span",{style:{marginRight:"5px",color:"#888"},children:o(u,p.relation)}),d.jsx("span",{style:{fontWeight:"normal",color:"#333"},children:p.name})]}),d.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"15px",alignItems:"center"},children:[d.jsx("a",{href:`tel:${p.phone}`,style:{textDecoration:"none",display:"flex",alignItems:"center",color:f},children:d.jsx("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"currentColor",children:d.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"})})}),d.jsx("button",{onClick:()=>i(p.phone),style:{background:"none",border:`1px solid ${f}`,borderRadius:"3px",color:f,cursor:"pointer",fontSize:"12px",padding:"2px 8px",marginLeft:"5px"},children:""})]})]},g))})]})};return e.groom.length===0&&e.bride.length===0?null:d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"section",style:{padding:"40px 20px",backgroundColor:"#fff",textAlign:"center"},children:[d.jsx("button",{onClick:a,style:{padding:"15px 40px",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"4px",fontSize:"16px",color:"#555",cursor:"pointer",boxShadow:"0 2px 5px rgba(0,0,0,0.05)"},children:""}),d.jsx("hr",{style:{width:"50px",border:"1px solid #eee",margin:"40px auto 0"}})]}),n&&qh.createPortal(d.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"#fff",zIndex:9999,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"20px"},children:d.jsxs("div",{style:{position:"relative",width:"100%",maxWidth:"500px",backgroundColor:"#fff",padding:"40px 20px",borderRadius:"8px",textAlign:"center"},children:[d.jsx("button",{onClick:l,style:{position:"absolute",top:"-20px",right:"0px",border:"none",background:"none",fontSize:"30px",cursor:"pointer",color:"#999",fontWeight:"lighter"},children:""}),d.jsx("h3",{style:{marginBottom:"50px",color:"#333",fontSize:"18px",fontWeight:"normal"},children:""}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[c("groom",e.groom||[]),c("bride",e.bride||[])]})]})}),document.body)]})},mN=()=>{const[e,t]=ce.useState({name:" ",address:"   103-18",trafficSubway:"1  1   3",trafficBus:"  ",trafficParking:"    (2 )"});return ce.useEffect(()=>{const n=Ae(Ie,"wedding_info");tt(n,r=>{const i=r.val();i&&t({name:i.locationName||"",address:i.locationAddress||"  ",mapImage:i.mapImage,linkTmap:i.linkTmap,linkKakao:i.linkKakao,linkNaver:i.linkNaver,trafficSubway:i.trafficSubway,trafficBus:i.trafficBus,trafficParking:i.trafficParking})})},[]),d.jsxs("div",{className:"section",children:[d.jsx("h3",{children:" "}),d.jsx("p",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"5px"},children:e.name}),d.jsx("p",{children:e.address}),d.jsx("div",{id:"map",onClick:()=>e.linkNaver?window.open(e.linkNaver):alert("    ."),style:{width:"100%",minHeight:"300px",backgroundColor:"#eee",margin:"20px 0",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",cursor:e.linkNaver?"pointer":"default"},children:d.jsx("img",{src:e.mapImage||"https://via.placeholder.com/400x300?text=Map+Image",alt:"",onError:n=>{n.target.onerror=null,n.target.src="https://via.placeholder.com/400x300?text=No+Image"},style:{width:"100%",height:"auto",display:"block"}})}),d.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsx("button",{className:"btn",style:{flex:1},onClick:()=>e.linkTmap?window.open(e.linkTmap):alert("  ."),children:"T-Map"}),d.jsx("button",{className:"btn",style:{flex:1},onClick:()=>e.linkKakao?window.open(e.linkKakao):alert("  ."),children:"Kakao Navi"}),d.jsx("button",{className:"btn",style:{flex:1},onClick:()=>e.linkNaver?window.open(e.linkNaver):alert("  ."),children:"Naver Map"})]}),d.jsx("div",{style:{marginTop:"30px",textAlign:"left",padding:"0 10px"},children:(e.trafficSubway||e.trafficBus||e.trafficParking)&&d.jsxs(d.Fragment,{children:[d.jsx("h4",{style:{fontSize:"16px",color:"#d77",marginBottom:"15px"},children:" "}),e.trafficSubway&&d.jsxs("div",{style:{marginBottom:"15px",display:"flex",gap:"10px"},children:[d.jsx("div",{style:{fontSize:"20px",minWidth:"24px"},children:""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"4px"},children:""}),d.jsx("div",{style:{fontSize:"14px",color:"#555",lineHeight:"1.5",whiteSpace:"pre-line"},children:e.trafficSubway})]})]}),e.trafficBus&&d.jsxs("div",{style:{marginBottom:"15px",display:"flex",gap:"10px"},children:[d.jsx("div",{style:{fontSize:"20px",minWidth:"24px"},children:""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"4px"},children:""}),d.jsx("div",{style:{fontSize:"14px",color:"#555",lineHeight:"1.5",whiteSpace:"pre-line"},children:e.trafficBus})]})]}),e.trafficParking&&d.jsxs("div",{style:{marginBottom:"15px",display:"flex",gap:"10px"},children:[d.jsx("div",{style:{fontSize:"20px",minWidth:"24px"},children:""}),d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"4px"},children:""}),d.jsx("div",{style:{fontSize:"14px",color:"#555",lineHeight:"1.5",whiteSpace:"pre-line"},children:e.trafficParking})]})]})]})})]})},gN=()=>{const[e,t]=ce.useState(!1),[n,r]=ce.useState(!1),[i,s]=ce.useState(!0),[o,a]=ce.useState("name"),[l,c]=ce.useState([]),[u,h]=ce.useState({name:"",phone:"",count:1,side:"groom",meal:!0}),[f,p]=ce.useState({});ce.useEffect(()=>{const P=Ae(Ie,"guests");tt(P,K=>{const te=K.val();c(te||[])});const H=Ae(Ie,"wedding_info");tt(H,K=>{const te=K.val();p(te||{groomName:"",brideName:"",date:"2026 11 21   4 40",locationName:" ",locationAddress:"   103-18"})})},[]);const[g,m]=ce.useState(!1);ce.useEffect(()=>{const P=H=>{e&&(t(!1),m(!1),document.body.style.overflow="auto",document.body.classList.remove("rsvp-modal-open"))};return window.addEventListener("popstate",P),()=>window.removeEventListener("popstate",P)},[e]);const w=(P="new")=>{r(P==="edit"),s(P==="edit"),h({name:"",phone:"",count:1,side:"groom",meal:!0}),a("name"),O([]),N(""),window.history.pushState({modal:"rsvp"},"",window.location.href),m(!0),t(!0),document.body.style.overflow="hidden",document.body.classList.add("rsvp-modal-open")},_=()=>{g?window.history.back():(t(!1),document.body.style.overflow="auto",document.body.classList.remove("rsvp-modal-open"))};ce.useEffect(()=>()=>{document.body.style.overflow="auto",document.body.classList.remove("rsvp-modal-open")},[]);const x=P=>P.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(\-{1,2})$/g,""),y=P=>{if(P.preventDefault(),!u.name||!u.phone){alert("   .");return}if(n){const H=l.map(K=>K.id===u.id?{...K,...u,date:new Date().toLocaleString()}:K);xn(Ae(Ie,"guests"),H).then(()=>alert("  .")).catch(K=>alert(" : "+K.message))}else{if(l.find(we=>we.name===u.name&&we.phone===u.phone)){alert('   . "" .');return}const K={...u,id:Date.now(),date:new Date().toLocaleString()},te=[...l,K];xn(Ae(Ie,"guests"),te).then(()=>alert("  . !")).catch(we=>alert(" : "+we.message))}_()},[I,O]=ce.useState([]),[z,N]=ce.useState(""),D=()=>{O([]);let P=[];if(o==="name"){if(!u.name.trim()){alert(" .");return}P=l.filter(H=>H.name.trim()===u.name.trim())}else{if(!u.phone){alert(" .");return}const H=l.find(K=>K.phone===u.phone);H&&(P=[H])}P.length===0?alert("    ."):P.length===1?(h(P[0]),s(!1)):O(P)},L=()=>{if(!z||z.length<4){alert("  4 .");return}const P=I.find(H=>H.phone.replace(/[^0-9]/g,"").endsWith(z));P?(h(P),s(!1),O([]),N("")):alert("  .   4 .")};return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"section",style:{backgroundColor:"#fafafa",padding:"40px 20px",textAlign:"center"},children:[d.jsx("h3",{children:"  "}),d.jsx("p",{children:"   ."}),d.jsxs("div",{style:{marginTop:"20px",display:"flex",gap:"10px",justifyContent:"center"},children:[d.jsx("button",{onClick:()=>w("new"),className:"btn btn-point",style:{padding:"15px 30px",fontSize:"16px"},children:"  "}),d.jsx("button",{onClick:()=>w("edit"),className:"btn",style:{padding:"15px 20px",backgroundColor:"#fff",border:"1px solid #ddd",color:"#666"},children:""})]})]}),e&&qh.createPortal(d.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.85)",zIndex:2147483647,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:d.jsxs("div",{style:{backgroundColor:"white",borderRadius:"15px",width:"100%",maxWidth:"400px",maxHeight:"80vh",display:"flex",flexDirection:"column",position:"relative",boxShadow:"0 5px 20px rgba(0,0,0,0.2)",overflow:"hidden"},children:[d.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid #f0f0f0",position:"relative",textAlign:"center",flexShrink:0},children:[d.jsx("button",{onClick:_,style:{position:"absolute",top:"15px",right:"15px",border:"none",background:"none",fontSize:"24px",cursor:"pointer",color:"#999",padding:"5px",lineHeight:1},children:""}),d.jsx("h3",{style:{fontSize:"20px",margin:0,color:"#333"},children:"  "})]}),d.jsxs("div",{style:{flex:1,overflowY:"auto",padding:"20px 30px 40px",textAlign:"center"},children:[d.jsxs("p",{style:{fontSize:"14px",lineHeight:"1.6",color:"#555",marginBottom:"20px"},children:["   ",d.jsx("br",{}),"   ,",d.jsx("br",{}),"   ."]}),d.jsx("div",{style:{borderTop:"1px dashed #ddd",margin:"20px 0"}}),d.jsxs("div",{style:{textAlign:"left",fontSize:"15px",color:"#333",lineHeight:"2",marginBottom:"30px",paddingLeft:"10px"},children:[d.jsxs("div",{children:["  ",f.groomName,",  ",f.brideName]}),d.jsxs("div",{children:[" ",f.date]}),d.jsxs("div",{children:[" ",f.locationName||" ",d.jsx("br",{}),d.jsxs("span",{style:{fontSize:"13px",color:"#666",paddingLeft:"24px"},children:["(",f.locationAddress||"  ",")"]})]})]}),n&&i?d.jsxs("div",{style:{textAlign:"left"},children:[d.jsx("h4",{style:{marginBottom:"10px"},children:" "}),d.jsxs("select",{value:o,onChange:P=>a(P.target.value),style:{width:"100%",padding:"12px",marginBottom:"10px",borderRadius:"4px",border:"1px solid #ddd"},children:[d.jsx("option",{value:"name",children:" "}),d.jsx("option",{value:"phone",children:" "})]}),o==="name"?d.jsx("input",{placeholder:" (: )",style:{width:"100%",padding:"12px",marginBottom:"10px",borderRadius:"4px",border:"1px solid #ddd"},value:u.name,onChange:P=>h({...u,name:P.target.value})}):d.jsx("input",{placeholder:" (: 010-0000-0000)",style:{width:"100%",padding:"12px",marginBottom:"10px",borderRadius:"4px",border:"1px solid #ddd"},value:u.phone,onChange:P=>h({...u,phone:x(P.target.value)}),maxLength:13}),I.length>0?d.jsxs("div",{style:{marginTop:"10px",padding:"15px",backgroundColor:"#f9f9f9",borderRadius:"8px",border:"1px solid #eee"},children:[d.jsxs("p",{style:{fontSize:"14px",color:"#ff6666",marginBottom:"10px",fontWeight:"bold"},children:["     ",d.jsx("br",{}),"  ."]}),d.jsx("input",{placeholder:"  4 (: 1234)",style:{width:"100%",padding:"12px",marginBottom:"10px",borderRadius:"4px",border:"1px solid #ddd"},value:z,onChange:P=>N(P.target.value.replace(/[^0-9]/g,"").slice(0,4)),maxLength:4}),d.jsx("button",{className:"btn btn-point",style:{width:"100%"},onClick:L,children:""})]}):d.jsx("button",{className:"btn btn-point",style:{width:"100%"},onClick:D,children:""})]}):d.jsxs("form",{onSubmit:y,style:{textAlign:"left"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"30px",marginBottom:"20px"},children:[d.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",margin:0,fontSize:"16px"},children:[d.jsx("input",{type:"radio",name:"side",checked:u.side==="groom",onChange:()=>h({...u,side:"groom"}),style:{marginRight:"8px",transform:"scale(1.2)"}}),""]}),d.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",margin:0,fontSize:"16px"},children:[d.jsx("input",{type:"radio",name:"side",checked:u.side==="bride",onChange:()=>h({...u,side:"bride"}),style:{marginRight:"8px",transform:"scale(1.2)"}}),""]})]}),d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#666"},children:""}),d.jsx("input",{type:"text",value:u.name,onChange:P=>h({...u,name:P.target.value}),placeholder:"",readOnly:n,style:{width:"100%",padding:"12px",marginBottom:"15px",borderRadius:"8px",border:"1px solid #ddd",backgroundColor:n?"#f5f5f5":"#fff"}}),d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#666"},children:""}),d.jsx("input",{type:"tel",value:u.phone,onChange:P=>h({...u,phone:x(P.target.value)}),placeholder:"010-0000-0000",readOnly:n,maxLength:13,style:{width:"100%",padding:"12px",marginBottom:"15px",borderRadius:"8px",border:"1px solid #ddd",backgroundColor:n?"#f5f5f5":"#fff"}}),d.jsxs("div",{style:{display:"flex",gap:"15px",marginBottom:"20px"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#666"},children:""}),d.jsx("select",{value:u.count,onChange:P=>h({...u,count:Number(P.target.value)}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd"},children:[1,2,3,4,5,6,7,8,9,10,11,12].map(P=>d.jsxs("option",{value:P,children:[P,""]},P))})]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"14px",color:"#666"},children:" "}),d.jsxs("select",{value:u.meal,onChange:P=>h({...u,meal:P.target.value==="true"}),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd"},children:[d.jsx("option",{value:"true",children:""}),d.jsx("option",{value:"false",children:""})]})]})]}),d.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[d.jsx("button",{type:"submit",className:"btn btn-point",style:{flex:1},children:n?"":"  "}),n&&d.jsx("button",{type:"button",onClick:()=>{if(window.confirm("   ?")){const P=l.filter(H=>H.id!==u.id);xn(Ae(Ie,"guests"),P).then(()=>{alert("."),_()}).catch(H=>alert(" : "+H.message))}},className:"btn",style:{flex:1,backgroundColor:"#666",color:"#fff"},children:" ( )"})]})]})]})]})}),document.body)]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Bc={};Bc.version="0.18.5";var f2=1252,xN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],h2=function(e){xN.indexOf(e)!=-1&&(f2=e)};function vN(){h2(1252)}var ba=function(e){h2(e)};function _N(){ba(1200),vN()}function yN(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Rl=function(t){return String.fromCharCode(t)},zm=function(t){return String.fromCharCode(t)},Ni,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ma(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0,c=0;c<e.length;)n=e.charCodeAt(c++),s=n>>2,r=e.charCodeAt(c++),o=(n&3)<<4|r>>4,i=e.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),t+=Jr.charAt(s)+Jr.charAt(o)+Jr.charAt(a)+Jr.charAt(l);return t}function Mr(e){var t="",n=0,r=0,i=0,s=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Jr.indexOf(e.charAt(c++)),o=Jr.indexOf(e.charAt(c++)),n=s<<2|o>>4,t+=String.fromCharCode(n),a=Jr.indexOf(e.charAt(c++)),r=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(r)),l=Jr.indexOf(e.charAt(c++)),i=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Oe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),zr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ts(e){return Oe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Hm(e){return Oe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Kn=function(t){return Oe?zr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Au(e){if(typeof ArrayBuffer>"u")return Kn(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function Za(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function wN(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Dt=Oe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:zr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function EN(e){for(var t=[],n=0,r=e.length+250,i=ts(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|a>>6&15|(o&3)<<4,i[n++]=128|a&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(t.push(i.slice(0,n)),n=0,i=ts(65535),r=65530)}return t.push(i.slice(0,n)),Dt(t)}var ra=/\u0000/g,Nl=/[\u0001-\u0006]/g;function $s(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function qn(e,t){var n=""+e;return n.length>=t?n:ot("0",t-n.length)+n}function Xd(e,t){var n=""+e;return n.length>=t?n:ot(" ",t-n.length)+n}function jc(e,t){var n=""+e;return n.length>=t?n:n+ot(" ",t-n.length)}function TN(e,t){var n=""+Math.round(e);return n.length>=t?n:ot("0",t-n.length)+n}function SN(e,t){var n=""+e;return n.length>=t?n:ot("0",t-n.length)+n}var Vm=Math.pow(2,32);function ms(e,t){if(e>Vm||e<-Vm)return TN(e,t);var n=Math.round(e);return SN(n,t)}function Uc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var $m=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rf=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function CN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Gm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Wc(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=s):(u=c,a=o)),!n)return[0,r*a,u];var f=Math.floor(r*a/u);return[f,r*a-f*u,u]}function Fl(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=DN(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var d2=new Date(1899,11,31,0,0,0),AN=d2.getTime(),IN=new Date(1900,2,1,0,0,0);function p2(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=IN&&(n+=24*60*60*1e3),(n-(AN+(e.getTimezoneOffset()-d2.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Yd(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function RN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NN(e){var t=e<0?12:11,n=Yd(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function FN(e){var t=Yd(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ON(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=NN(e):t===10?n=e.toFixed(10).substr(0,12):n=FN(e),Yd(RN(n.toUpperCase()))}function J0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ON(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return mi(14,p2(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function DN(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function PN(e,t,n,r){var i="",s=0,o=0,a=n.y,l,c=0;switch(e){case 98:a=n.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=n.m,c=t.length;break;case 3:return Rf[n.m-1][1];case 5:return Rf[n.m-1][0];default:return Rf[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=n.d,c=t.length;break;case 3:return $m[n.q][0];default:return $m[n.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?qn(n.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=qn(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?qn(l,c):"";return u}function Zr(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var m2=/%/g;function LN(e,t,n){var r=t.replace(m2,""),i=t.length-r.length;return kr(e,r,n*Math.pow(10,2*i))+ot("%",i)}function bN(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return kr(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function g2(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+g2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var x2=/# (\?+)( ?)\/( ?)(\d+)/;function MN(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,a=r;return n+(s===0?"":""+s)+" "+(o===0?ot(" ",e[1].length+1+e[4].length):Xd(o,e[1].length)+e[2]+"/"+e[3]+qn(a,e[4].length))}function BN(e,t,n){return n+(t===0?"":""+t)+ot(" ",e[1].length+2+e[4].length)}var v2=/^#*0*\.([0#]+)/,_2=/\).*[0#]/,y2=/\(###\) ###\\?-####/;function Yt(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function Km(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Xm(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function jN(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function UN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Rn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(_2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Rn("n",r,n):"("+Rn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return bN(e,t,n);if(t.indexOf("%")!==-1)return LN(e,t,n);if(t.indexOf("E")!==-1)return g2(t,n);if(t.charCodeAt(0)===36)return"$"+Rn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+ms(l,t.length);if(t.match(/^[#?]+$/))return i=ms(n,0),i==="0"&&(i=""),i.length>t.length?i:Yt(t.substr(0,t.length-i.length))+i;if(s=t.match(x2))return MN(s,l,c);if(t.match(/^#+0+$/))return c+ms(l,t.length-t.indexOf("0"));if(s=t.match(v2))return i=Km(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Yt(s[1])).replace(/\.$/,"."+Yt(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+ot("0",Yt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+Km(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Zr(ms(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Rn(e,t,-n):Zr(""+(Math.floor(n)+jN(n,s[1].length)))+"."+qn(Xm(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Rn(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=$s(Rn(e,t.replace(/[\\-]/g,""),n)),o=0,$s($s(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(y2))return i=Rn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Wc(l,Math.pow(10,o)-1,!1),i=""+c,u=kr("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=jc(a[2],o),u.length<s[4].length&&(u=Yt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Wc(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Xd(a[1],o)+s[2]+"/"+s[3]+jc(a[2],o):ot(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=ms(n,0),t.length<=i.length?i:Yt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=t.indexOf(".")-o,f=t.length-i.length-h;return Yt(t.substr(0,h)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Xm(n,s[1].length),n<0?"-"+Rn(e,t,-n):Zr(UN(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?qn(0,3-g.length):"")+g})+"."+qn(o,s[1].length);switch(t){case"###,##0.00":return Rn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var p=Zr(ms(l,0));return p!=="0"?c+p:"";case"###,###.00":return Rn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Rn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function WN(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return kr(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function zN(e,t,n){var r=t.replace(m2,""),i=t.length-r.length;return kr(e,r,n*Math.pow(10,2*i))+ot("%",i)}function w2(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+w2(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function sr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(_2)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?sr("n",r,n):"("+sr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return WN(e,t,n);if(t.indexOf("%")!==-1)return zN(e,t,n);if(t.indexOf("E")!==-1)return w2(t,n);if(t.charCodeAt(0)===36)return"$"+sr(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,a,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+qn(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:Yt(t.substr(0,t.length-i.length))+i;if(s=t.match(x2))return BN(s,l,c);if(t.match(/^#+0+$/))return c+qn(l,t.length-t.indexOf("0"));if(s=t.match(v2))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Yt(s[1])).replace(/\.$/,"."+Yt(s[1])),i=i.replace(/\.(\d*)$/,function(g,m){return"."+m+ot("0",Yt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Zr(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+sr(e,t,-n):Zr(""+n)+"."+ot("0",s[1].length);if(s=t.match(/^#,#*,#0/))return sr(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=$s(sr(e,t.replace(/[\\-]/g,""),n)),o=0,$s($s(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<i.length?i.charAt(o++):g==="0"?"0":""}));if(t.match(y2))return i=sr(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Wc(l,Math.pow(10,o)-1,!1),i=""+c,u=kr("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=jc(a[2],o),u.length<s[4].length&&(u=Yt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Wc(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?Xd(a[1],o)+s[2]+"/"+s[3]+jc(a[2],o):ot(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Yt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=t.indexOf(".")-o,f=t.length-i.length-h;return Yt(t.substr(0,h)+i+t.substr(t.length-f))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+sr(e,t,-n):Zr(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?qn(0,3-g.length):"")+g})+"."+qn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Zr(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return sr(e,t.slice(0,t.lastIndexOf(".")),n)+Yt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function kr(e,t,n){return(n|0)===n?sr(e,t,n):Rn(e,t,n)}function HN(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var E2=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function T2(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Uc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(E2))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function VN(e,t,n,r){for(var i=[],s="",o=0,a="",l="t",c,u,h,f="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!Uc(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var p=e.charAt(++o),g=p==="("||p===")"?p:"t";i[i.length]={t:g,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=Fl(t,n,e.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Fl(t,n),c==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=f),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var m={t:a,v:a};if(c==null&&(c=Fl(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",f="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",o+=5,f="h"):e.substr(o,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",o+=5,f="h"):(m.t="t",++o),c==null&&m.t==="T")return"";i[i.length]=m,l=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(E2)){if(c==null&&(c=Fl(t,n),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",T2(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var w=0,_=0,x;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=f,l="h",w<1&&(w=1);break;case"s":(x=i[o].v.match(/\.0+$/))&&(_=Math.max(_,x[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[o].v.match(/[Hh]/)&&(w=1),w<2&&i[o].v.match(/[Mm]/)&&(w=2),w<3&&i[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",I;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=PN(i[o].t.charCodeAt(0),i[o].v,c,_),i[o].t="t";break;case"n":case"?":for(I=o+1;i[I]!=null&&((a=i[I].t)==="?"||a==="D"||(a===" "||a==="t")&&i[I+1]!=null&&(i[I+1].t==="?"||i[I+1].t==="t"&&i[I+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[I].v==="/"||i[I].v===" "&&i[I+1]!=null&&i[I+1].t=="?"));)i[o].v+=i[I].v,i[I]={v:"",t:";"},++I;y+=i[o].v,o=I-1;break;case"G":i[o].t="t",i[o].v=J0(t,n);break}var O="",z,N;if(y.length>0){y.charCodeAt(0)==40?(z=t<0&&y.charCodeAt(0)===45?-t:t,N=kr("n",y,z)):(z=t<0&&r>1?-t:t,N=kr("n",y,z),z<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),I=N.length-1;var D=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){D=o;break}var L=i.length;if(D===i.length&&N.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(I>=i[o].v.length-1?(I-=i[o].v.length,i[o].v=N.substr(I+1,i[o].v.length)):I<0?i[o].v="":(i[o].v=N.substr(0,I+1),I=-1),i[o].t="t",L=o);I>=0&&L<i.length&&(i[L].v=N.substr(0,I+1)+i[L].v)}else if(D!==i.length&&N.indexOf("E")===-1){for(I=N.indexOf(".")-1,o=D;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===D?i[o].v.indexOf(".")-1:i[o].v.length-1,O=i[o].v.substr(u+1);u>=0;--u)I>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(O=N.charAt(I--)+O);i[o].v=O,i[o].t="t",L=o}for(I>=0&&L<i.length&&(i[L].v=N.substr(0,I+1)+i[L].v),I=N.indexOf(".")+1,o=D;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==D)){for(u=i[o].v.indexOf(".")>-1&&o===D?i[o].v.indexOf(".")+1:0,O=i[o].v.substr(0,u);u<i[o].v.length;++u)I<N.length&&(O+=N.charAt(I++));i[o].v=O,i[o].t="t",L=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(z=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=kr(i[o].t,i[o].v,z),i[o].t="t");var P="";for(o=0;o!==i.length;++o)i[o]!=null&&(P+=i[o].v);return P}var Ym=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qm(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function $N(e,t){var n=HN(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Ym),a=n[1].match(Ym);return qm(t,o)?[r,n[0]]:qm(t,a)?[r,n[1]]:[r,n[o!=null&&a!=null?2:1]]}return[r,s]}function mi(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:lt)[e],r==null&&(r=n.table&&n.table[Gm[e]]||lt[Gm[e]]),r==null&&(r=kN[e]||"General");break}if(Uc(r,0))return J0(t,n);t instanceof Date&&(t=p2(t,n.date1904));var i=$N(r,t);if(Uc(i[1]))return J0(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return VN(i[1],t,n,i[0])}function S2(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(lt[n]==null){t<0&&(t=n);continue}if(lt[n]==e){t=n;break}}t<0&&(t=391)}return lt[t]=e,t}function Iu(e){for(var t=0;t!=392;++t)e[t]!==void 0&&S2(e[t],t)}function Ru(){lt=CN()}var C2=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function GN(e){var t=typeof e=="number"?lt[e]:e;return t=t.replace(C2,"(\\d+)"),new RegExp("^"+t+"$")}function KN(e,t,n){var r=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(C2)||[]).forEach(function(h,f){var p=parseInt(n[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=p;break;case"d":s=p;break;case"h":o=p;break;case"s":l=p;break;case"m":o>=0?a=p:i=p;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&s==-1?u:c+"T"+u}var XN=function(){var e={};e.version="1.2.0";function t(){for(var N=0,D=new Array(256),L=0;L!=256;++L)N=L,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,D[L]=N;return typeof Int32Array<"u"?new Int32Array(D):D}var n=t();function r(N){var D=0,L=0,P=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)H[P]=N[P];for(P=0;P!=256;++P)for(L=N[P],D=256+P;D<4096;D+=256)L=H[D]=L>>>8^N[L&255];var K=[];for(P=1;P!=16;++P)K[P-1]=typeof Int32Array<"u"?H.subarray(P*256,P*256+256):H.slice(P*256,P*256+256);return K}var i=r(n),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],f=i[7],p=i[8],g=i[9],m=i[10],w=i[11],_=i[12],x=i[13],y=i[14];function I(N,D){for(var L=D^-1,P=0,H=N.length;P<H;)L=L>>>8^n[(L^N.charCodeAt(P++))&255];return~L}function O(N,D){for(var L=D^-1,P=N.length-15,H=0;H<P;)L=y[N[H++]^L&255]^x[N[H++]^L>>8&255]^_[N[H++]^L>>16&255]^w[N[H++]^L>>>24]^m[N[H++]]^g[N[H++]]^p[N[H++]]^f[N[H++]]^h[N[H++]]^u[N[H++]]^c[N[H++]]^l[N[H++]]^a[N[H++]]^o[N[H++]]^s[N[H++]]^n[N[H++]];for(P+=15;H<P;)L=L>>>8^n[(L^N[H++])&255];return~L}function z(N,D){for(var L=D^-1,P=0,H=N.length,K=0,te=0;P<H;)K=N.charCodeAt(P++),K<128?L=L>>>8^n[(L^K)&255]:K<2048?(L=L>>>8^n[(L^(192|K>>6&31))&255],L=L>>>8^n[(L^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,te=N.charCodeAt(P++)&1023,L=L>>>8^n[(L^(240|K>>8&7))&255],L=L>>>8^n[(L^(128|K>>2&63))&255],L=L>>>8^n[(L^(128|te>>6&15|(K&3)<<4))&255],L=L>>>8^n[(L^(128|te&63))&255]):(L=L>>>8^n[(L^(224|K>>12&15))&255],L=L>>>8^n[(L^(128|K>>6&63))&255],L=L>>>8^n[(L^(128|K&63))&255]);return~L}return e.table=n,e.bstr=I,e.buf=O,e.str=z,e}(),Ue=function(){var t={};t.version="1.2.1";function n(v,C){for(var E=v.split("/"),S=C.split("/"),k=0,A=0,j=Math.min(E.length,S.length);k<j;++k){if(A=E[k].length-S[k].length)return A;if(E[k]!=S[k])return E[k]<S[k]?-1:1}return E.length-S.length}function r(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:r(v.slice(0,-1));var C=v.lastIndexOf("/");return C===-1?v:v.slice(0,C+1)}function i(v){if(v.charAt(v.length-1)=="/")return i(v.slice(0,-1));var C=v.lastIndexOf("/");return C===-1?v:v.slice(C+1)}function s(v,C){typeof C=="string"&&(C=new Date(C));var E=C.getHours();E=E<<6|C.getMinutes(),E=E<<5|C.getSeconds()>>>1,v.write_shift(2,E);var S=C.getFullYear()-1980;S=S<<4|C.getMonth()+1,S=S<<5|C.getDate(),v.write_shift(2,S)}function o(v){var C=v.read_shift(2)&65535,E=v.read_shift(2)&65535,S=new Date,k=E&31;E>>>=5;var A=E&15;E>>>=4,S.setMilliseconds(0),S.setFullYear(E+1980),S.setMonth(A-1),S.setDate(k);var j=C&31;C>>>=5;var G=C&63;return C>>>=6,S.setHours(C),S.setMinutes(G),S.setSeconds(j<<1),S}function a(v){vn(v,0);for(var C={},E=0;v.l<=v.length-4;){var S=v.read_shift(2),k=v.read_shift(2),A=v.l+k,j={};switch(S){case 21589:E=v.read_shift(1),E&1&&(j.mtime=v.read_shift(4)),k>5&&(E&2&&(j.atime=v.read_shift(4)),E&4&&(j.ctime=v.read_shift(4))),j.mtime&&(j.mt=new Date(j.mtime*1e3));break}v.l=A,C[S]=j}return C}var l;function c(){return l||(l={})}function u(v,C){if(v[0]==80&&v[1]==75)return kp(v,C);if((v[0]|32)==109&&(v[1]|32)==105)return lE(v,C);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var E=3,S=512,k=0,A=0,j=0,G=0,B=0,U=[],W=v.slice(0,512);vn(W,0);var q=h(W);switch(E=q[0],E){case 3:S=512;break;case 4:S=4096;break;case 0:if(q[1]==0)return kp(v,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}S!==512&&(W=v.slice(0,S),vn(W,28));var oe=v.slice(0,S);f(W,E);var ue=W.read_shift(4,"i");if(E===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);W.l+=4,j=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),G=W.read_shift(4,"i"),k=W.read_shift(4,"i"),B=W.read_shift(4,"i"),A=W.read_shift(4,"i");for(var J=-1,le=0;le<109&&(J=W.read_shift(4,"i"),!(J<0));++le)U[le]=J;var _e=p(v,S);w(B,A,_e,S,U);var Je=x(_e,j,U,S);Je[j].name="!Directory",k>0&&G!==te&&(Je[G].name="!MiniFAT"),Je[U[0]].name="!FAT",Je.fat_addrs=U,Je.ssz=S;var Ze={},jt=[],yo=[],wo=[];y(j,Je,_e,jt,k,Ze,yo,G),g(yo,wo,jt),jt.shift();var Eo={FileIndex:yo,FullPaths:wo};return C&&C.raw&&(Eo.raw={header:oe,sectors:_e}),Eo}function h(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(we,"Header Signature: "),v.l+=16;var C=v.read_shift(2,"u");return[v.read_shift(2,"u"),C]}function f(v,C){var E=9;switch(v.l+=2,E=v.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function p(v,C){for(var E=Math.ceil(v.length/C)-1,S=[],k=1;k<E;++k)S[k-1]=v.slice(k*C,(k+1)*C);return S[E-1]=v.slice(E*C),S}function g(v,C,E){for(var S=0,k=0,A=0,j=0,G=0,B=E.length,U=[],W=[];S<B;++S)U[S]=W[S]=S,C[S]=E[S];for(;G<W.length;++G)S=W[G],k=v[S].L,A=v[S].R,j=v[S].C,U[S]===S&&(k!==-1&&U[k]!==k&&(U[S]=U[k]),A!==-1&&U[A]!==A&&(U[S]=U[A])),j!==-1&&(U[j]=S),k!==-1&&S!=U[S]&&(U[k]=U[S],W.lastIndexOf(k)<G&&W.push(k)),A!==-1&&S!=U[S]&&(U[A]=U[S],W.lastIndexOf(A)<G&&W.push(A));for(S=1;S<B;++S)U[S]===S&&(A!==-1&&U[A]!==A?U[S]=U[A]:k!==-1&&U[k]!==k&&(U[S]=U[k]));for(S=1;S<B;++S)if(v[S].type!==0){if(G=S,G!=U[G])do G=U[G],C[S]=C[G]+"/"+C[S];while(G!==0&&U[G]!==-1&&G!=U[G]);U[S]=-1}for(C[0]+="/",S=1;S<B;++S)v[S].type!==2&&(C[S]+="/")}function m(v,C,E){for(var S=v.start,k=v.size,A=[],j=S;E&&k>0&&j>=0;)A.push(C.slice(j*K,j*K+K)),k-=K,j=Fi(E,j*4);return A.length===0?V(0):Dt(A).slice(0,v.size)}function w(v,C,E,S,k){var A=te;if(v===te){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var j=E[v],G=(S>>>2)-1;if(!j)return;for(var B=0;B<G&&(A=Fi(j,B*4))!==te;++B)k.push(A);w(Fi(j,S-4),C-1,E,S,k)}}function _(v,C,E,S,k){var A=[],j=[];k||(k=[]);var G=S-1,B=0,U=0;for(B=C;B>=0;){k[B]=!0,A[A.length]=B,j.push(v[B]);var W=E[Math.floor(B*4/S)];if(U=B*4&G,S<4+U)throw new Error("FAT boundary crossed: "+B+" 4 "+S);if(!v[W])break;B=Fi(v[W],U)}return{nodes:A,data:ig([j])}}function x(v,C,E,S){var k=v.length,A=[],j=[],G=[],B=[],U=S-1,W=0,q=0,oe=0,ue=0;for(W=0;W<k;++W)if(G=[],oe=W+C,oe>=k&&(oe-=k),!j[oe]){B=[];var J=[];for(q=oe;q>=0;){J[q]=!0,j[q]=!0,G[G.length]=q,B.push(v[q]);var le=E[Math.floor(q*4/S)];if(ue=q*4&U,S<4+ue)throw new Error("FAT boundary crossed: "+q+" 4 "+S);if(!v[le]||(q=Fi(v[le],ue),J[q]))break}A[oe]={nodes:G,data:ig([B])}}return A}function y(v,C,E,S,k,A,j,G){for(var B=0,U=S.length?2:0,W=C[v].data,q=0,oe=0,ue;q<W.length;q+=128){var J=W.slice(q,q+128);vn(J,64),oe=J.read_shift(2),ue=ep(J,0,oe-U),S.push(ue);var le={name:ue,type:J.read_shift(1),color:J.read_shift(1),L:J.read_shift(4,"i"),R:J.read_shift(4,"i"),C:J.read_shift(4,"i"),clsid:J.read_shift(16),state:J.read_shift(4,"i"),start:0,size:0},_e=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);_e!==0&&(le.ct=I(J,J.l-8));var Je=J.read_shift(2)+J.read_shift(2)+J.read_shift(2)+J.read_shift(2);Je!==0&&(le.mt=I(J,J.l-8)),le.start=J.read_shift(4,"i"),le.size=J.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=te,le.name=""),le.type===5?(B=le.start,k>0&&B!==te&&(C[B].name="!StreamData")):le.size>=4096?(le.storage="fat",C[le.start]===void 0&&(C[le.start]=_(E,le.start,C.fat_addrs,C.ssz)),C[le.start].name=le.name,le.content=C[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:B!==te&&le.start!==te&&C[B]&&(le.content=m(le,C[B].data,(C[G]||{}).data))),le.content&&vn(le.content,0),A[ue]=le,j.push(le)}}function I(v,C){return new Date((yn(v,C+4)/1e7*Math.pow(2,32)+yn(v,C)/1e7-11644473600)*1e3)}function O(v,C){return c(),u(l.readFileSync(v),C)}function z(v,C){var E=C&&C.type;switch(E||Oe&&Buffer.isBuffer(v)&&(E="buffer"),E||"base64"){case"file":return O(v,C);case"base64":return u(Kn(Mr(v)),C);case"binary":return u(Kn(v),C)}return u(v,C)}function N(v,C){var E=C||{},S=E.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=S+"/",v.FileIndex[0]={name:S,type:5}),E.CLSID&&(v.FileIndex[0].clsid=E.CLSID),D(v)}function D(v){var C="Sh33tJ5";if(!Ue.find(v,"/"+C)){var E=V(4);E[0]=55,E[1]=E[3]=50,E[2]=54,v.FileIndex.push({name:C,type:2,content:E,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+C),L(v)}}function L(v,C){N(v);for(var E=!1,S=!1,k=v.FullPaths.length-1;k>=0;--k){var A=v.FileIndex[k];switch(A.type){case 0:S?E=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(A.R*A.L*A.C)&&(E=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!C)){var j=new Date(1987,1,19),G=0,B=Object.create?Object.create(null):{},U=[];for(k=0;k<v.FullPaths.length;++k)B[v.FullPaths[k]]=!0,v.FileIndex[k].type!==0&&U.push([v.FullPaths[k],v.FileIndex[k]]);for(k=0;k<U.length;++k){var W=r(U[k][0]);S=B[W],S||(U.push([W,{name:i(W).replace("/",""),type:1,clsid:He,ct:j,mt:j,content:null}]),B[W]=!0)}for(U.sort(function(ue,J){return n(ue[0],J[0])}),v.FullPaths=[],v.FileIndex=[],k=0;k<U.length;++k)v.FullPaths[k]=U[k][0],v.FileIndex[k]=U[k][1];for(k=0;k<U.length;++k){var q=v.FileIndex[k],oe=v.FullPaths[k];if(q.name=i(oe).replace("/",""),q.L=q.R=q.C=-(q.color=1),q.size=q.content?q.content.length:0,q.start=0,q.clsid=q.clsid||He,k===0)q.C=U.length>1?1:-1,q.size=0,q.type=5;else if(oe.slice(-1)=="/"){for(G=k+1;G<U.length&&r(v.FullPaths[G])!=oe;++G);for(q.C=G>=U.length?-1:G,G=k+1;G<U.length&&r(v.FullPaths[G])!=r(oe);++G);q.R=G>=U.length?-1:G,q.type=1}else r(v.FullPaths[k+1]||"")==r(oe)&&(q.R=k+1),q.type=2}}}function P(v,C){var E=C||{};if(E.fileType=="mad")return cE(v,E);switch(L(v),E.fileType){case"zip":return nE(v,E)}var S=function(ue){for(var J=0,le=0,_e=0;_e<ue.FileIndex.length;++_e){var Je=ue.FileIndex[_e];if(Je.content){var Ze=Je.content.length;Ze>0&&(Ze<4096?J+=Ze+63>>6:le+=Ze+511>>9)}}for(var jt=ue.FullPaths.length+3>>2,yo=J+7>>3,wo=J+127>>7,Eo=yo+le+jt+wo,Ci=Eo+127>>7,ju=Ci<=109?0:Math.ceil((Ci-109)/127);Eo+Ci+ju+127>>7>Ci;)ju=++Ci<=109?0:Math.ceil((Ci-109)/127);var gr=[1,ju,Ci,wo,jt,le,J,0];return ue.FileIndex[0].size=J<<6,gr[7]=(ue.FileIndex[0].start=gr[0]+gr[1]+gr[2]+gr[3]+gr[4]+gr[5])+(gr[6]+7>>3),gr}(v),k=V(S[7]<<9),A=0,j=0;{for(A=0;A<8;++A)k.write_shift(1,ve[A]);for(A=0;A<8;++A)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),A=0;A<3;++A)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,S[2]),k.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:te),k.write_shift(4,S[3]),k.write_shift(-4,S[1]?S[0]-1:te),k.write_shift(4,S[1]),A=0;A<109;++A)k.write_shift(-4,A<S[2]?S[1]+A:-1)}if(S[1])for(j=0;j<S[1];++j){for(;A<236+j*127;++A)k.write_shift(-4,A<S[2]?S[1]+A:-1);k.write_shift(-4,j===S[1]-1?te:j+1)}var G=function(ue){for(j+=ue;A<j-1;++A)k.write_shift(-4,A+1);ue&&(++A,k.write_shift(-4,te))};for(j=A=0,j+=S[1];A<j;++A)k.write_shift(-4,We.DIFSECT);for(j+=S[2];A<j;++A)k.write_shift(-4,We.FATSECT);G(S[3]),G(S[4]);for(var B=0,U=0,W=v.FileIndex[0];B<v.FileIndex.length;++B)W=v.FileIndex[B],W.content&&(U=W.content.length,!(U<4096)&&(W.start=j,G(U+511>>9)));for(G(S[6]+7>>3);k.l&511;)k.write_shift(-4,We.ENDOFCHAIN);for(j=A=0,B=0;B<v.FileIndex.length;++B)W=v.FileIndex[B],W.content&&(U=W.content.length,!(!U||U>=4096)&&(W.start=j,G(U+63>>6)));for(;k.l&511;)k.write_shift(-4,We.ENDOFCHAIN);for(A=0;A<S[4]<<2;++A){var q=v.FullPaths[A];if(!q||q.length===0){for(B=0;B<17;++B)k.write_shift(4,0);for(B=0;B<3;++B)k.write_shift(4,-1);for(B=0;B<12;++B)k.write_shift(4,0);continue}W=v.FileIndex[A],A===0&&(W.start=W.size?W.start-1:te);var oe=A===0&&E.root||W.name;if(U=2*(oe.length+1),k.write_shift(64,oe,"utf16le"),k.write_shift(2,U),k.write_shift(1,W.type),k.write_shift(1,W.color),k.write_shift(-4,W.L),k.write_shift(-4,W.R),k.write_shift(-4,W.C),W.clsid)k.write_shift(16,W.clsid,"hex");else for(B=0;B<4;++B)k.write_shift(4,0);k.write_shift(4,W.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,W.start),k.write_shift(4,W.size),k.write_shift(4,0)}for(A=1;A<v.FileIndex.length;++A)if(W=v.FileIndex[A],W.size>=4096)if(k.l=W.start+1<<9,Oe&&Buffer.isBuffer(W.content))W.content.copy(k,k.l,0,W.size),k.l+=W.size+511&-512;else{for(B=0;B<W.size;++B)k.write_shift(1,W.content[B]);for(;B&511;++B)k.write_shift(1,0)}for(A=1;A<v.FileIndex.length;++A)if(W=v.FileIndex[A],W.size>0&&W.size<4096)if(Oe&&Buffer.isBuffer(W.content))W.content.copy(k,k.l,0,W.size),k.l+=W.size+63&-64;else{for(B=0;B<W.size;++B)k.write_shift(1,W.content[B]);for(;B&63;++B)k.write_shift(1,0)}if(Oe)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function H(v,C){var E=v.FullPaths.map(function(B){return B.toUpperCase()}),S=E.map(function(B){var U=B.split("/");return U[U.length-(B.slice(-1)=="/"?2:1)]}),k=!1;C.charCodeAt(0)===47?(k=!0,C=E[0].slice(0,-1)+C):k=C.indexOf("/")!==-1;var A=C.toUpperCase(),j=k===!0?E.indexOf(A):S.indexOf(A);if(j!==-1)return v.FileIndex[j];var G=!A.match(Nl);for(A=A.replace(ra,""),G&&(A=A.replace(Nl,"!")),j=0;j<E.length;++j)if((G?E[j].replace(Nl,"!"):E[j]).replace(ra,"")==A||(G?S[j].replace(Nl,"!"):S[j]).replace(ra,"")==A)return v.FileIndex[j];return null}var K=64,te=-2,we="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],He="00000000000000000000000000000000",We={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:we,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:He,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(v,C,E){c();var S=P(v,E);l.writeFileSync(C,S)}function de(v){for(var C=new Array(v.length),E=0;E<v.length;++E)C[E]=String.fromCharCode(v[E]);return C.join("")}function me(v,C){var E=P(v,C);switch(C&&C.type||"buffer"){case"file":return c(),l.writeFileSync(C.filename,E),E;case"binary":return typeof E=="string"?E:de(E);case"base64":return Ma(typeof E=="string"?E:de(E));case"buffer":if(Oe)return Buffer.isBuffer(E)?E:zr(E);case"array":return typeof E=="string"?Kn(E):E}return E}var Se;function F(v){try{var C=v.InflateRaw,E=new C;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)Se=v;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function M(v,C){if(!Se)return Sp(v,C);var E=Se.InflateRaw,S=new E,k=S._processChunk(v.slice(v.l),S._finishFlushFlag);return v.l+=S.bytesRead,k}function T(v){return Se?Se.deflateRawSync(v):vp(v)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],b=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(v){var C=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(C>>16|C>>8|C)&255}for(var ae=typeof Uint8Array<"u",ie=ae?new Uint8Array(256):[],ge=0;ge<256;++ge)ie[ge]=ne(ge);function pe(v,C){var E=ie[v&255];return C<=8?E>>>8-C:(E=E<<8|ie[v>>8&255],C<=16?E>>>16-C:(E=E<<8|ie[v>>16&255],E>>>24-C))}function je(v,C){var E=C&7,S=C>>>3;return(v[S]|(E<=6?0:v[S+1]<<8))>>>E&3}function Ne(v,C){var E=C&7,S=C>>>3;return(v[S]|(E<=5?0:v[S+1]<<8))>>>E&7}function pr(v,C){var E=C&7,S=C>>>3;return(v[S]|(E<=4?0:v[S+1]<<8))>>>E&15}function it(v,C){var E=C&7,S=C>>>3;return(v[S]|(E<=3?0:v[S+1]<<8))>>>E&31}function he(v,C){var E=C&7,S=C>>>3;return(v[S]|(E<=1?0:v[S+1]<<8))>>>E&127}function In(v,C,E){var S=C&7,k=C>>>3,A=(1<<E)-1,j=v[k]>>>S;return E<8-S||(j|=v[k+1]<<8-S,E<16-S)||(j|=v[k+2]<<16-S,E<24-S)||(j|=v[k+3]<<24-S),j&A}function mr(v,C,E){var S=C&7,k=C>>>3;return S<=5?v[k]|=(E&7)<<S:(v[k]|=E<<S&255,v[k+1]=(E&7)>>8-S),C+3}function Ti(v,C,E){var S=C&7,k=C>>>3;return E=(E&1)<<S,v[k]|=E,C+1}function hs(v,C,E){var S=C&7,k=C>>>3;return E<<=S,v[k]|=E&255,E>>>=8,v[k+1]=E,C+8}function xp(v,C,E){var S=C&7,k=C>>>3;return E<<=S,v[k]|=E&255,E>>>=8,v[k+1]=E&255,v[k+2]=E>>>8,C+16}function Lu(v,C){var E=v.length,S=2*E>C?2*E:C+5,k=0;if(E>=C)return v;if(Oe){var A=Hm(S);if(v.copy)v.copy(A);else for(;k<v.length;++k)A[k]=v[k];return A}else if(ae){var j=new Uint8Array(S);if(j.set)j.set(v);else for(;k<E;++k)j[k]=v[k];return j}return v.length=S,v}function nr(v){for(var C=new Array(v),E=0;E<v;++E)C[E]=0;return C}function ol(v,C,E){var S=1,k=0,A=0,j=0,G=0,B=v.length,U=ae?new Uint16Array(32):nr(32);for(A=0;A<32;++A)U[A]=0;for(A=B;A<E;++A)v[A]=0;B=v.length;var W=ae?new Uint16Array(B):nr(B);for(A=0;A<B;++A)U[k=v[A]]++,S<k&&(S=k),W[A]=0;for(U[0]=0,A=1;A<=S;++A)U[A+16]=G=G+U[A-1]<<1;for(A=0;A<B;++A)G=v[A],G!=0&&(W[A]=U[G+16]++);var q=0;for(A=0;A<B;++A)if(q=v[A],q!=0)for(G=pe(W[A],S)>>S-q,j=(1<<S+4-q)-1;j>=0;--j)C[G|j<<q]=q&15|A<<4;return S}var bu=ae?new Uint16Array(512):nr(512),Mu=ae?new Uint16Array(32):nr(32);if(!ae){for(var Si=0;Si<512;++Si)bu[Si]=0;for(Si=0;Si<32;++Si)Mu[Si]=0}(function(){for(var v=[],C=0;C<32;C++)v.push(5);ol(v,Mu,32);var E=[];for(C=0;C<=143;C++)E.push(8);for(;C<=255;C++)E.push(9);for(;C<=279;C++)E.push(7);for(;C<=287;C++)E.push(8);ol(E,bu,288)})();var Jw=function(){for(var C=ae?new Uint8Array(32768):[],E=0,S=0;E<Y.length-1;++E)for(;S<Y[E+1];++S)C[S]=E;for(;S<32768;++S)C[S]=29;var k=ae?new Uint8Array(259):[];for(E=0,S=0;E<b.length-1;++E)for(;S<b[E+1];++S)k[S]=E;function A(G,B){for(var U=0;U<G.length;){var W=Math.min(65535,G.length-U),q=U+W==G.length;for(B.write_shift(1,+q),B.write_shift(2,W),B.write_shift(2,~W&65535);W-- >0;)B[B.l++]=G[U++]}return B.l}function j(G,B){for(var U=0,W=0,q=ae?new Uint16Array(32768):[];W<G.length;){var oe=Math.min(65535,G.length-W);if(oe<10){for(U=mr(B,U,+(W+oe==G.length)),U&7&&(U+=8-(U&7)),B.l=U/8|0,B.write_shift(2,oe),B.write_shift(2,~oe&65535);oe-- >0;)B[B.l++]=G[W++];U=B.l*8;continue}U=mr(B,U,+(W+oe==G.length)+2);for(var ue=0;oe-- >0;){var J=G[W];ue=(ue<<5^J)&32767;var le=-1,_e=0;if((le=q[ue])&&(le|=W&-32768,le>W&&(le-=32768),le<W))for(;G[le+_e]==G[W+_e]&&_e<250;)++_e;if(_e>2){J=k[_e],J<=22?U=hs(B,U,ie[J+1]>>1)-1:(hs(B,U,3),U+=5,hs(B,U,ie[J-23]>>5),U+=3);var Je=J<8?0:J-4>>2;Je>0&&(xp(B,U,_e-b[J]),U+=Je),J=C[W-le],U=hs(B,U,ie[J]>>3),U-=3;var Ze=J<4?0:J-2>>1;Ze>0&&(xp(B,U,W-le-Y[J]),U+=Ze);for(var jt=0;jt<_e;++jt)q[ue]=W&32767,ue=(ue<<5^G[W])&32767,++W;oe-=_e-1}else J<=143?J=J+48:U=Ti(B,U,1),U=hs(B,U,ie[J]),q[ue]=W&32767,++W}U=hs(B,U,0)-1}return B.l=(U+7)/8|0,B.l}return function(B,U){return B.length<8?A(B,U):j(B,U)}}();function vp(v){var C=V(50+Math.floor(v.length*1.1)),E=Jw(v,C);return C.slice(0,E)}var _p=ae?new Uint16Array(32768):nr(32768),yp=ae?new Uint16Array(32768):nr(32768),wp=ae?new Uint16Array(128):nr(128),Ep=1,Tp=1;function Zw(v,C){var E=it(v,C)+257;C+=5;var S=it(v,C)+1;C+=5;var k=pr(v,C)+4;C+=4;for(var A=0,j=ae?new Uint8Array(19):nr(19),G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,U=ae?new Uint8Array(8):nr(8),W=ae?new Uint8Array(8):nr(8),q=j.length,oe=0;oe<k;++oe)j[R[oe]]=A=Ne(v,C),B<A&&(B=A),U[A]++,C+=3;var ue=0;for(U[0]=0,oe=1;oe<=B;++oe)W[oe]=ue=ue+U[oe-1]<<1;for(oe=0;oe<q;++oe)(ue=j[oe])!=0&&(G[oe]=W[ue]++);var J=0;for(oe=0;oe<q;++oe)if(J=j[oe],J!=0){ue=ie[G[oe]]>>8-J;for(var le=(1<<7-J)-1;le>=0;--le)wp[ue|le<<J]=J&7|oe<<3}var _e=[];for(B=1;_e.length<E+S;)switch(ue=wp[he(v,C)],C+=ue&7,ue>>>=3){case 16:for(A=3+je(v,C),C+=2,ue=_e[_e.length-1];A-- >0;)_e.push(ue);break;case 17:for(A=3+Ne(v,C),C+=3;A-- >0;)_e.push(0);break;case 18:for(A=11+he(v,C),C+=7;A-- >0;)_e.push(0);break;default:_e.push(ue),B<ue&&(B=ue);break}var Je=_e.slice(0,E),Ze=_e.slice(E);for(oe=E;oe<286;++oe)Je[oe]=0;for(oe=S;oe<30;++oe)Ze[oe]=0;return Ep=ol(Je,_p,286),Tp=ol(Ze,yp,30),C}function eE(v,C){if(v[0]==3&&!(v[1]&3))return[ts(C),2];for(var E=0,S=0,k=Hm(C||1<<18),A=0,j=k.length>>>0,G=0,B=0;!(S&1);){if(S=Ne(v,E),E+=3,S>>>1)S>>1==1?(G=9,B=5):(E=Zw(v,E),G=Ep,B=Tp);else{E&7&&(E+=8-(E&7));var U=v[E>>>3]|v[(E>>>3)+1]<<8;if(E+=32,U>0)for(!C&&j<A+U&&(k=Lu(k,A+U),j=k.length);U-- >0;)k[A++]=v[E>>>3],E+=8;continue}for(;;){!C&&j<A+32767&&(k=Lu(k,A+32767),j=k.length);var W=In(v,E,G),q=S>>>1==1?bu[W]:_p[W];if(E+=q&15,q>>>=4,!(q>>>8&255))k[A++]=q;else{if(q==256)break;q-=257;var oe=q<8?0:q-4>>2;oe>5&&(oe=0);var ue=A+b[q];oe>0&&(ue+=In(v,E,oe),E+=oe),W=In(v,E,B),q=S>>>1==1?Mu[W]:yp[W],E+=q&15,q>>>=4;var J=q<4?0:q-2>>1,le=Y[q];for(J>0&&(le+=In(v,E,J),E+=J),!C&&j<ue&&(k=Lu(k,ue+100),j=k.length);A<ue;)k[A]=k[A-le],++A}}}return C?[k,E+7>>>3]:[k.slice(0,A),E+7>>>3]}function Sp(v,C){var E=v.slice(v.l||0),S=eE(E,C);return v.l+=S[1],S[0]}function Cp(v,C){if(v)typeof console<"u"&&console.error(C);else throw new Error(C)}function kp(v,C){var E=v;vn(E,0);var S=[],k=[],A={FileIndex:S,FullPaths:k};N(A,{root:C.root});for(var j=E.length-4;(E[j]!=80||E[j+1]!=75||E[j+2]!=5||E[j+3]!=6)&&j>=0;)--j;E.l=j+4,E.l+=4;var G=E.read_shift(2);E.l+=6;var B=E.read_shift(4);for(E.l=B,j=0;j<G;++j){E.l+=20;var U=E.read_shift(4),W=E.read_shift(4),q=E.read_shift(2),oe=E.read_shift(2),ue=E.read_shift(2);E.l+=8;var J=E.read_shift(4),le=a(E.slice(E.l+q,E.l+q+oe));E.l+=q+oe+ue;var _e=E.l;E.l=J+4,tE(E,U,W,A,le),E.l=_e}return A}function tE(v,C,E,S,k){v.l+=2;var A=v.read_shift(2),j=v.read_shift(2),G=o(v);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var B=v.read_shift(4),U=v.read_shift(4),W=v.read_shift(4),q=v.read_shift(2),oe=v.read_shift(2),ue="",J=0;J<q;++J)ue+=String.fromCharCode(v[v.l++]);if(oe){var le=a(v.slice(v.l,v.l+oe));(le[21589]||{}).mt&&(G=le[21589].mt),((k||{})[21589]||{}).mt&&(G=k[21589].mt)}v.l+=oe;var _e=v.slice(v.l,v.l+U);switch(j){case 8:_e=M(v,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+j)}var Je=!1;A&8&&(B=v.read_shift(4),B==134695760&&(B=v.read_shift(4),Je=!0),U=v.read_shift(4),W=v.read_shift(4)),U!=C&&Cp(Je,"Bad compressed size: "+C+" != "+U),W!=E&&Cp(Je,"Bad uncompressed size: "+E+" != "+W),Bu(S,ue,_e,{unsafe:!0,mt:G})}function nE(v,C){var E=C||{},S=[],k=[],A=V(1),j=E.compression?8:0,G=0,B=0,U=0,W=0,q=0,oe=v.FullPaths[0],ue=oe,J=v.FileIndex[0],le=[],_e=0;for(B=1;B<v.FullPaths.length;++B)if(ue=v.FullPaths[B].slice(oe.length),J=v.FileIndex[B],!(!J.size||!J.content||ue=="Sh33tJ5")){var Je=W,Ze=V(ue.length);for(U=0;U<ue.length;++U)Ze.write_shift(1,ue.charCodeAt(U)&127);Ze=Ze.slice(0,Ze.l),le[q]=XN.buf(J.content,0);var jt=J.content;j==8&&(jt=T(jt)),A=V(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,G),A.write_shift(2,j),J.mt?s(A,J.mt):A.write_shift(4,0),A.write_shift(-4,le[q]),A.write_shift(4,jt.length),A.write_shift(4,J.content.length),A.write_shift(2,Ze.length),A.write_shift(2,0),W+=A.length,S.push(A),W+=Ze.length,S.push(Ze),W+=jt.length,S.push(jt),A=V(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,G),A.write_shift(2,j),A.write_shift(4,0),A.write_shift(-4,le[q]),A.write_shift(4,jt.length),A.write_shift(4,J.content.length),A.write_shift(2,Ze.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,Je),_e+=A.l,k.push(A),_e+=Ze.length,k.push(Ze),++q}return A=V(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,q),A.write_shift(2,q),A.write_shift(4,_e),A.write_shift(4,W),A.write_shift(2,0),Dt([Dt(S),Dt(k),A])}var al={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function rE(v,C){if(v.ctype)return v.ctype;var E=v.name||"",S=E.match(/\.([^\.]+)$/);return S&&al[S[1]]||C&&(S=(E=C).match(/[\.\\]([^\.\\])+$/),S&&al[S[1]])?al[S[1]]:"application/octet-stream"}function iE(v){for(var C=Ma(v),E=[],S=0;S<C.length;S+=76)E.push(C.slice(S,S+76));return E.join(`\r
`)+`\r
`}function sE(v){var C=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(U){var W=U.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],S=C.split(`\r
`),k=0;k<S.length;++k){var A=S[k];if(A.length==0){E.push("");continue}for(var j=0;j<A.length;){var G=76,B=A.slice(j,j+G);B.charAt(G-1)=="="?G--:B.charAt(G-2)=="="?G-=2:B.charAt(G-3)=="="&&(G-=3),B=A.slice(j,j+G),j+=G,j<A.length&&(B+="="),E.push(B)}}return E.join(`\r
`)}function oE(v){for(var C=[],E=0;E<v.length;++E){for(var S=v[E];E<=v.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+v[++E];C.push(S)}for(var k=0;k<C.length;++k)C[k]=C[k].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Kn(C.join(`\r
`))}function aE(v,C,E){for(var S="",k="",A="",j,G=0;G<10;++G){var B=C[G];if(!B||B.match(/^\s*$/))break;var U=B.match(/^(.*?):\s*([^\s].*)$/);if(U)switch(U[1].toLowerCase()){case"content-location":S=U[2].trim();break;case"content-type":A=U[2].trim();break;case"content-transfer-encoding":k=U[2].trim();break}}switch(++G,k.toLowerCase()){case"base64":j=Kn(Mr(C.slice(G).join("")));break;case"quoted-printable":j=oE(C.slice(G));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var W=Bu(v,S.slice(E.length),j,{unsafe:!0});A&&(W.ctype=A)}function lE(v,C){if(de(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=C&&C.root||"",S=(Oe&&Buffer.isBuffer(v)?v.toString("binary"):de(v)).split(`\r
`),k=0,A="";for(k=0;k<S.length;++k)if(A=S[k],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),E||(E=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),A.slice(0,E.length)!=E););var j=(S[1]||"").match(/boundary="(.*?)"/);if(!j)throw new Error("MAD cannot find boundary");var G="--"+(j[1]||""),B=[],U=[],W={FileIndex:B,FullPaths:U};N(W);var q,oe=0;for(k=0;k<S.length;++k){var ue=S[k];ue!==G&&ue!==G+"--"||(oe++&&aE(W,S.slice(q,k),E),q=k)}return W}function cE(v,C){var E=C||{},S=E.boundary||"SheetJS";S="------="+S;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],A=v.FullPaths[0],j=A,G=v.FileIndex[0],B=1;B<v.FullPaths.length;++B)if(j=v.FullPaths[B].slice(A.length),G=v.FileIndex[B],!(!G.size||!G.content||j=="Sh33tJ5")){j=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var U=G.content,W=Oe&&Buffer.isBuffer(U)?U.toString("binary"):de(U),q=0,oe=Math.min(1024,W.length),ue=0,J=0;J<=oe;++J)(ue=W.charCodeAt(J))>=32&&ue<128&&++q;var le=q>=oe*4/5;k.push(S),k.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+j),k.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),k.push("Content-Type: "+rE(G,j)),k.push(""),k.push(le?sE(W):iE(W))}return k.push(S+`--\r
`),k.join(`\r
`)}function uE(v){var C={};return N(C,v),C}function Bu(v,C,E,S){var k=S&&S.unsafe;k||N(v);var A=!k&&Ue.find(v,C);if(!A){var j=v.FullPaths[0];C.slice(0,j.length)==j?j=C:(j.slice(-1)!="/"&&(j+="/"),j=(j+C).replace("//","/")),A={name:i(C),type:2},v.FileIndex.push(A),v.FullPaths.push(j),k||Ue.utils.cfb_gc(v)}return A.content=E,A.size=E?E.length:0,S&&(S.CLSID&&(A.clsid=S.CLSID),S.mt&&(A.mt=S.mt),S.ct&&(A.ct=S.ct)),A}function fE(v,C){N(v);var E=Ue.find(v,C);if(E){for(var S=0;S<v.FileIndex.length;++S)if(v.FileIndex[S]==E)return v.FileIndex.splice(S,1),v.FullPaths.splice(S,1),!0}return!1}function hE(v,C,E){N(v);var S=Ue.find(v,C);if(S){for(var k=0;k<v.FileIndex.length;++k)if(v.FileIndex[k]==S)return v.FileIndex[k].name=i(E),v.FullPaths[k]=E,!0}return!1}function dE(v){L(v,!0)}return t.find=H,t.read=z,t.parse=u,t.write=me,t.writeFile=se,t.utils={cfb_new:uE,cfb_add:Bu,cfb_del:fE,cfb_mov:hE,cfb_gc:dE,ReadShift:sa,CheckField:H2,prep_blob:vn,bconcat:Dt,use_zlib:F,_deflateRaw:vp,_inflateRaw:Sp,consts:We},t}();function YN(e){return typeof e=="string"?Au(e):Array.isArray(e)?wN(e):e}function el(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Au(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?Tr(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([YN(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Za(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Bt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Qm(e,t){for(var n=[],r=Bt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function qd(e){for(var t=[],n=Bt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Nu(e){for(var t=[],n=Bt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function qN(e){for(var t=[],n=Bt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var zc=new Date(1899,11,30,0,0,0);function dn(e,t){var n=e.getTime();t&&(n-=1462*24*60*60*1e3);var r=zc.getTime()+(e.getTimezoneOffset()-zc.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var k2=new Date,QN=zc.getTime()+(k2.getTimezoneOffset()-zc.getTimezoneOffset())*6e4,Jm=k2.getTimezoneOffset();function A2(e){var t=new Date;return t.setTime(e*24*60*60*1e3+QN),t.getTimezoneOffset()!==Jm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Jm)*6e4),t}var Zm=new Date("2017-02-19T19:06:09.000Z"),I2=isNaN(Zm.getFullYear())?new Date("2/19/17"):Zm,JN=I2.getFullYear()==2017;function Zt(e,t){var n=new Date(e);if(JN)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(I2.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Fu(e,t){if(Oe&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Tr(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Tr(yN(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Tr(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Tr(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function pn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=pn(e[n]));return t}function ot(e,t){for(var n="";n.length<t;)n+=e;return n}function Ar(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var ZN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ba(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&ZN.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function ye(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return Oe?r=zr(n):r=EN(n),Ue.utils.cfb_add(e,t,r)}Ue.utils.cfb_add(e,t,n)}else e.file(t,n)}function Qd(){return Ue.utils.cfb_new()}var mt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,eF={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Jd=qd(eF),Zd=/[&<>'"]/g,tF=/[\u0000-\u0008\u000b-\u001f]/g;function be(e){var t=e+"";return t.replace(Zd,function(n){return Jd[n]}).replace(tF,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function eg(e){return be(e).replace(/ /g,"_x0020_")}var R2=/[\u0000-\u001f]/g;function nF(e){var t=e+"";return t.replace(Zd,function(n){return Jd[n]}).replace(/\n/g,"<br/>").replace(R2,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function rF(e){var t=e+"";return t.replace(Zd,function(n){return Jd[n]}).replace(R2,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function iF(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function sF(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Nf(e){for(var t="",n=0,r=0,i=0,s=0,o=0,a=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function tg(e){var t=ts(2*e.length),n,r,i=1,s=0,o=0,a;for(r=0;r<e.length;r+=i)i=1,(a=e.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(e.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function ng(e){return zr(e,"binary").toString("utf8")}var Ol="foo bar baz",ia=Oe&&(ng(Ol)==Nf(Ol)&&ng||tg(Ol)==Nf(Ol)&&tg)||Nf,Tr=Oe?function(e){return zr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},oF=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),N2=/(^\s|\s$|\n)/;function Pt(e,t){return"<"+e+(t.match(N2)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ja(e){return Bt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Z(e,t,n){return"<"+e+(n!=null?ja(n):"")+(t!=null?(t.match(N2)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Z0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function aF(e,t){switch(typeof e){case"string":var n=Z("vt:lpwstr",be(e));return t&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return Z((e|0)==e?"vt:i4":"vt:r8",be(String(e)));case"boolean":return Z("vt:bool",e?"true":"false")}if(e instanceof Date)return Z("vt:filetime",Z0(e));throw new Error("Unable to serialize "+e)}var St={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},go=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lF(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function cF(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[n+a]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var rg=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},ig=Oe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:zr(t)})):rg(e)}:rg,sg=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Wo(e,i)));return r.join("").replace(ra,"")},ep=Oe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(ra,""):sg(e,t,n)}:sg,og=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},F2=Oe?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):og(e,t,n)}:og,ag=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(_s(e,i)));return r.join("")},tl=Oe?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):ag(t,n,r)}:ag,O2=function(e,t){var n=yn(e,t);return n>0?tl(e,t+4,t+4+n-1):""},D2=O2,P2=function(e,t){var n=yn(e,t);return n>0?tl(e,t+4,t+4+n-1):""},L2=P2,b2=function(e,t){var n=2*yn(e,t);return n>0?tl(e,t+4,t+4+n-1):""},M2=b2,B2=function(t,n){var r=yn(t,n);return r>0?ep(t,n+4,n+4+r):""},j2=B2,U2=function(e,t){var n=yn(e,t);return n>0?tl(e,t+4,t+4+n):""},W2=U2,z2=function(e,t){return lF(e,t)},Hc=z2,tp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Oe&&(D2=function(t,n){if(!Buffer.isBuffer(t))return O2(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},L2=function(t,n){if(!Buffer.isBuffer(t))return P2(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},M2=function(t,n){if(!Buffer.isBuffer(t))return b2(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},j2=function(t,n){if(!Buffer.isBuffer(t))return B2(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},W2=function(t,n){if(!Buffer.isBuffer(t))return U2(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Hc=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):z2(t,n)},tp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var _s=function(e,t){return e[t]},Wo=function(e,t){return e[t+1]*256+e[t]},uF=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},yn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},fF=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function sa(e,t){var n="",r,i,s=[],o,a,l,c;switch(t){case"dbcs":if(c=this.l,Oe&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)n+=String.fromCharCode(Wo(this,c)),c+=2;e*=2;break;case"utf8":n=tl(this,this.l,this.l+e);break;case"utf16le":e*=2,n=ep(this,this.l,this.l+e);break;case"wstr":return sa.call(this,e,"dbcs");case"lpstr-ansi":n=D2(this,this.l),e=4+yn(this,this.l);break;case"lpstr-cp":n=L2(this,this.l),e=4+yn(this,this.l);break;case"lpwstr":n=M2(this,this.l),e=4+2*yn(this,this.l);break;case"lpp4":e=4+yn(this,this.l),n=j2(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+yn(this,this.l),n=W2(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=_s(this,this.l+e++))!==0;)s.push(Rl(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=Wo(this,this.l+e))!==0;)s.push(Rl(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=_s(this,c),this.l=c+1,a=sa.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Rl(Wo(this,c))),c+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=_s(this,c),this.l=c+1,a=sa.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Rl(_s(this,c))),c+=1}n=s.join("");break;default:switch(e){case 1:return r=_s(this,this.l),this.l++,r;case 2:return r=(t==="i"?uF:Wo)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?Fi:fF)(this,this.l),this.l+=4,r):(i=yn(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Hc(this,this.l):i=Hc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=F2(this,this.l,e);break}}return this.l+=e,n}var hF=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},dF=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},pF=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function mF(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)pF(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,hF(this,t,this.l);break;case 8:if(r=8,n==="f"){cF(this,t,this.l);break}case 16:break;case-4:r=4,dF(this,t,this.l);break}return this.l+=r,this}function H2(e,t){var n=F2(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function vn(e,t){e.l=t,e.read_shift=sa,e.chk=H2,e.write_shift=mF}function dr(e,t){e.l+=t}function V(e){var t=ts(e);return vn(t,0),t}function fn(){var e=[],t=Oe?256:2048,n=function(c){var u=V(c);return vn(u,0),u},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(c){return r&&c<r.length-r.l?r:(i(),r=n(Math.max(c+1,t)))},o=function(){return i(),Dt(e)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:a,end:o,_bufs:e}}function X(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=l5[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&tp(n)&&e.push(n)}}function oa(e,t,n){var r=pn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function lg(e,t,n){var r=pn(e);return r.s=oa(r.s,t.s,n),r.e=oa(r.e,t.s,n),r}function aa(e,t){if(e.cRel&&e.c<0)for(e=pn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=pn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Be(e);return!e.cRel&&e.cRel!=null&&(n=vF(n)),!e.rRel&&e.rRel!=null&&(n=gF(n)),n}function Ff(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Vt(e.s.c)+":"+(e.e.cRel?"":"$")+Vt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+bt(e.s.r)+":"+(e.e.rRel?"":"$")+bt(e.e.r):aa(e.s,t.biff)+":"+aa(e.e,t.biff)}function np(e){return parseInt(xF(e),10)-1}function bt(e){return""+(e+1)}function gF(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xF(e){return e.replace(/\$(\d+)$/,"$1")}function rp(e){for(var t=_F(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Vt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function vF(e){return e.replace(/^([A-Z])/,"$$$1")}function _F(e){return e.replace(/^\$([A-Z])/,"$1")}function yF(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ct(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function Be(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Cn(e){var t=e.indexOf(":");return t==-1?{s:Ct(e),e:Ct(e)}:{s:Ct(e.slice(0,t)),e:Ct(e.slice(t+1))}}function pt(e,t){return typeof t>"u"||typeof t=="number"?pt(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function cg(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=mi(e.z,n?dn(t):t)}catch{}try{return e.w=mi((e.XF||{}).numFmtId||(n?14:0),n?dn(t):t)}catch{return""+t}}function Br(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?nl[e.v]||e.v:t==null?cg(e,e.v):cg(e,t))}function as(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function V2(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?Ct(r.origin):r.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=qe(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if(!(typeof t[h][f]>"u")){var p={v:t[h][f]},g=o+h,m=a+f;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),t[h][f]&&typeof t[h][f]=="object"&&!Array.isArray(t[h][f])&&!(t[h][f]instanceof Date))p=t[h][f];else if(Array.isArray(p.v)&&(p.f=t[h][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(r.nullError)p.t="e",p.v=0;else if(r.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=r.dateNF||lt[14],r.cellDates?(p.t="d",p.w=mi(p.z,dn(p.v))):(p.t="n",p.v=dn(p.v),p.w=mi(p.z,p.v))):p.t="s";if(i)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(p.z=s[g][m].z),s[g][m]=p;else{var w=Be({c:m,r:g});s[w]&&s[w].z&&(p.z=s[w].z),s[w]=p}}}return c.s.c<1e7&&(s["!ref"]=pt(c)),s}function xo(e,t){return V2(null,e,t)}function wF(e){return e.read_shift(4,"i")}function er(e,t){return t||(t=V(4)),t.write_shift(4,e),t}function $t(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function kt(e,t){var n=!1;return t==null&&(n=!0,t=V(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function EF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function TF(e,t){return t||(t=V(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function ip(e,t){var n=e.l,r=e.read_shift(1),i=$t(e),s=[],o={t:i,h:i};if(r&1){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(EF(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function SF(e,t){var n=!1;return t==null&&(n=!0,t=V(15+4*e.t.length)),t.write_shift(1,0),kt(e.t,t),n?t.slice(0,t.l):t}var CF=ip;function kF(e,t){var n=!1;return t==null&&(n=!0,t=V(23+4*e.t.length)),t.write_shift(1,1),kt(e.t,t),t.write_shift(4,1),TF({ich:0,ifnt:0},t),n?t.slice(0,t.l):t}function jn(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ls(e,t){return t==null&&(t=V(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function cs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function us(e,t){return t==null&&(t=V(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var AF=$t,$2=kt;function sp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Vc(e,t){var n=!1;return t==null&&(n=!0,t=V(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var IF=$t,eh=sp,op=Vc;function G2(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?Hc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fi(t,0)>>2;return n?i/100:i}function K2(e,t){t==null&&(t=V(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?r=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function X2(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function RF(e,t){return t||(t=V(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var fs=X2,vo=RF;function _o(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ns(e,t){return(t||V(8)).write_shift(8,e,"f")}function NF(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var c=jF[i];c&&(t.rgb=yg(c));break;case 2:t.rgb=yg([o,a,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function $c(e,t){if(t||(t=V(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function FF(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function OF(e,t){t||(t=V(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var Y2=2,mn=3,Dl=11,Gc=19,Pl=64,DF=65,PF=71,LF=4108,bF=4126,Nt=80,ug={1:{n:"CodePage",t:Y2},2:{n:"Category",t:Nt},3:{n:"PresentationFormat",t:Nt},4:{n:"ByteCount",t:mn},5:{n:"LineCount",t:mn},6:{n:"ParagraphCount",t:mn},7:{n:"SlideCount",t:mn},8:{n:"NoteCount",t:mn},9:{n:"HiddenCount",t:mn},10:{n:"MultimediaClipCount",t:mn},11:{n:"ScaleCrop",t:Dl},12:{n:"HeadingPairs",t:LF},13:{n:"TitlesOfParts",t:bF},14:{n:"Manager",t:Nt},15:{n:"Company",t:Nt},16:{n:"LinksUpToDate",t:Dl},17:{n:"CharacterCount",t:mn},19:{n:"SharedDoc",t:Dl},22:{n:"HyperlinksChanged",t:Dl},23:{n:"AppVersion",t:mn,p:"version"},24:{n:"DigSig",t:DF},26:{n:"ContentType",t:Nt},27:{n:"ContentStatus",t:Nt},28:{n:"Language",t:Nt},29:{n:"Version",t:Nt},255:{},2147483648:{n:"Locale",t:Gc},2147483651:{n:"Behavior",t:Gc},1919054434:{}},fg={1:{n:"CodePage",t:Y2},2:{n:"Title",t:Nt},3:{n:"Subject",t:Nt},4:{n:"Author",t:Nt},5:{n:"Keywords",t:Nt},6:{n:"Comments",t:Nt},7:{n:"Template",t:Nt},8:{n:"LastAuthor",t:Nt},9:{n:"RevNumber",t:Nt},10:{n:"EditTime",t:Pl},11:{n:"LastPrinted",t:Pl},12:{n:"CreatedDate",t:Pl},13:{n:"ModifiedDate",t:Pl},14:{n:"PageCount",t:mn},15:{n:"WordCount",t:mn},16:{n:"CharCount",t:mn},17:{n:"Thumbnail",t:PF},18:{n:"Application",t:Nt},19:{n:"DocSecurity",t:mn},255:{},2147483648:{n:"Locale",t:Gc},2147483651:{n:"Behavior",t:Gc},1919054434:{}};function MF(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var BF=MF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),jF=pn(BF),nl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},UF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ll={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function q2(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Q2(e,t){var n=qN(UF),r=[],i;r[r.length]=mt,r[r.length]=Z("Types",null,{xmlns:St.CT,"xmlns:xsd":St.xsd,"xmlns:xsi":St.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Z("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],r[r.length]=Z("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ll[l][t.bookType]||Ll[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(c){r[r.length]=Z("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Ll[l][t.bookType]||Ll[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(c){r[r.length]=Z("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:n[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Fe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function J2(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gs(e){var t=[mt,Z("Relationships",null,{xmlns:St.RELS})];return Bt(e["!id"]).forEach(function(n){t[t.length]=Z("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Le(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,s?i.TargetMode=s:[Fe.HLINK,Fe.XPATH,Fe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function WF(e){var t=[mt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function hg(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function zF(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function HF(e){var t=[mt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(hg(e[n][0],e[n][1])),t.push(zF("",e[n][0]));return t.push(hg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Z2(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Bc.version+"</meta:generator></office:meta></office:document-meta>"}var zi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Of(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=be(t),r[r.length]=n?Z(e,t,n):Pt(e,t))}function ew(e,t){var n=t||{},r=[mt,Z("cp:coreProperties",null,{"xmlns:cp":St.CORE_PROPS,"xmlns:dc":St.dc,"xmlns:dcterms":St.dcterms,"xmlns:dcmitype":St.dcmitype,"xmlns:xsi":St.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&Of("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Z0(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&Of("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Z0(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=zi.length;++s){var o=zi[s],a=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Of(o[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ks=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],tw=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function nw(e){var t=[],n=Z;return e||(e={}),e.Application="SheetJS",t[t.length]=mt,t[t.length]=Z("Properties",null,{xmlns:St.EXT_PROPS,"xmlns:vt":St.vt}),Ks.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=be(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+be(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function rw(e){var t=[mt,Z("Properties",null,{xmlns:St.CUST_PROPS,"xmlns:vt":St.vt})];if(!e)return t.join("");var n=1;return Bt(e).forEach(function(i){++n,t[t.length]=Z("property",aF(e[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:be(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function VF(e,t){var n=[];return Bt(dg).map(function(r){for(var i=0;i<zi.length;++i)if(zi[i][1]==r)return zi[i];for(i=0;i<Ks.length;++i)if(Ks[i][1]==r)return Ks[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Pt(dg[r[1]]||r[1],i))}}),Z("DocumentProperties",n.join(""),{xmlns:_n.o})}function $F(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Bt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<zi.length;++o)if(s==zi[o][1])return;for(o=0;o<Ks.length;++o)if(s==Ks[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var a=e[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Z(eg(s),a,{"dt:dt":l}))}}),t&&Bt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Z(eg(s),o,{"dt:dt":a}))}}),"<"+r+' xmlns="'+_n.o+'">'+i.join("")+"</"+r+">"}function GF(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=V(8);return o.write_shift(4,r),o.write_shift(4,i),o}function pg(e,t){var n=V(4),r=V(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=V(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=GF(t);break;case 31:case 80:for(r=V(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Dt([n,r])}var iw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function KF(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function mg(e,t,n){var r=V(8),i=[],s=[],o=8,a=0,l=V(8),c=V(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!t){c=V(8),c.write_shift(4,0),i.unshift(c);var u=[V(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var h=e[a][0];for(l=V(4+4+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Dt(u),s.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(iw.indexOf(e[a][0])>-1||tw.indexOf(e[a][0])>-1)&&e[a][1]!=null){var f=e[a][1],p=0;if(t){p=+t[e[a][0]];var g=n[p];if(g.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=pg(g.t,f)}else{var w=KF(f);w==-1&&(w=31,f=String(f)),l=pg(w,f)}s.push(l),c=V(8),c.write_shift(4,t?p:2+a),i.push(c),o+=8+l.length}var _=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,_),_+=s[a].length;return r.write_shift(4,o),r.write_shift(4,s.length),Dt([r].concat(i).concat(s))}function gg(e,t,n,r,i,s){var o=V(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ue.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=mg(e,n,r);if(a.push(l),i){var c=mg(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Dt(a)}function XF(e,t){t||(t=V(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function YF(e,t){return e.read_shift(t)===1}function qt(e,t){return t||(t=V(2)),t.write_shift(2,+!!e),t}function sw(e){return e.read_shift(2,"u")}function Nn(e,t){return t||(t=V(2)),t.write_shift(2,e),t}function ow(e,t,n){return n||(n=V(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function aw(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?e.read_shift(r,i):"";return o}function qF(e){var t=e.t||"",n=V(3+0);n.write_shift(2,t.length),n.write_shift(1,1);var r=V(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return Dt(i)}function QF(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function JF(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):QF(e,r,n)}function ZF(e,t,n){if(n.biff>5)return JF(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function lw(e,t,n){return n||(n=V(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function xg(e,t){t||(t=V(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function e6(e){var t=V(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(s==28)r=r.slice(1),xg(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var a=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)t.write_shift(2,a.charCodeAt(n));t.write_shift(2,0),s&8&&xg(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,r.charCodeAt(n+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function rs(e,t,n,r){return r||(r=V(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function t6(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function n6(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function cw(e,t){return t||(t=V(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ap(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=V(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function r6(e,t){var n=!t||t.biff==8,r=V(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function i6(e,t){var n=!t||t.biff>=8?2:1,r=V(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function s6(e,t){var n=V(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=qF(e[i]);var s=Dt([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function o6(){var e=V(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function a6(e){var t=V(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function l6(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=V(i);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function c6(e,t,n,r){var i=V(10);return rs(e,t,r,i),i.write_shift(4,n),i}function u6(e,t,n,r,i){var s=!i||i.biff==8,o=V(6+2+ +s+(1+s)*n.length);return rs(e,t,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function f6(e,t,n,r){var i=n&&n.biff==5;r||(r=V(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}function h6(e,t){var n=t.biff==8||!t.biff?4:2,r=V(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function vg(e,t,n,r){var i=n&&n.biff==5;r||(r=V(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function d6(e){var t=V(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function p6(e,t,n,r,i,s){var o=V(8);return rs(e,t,r,o),ow(n,s,o),o}function m6(e,t,n,r){var i=V(14);return rs(e,t,r,i),ns(n,i),i}function g6(e,t,n){if(n.biff<8)return x6(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(t6(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function x6(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=aw(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function v6(e){var t=V(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)cw(e[n],t);return t}function _6(e){var t=V(24),n=Ct(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return Dt([t,e6(e[1])])}function y6(e){var t=e[1].Tooltip,n=V(10+2*(t.length+1));n.write_shift(2,2048);var r=Ct(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function w6(e){return e||(e=V(4)),e.write_shift(2,1),e.write_shift(2,1),e}function E6(e,t,n){if(!n.cellStyles)return dr(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(2);r==2&&(e.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}function T6(e,t){var n=V(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function S6(e){for(var t=V(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function C6(e,t,n){var r=V(15);return il(r,e,t),r.write_shift(8,n,"f"),r}function k6(e,t,n){var r=V(9);return il(r,e,t),r.write_shift(2,n),r}var A6=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=qd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var c=[],u=ts(1);switch(l.type){case"base64":u=Kn(Mr(a));break;case"binary":u=Kn(a);break;case"buffer":case"array":u=a;break}vn(u,0);var h=u.read_shift(1),f=!!(h&136),p=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,w=521;h==2&&(m=u.read_shift(2)),u.l+=3,h!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(w=u.read_shift(2));var _=u.read_shift(2),x=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(x=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],I={},O=Math.min(u.length,h==2?521:w-10-(p?264:0)),z=g?32:11;u.l<O&&u[u.l]!=13;)switch(I={},I.name=Ni.utils.decode(x,u.slice(u.l,u.l+z)).replace(/[\u0000\r\n].*$/g,""),u.l+=z,I.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(I.offset=u.read_shift(4)),I.len=u.read_shift(1),h==2&&(I.offset=u.read_shift(2)),I.dec=u.read_shift(1),I.name.length&&y.push(I),h!=2&&(u.l+=g?13:14),I.type){case"B":(!p||I.len!=8)&&l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var N=0,D=0;for(c[0]=[],D=0;D!=y.length;++D)c[0][D]=y[D].name;for(;m-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,c[++N]=[],D=0,D=0;D!=y.length;++D){var L=u.slice(u.l,u.l+y[D].len);u.l+=y[D].len,vn(L,0);var P=Ni.utils.decode(x,L);switch(y[D].type){case"C":P.trim().length&&(c[N][D]=P.replace(/\s+$/,""));break;case"D":P.length===8?c[N][D]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):c[N][D]=P;break;case"F":c[N][D]=parseFloat(P.trim());break;case"+":case"I":c[N][D]=g?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":c[N][D]=!0;break;case"N":case"F":c[N][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[N][D]="##MEMO##"+(g?parseInt(P.trim(),10):L.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(c[N][D]=+P||0);break;case"@":c[N][D]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":c[N][D]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":c[N][D]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[N][D]=-L.read_shift(-8,"f");break;case"B":if(p&&y[D].len==8){c[N][D]=L.read_shift(8,"f");break}case"G":case"P":L.l+=y[D].len;break;case"0":if(y[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[D].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=xo(n(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return as(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&ba(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=fn(),h=Qc(a,{header:1,raw:!0,cellDates:!0}),f=h[0],p=h.slice(1),g=a["!cols"]||[],m=0,w=0,_=0,x=1;for(m=0;m<f.length;++m){if(((g[m]||{}).DBF||{}).name){f[m]=g[m].DBF.name,++_;continue}if(f[m]!=null){if(++_,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(w=0;w<1024;++w)if(f.indexOf(f[m]+"_"+w)==-1){f[m]+="_"+w;break}}}}var y=qe(a["!ref"]),I=[],O=[],z=[];for(m=0;m<=y.e.c-y.s.c;++m){var N="",D="",L=0,P=[];for(w=0;w<p.length;++w)p[w][m]!=null&&P.push(p[w][m]);if(P.length==0||f[m]==null){I[m]="?";continue}for(w=0;w<P.length;++w){switch(typeof P[w]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=P[w]instanceof Date?"D":"C";break;default:D="C"}L=Math.max(L,String(P[w]).length),N=N&&N!=D?"C":D}L>250&&(L=250),D=((g[m]||{}).DBF||{}).type,D=="C"&&g[m].DBF.len>L&&(L=g[m].DBF.len),N=="B"&&D=="N"&&(N="N",z[m]=g[m].DBF.dec,L=g[m].DBF.len),O[m]=N=="C"||D=="N"?L:s[N]||0,x+=O[m],I[m]=N}var H=u.next(32);for(H.write_shift(4,318902576),H.write_shift(4,p.length),H.write_shift(2,296+32*_),H.write_shift(2,x),m=0;m<4;++m)H.write_shift(4,0);for(H.write_shift(4,0|(+t[f2]||3)<<8),m=0,w=0;m<f.length;++m)if(f[m]!=null){var K=u.next(32),te=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);K.write_shift(1,te,"sbcs"),K.write_shift(1,I[m]=="?"?"C":I[m],"sbcs"),K.write_shift(4,w),K.write_shift(1,O[m]||s[I[m]]||0),K.write_shift(1,z[m]||0),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(1,0),K.write_shift(4,0),K.write_shift(4,0),w+=O[m]||s[I[m]]||0}var we=u.next(264);for(we.write_shift(4,13),m=0;m<65;++m)we.write_shift(4,0);for(m=0;m<p.length;++m){var ve=u.next(x);for(ve.write_shift(1,0),w=0;w<f.length;++w)if(f[w]!=null)switch(I[w]){case"L":ve.write_shift(1,p[m][w]==null?63:p[m][w]?84:70);break;case"B":ve.write_shift(8,p[m][w]||0,"f");break;case"N":var He="0";for(typeof p[m][w]=="number"&&(He=p[m][w].toFixed(z[w]||0)),_=0;_<O[w]-He.length;++_)ve.write_shift(1,32);ve.write_shift(1,He,"sbcs");break;case"D":p[m][w]?(ve.write_shift(4,("0000"+p[m][w].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(p[m][w].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+p[m][w].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var We=String(p[m][w]!=null?p[m][w]:"").slice(0,O[w]);for(ve.write_shift(1,We,"sbcs"),_=0;_<O[w]-We.length;++_)ve.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),I6=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(f,p){var g=e[p];return typeof g=="number"?zm(g):g},r=function(f,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?f:zm(m)};e["|"]=254;function i(f,p){switch(p.type){case"base64":return s(Mr(f),p);case"binary":return s(f,p);case"buffer":return s(Oe&&Buffer.isBuffer(f)?f.toString("binary"):Za(f),p);case"array":return s(Fu(f),p)}throw new Error("Unrecognized type "+p.type)}function s(f,p){var g=f.split(/[\n\r]+/),m=-1,w=-1,_=0,x=0,y=[],I=[],O=null,z={},N=[],D=[],L=[],P=0,H;for(+p.codepage>=0&&ba(+p.codepage);_!==g.length;++_){P=0;var K=g[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),te=K.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),we=te[0],ve;if(K.length>0)switch(we){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&I.push(K.slice(3).replace(/;;/g,";"));break;case"C":var He=!1,We=!1,se=!1,de=!1,me=-1,Se=-1;for(x=1;x<te.length;++x)switch(te[x].charAt(0)){case"A":break;case"X":w=parseInt(te[x].slice(1))-1,We=!0;break;case"Y":for(m=parseInt(te[x].slice(1))-1,We||(w=0),H=y.length;H<=m;++H)y[H]=[];break;case"K":ve=te[x].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Ar(ve))?isNaN(Ba(ve).getDate())||(ve=Zt(ve)):(ve=Ar(ve),O!==null&&T2(O)&&(ve=A2(ve))),He=!0;break;case"E":de=!0;var F=kO(te[x].slice(1),{r:m,c:w});y[m][w]=[y[m][w],F];break;case"S":se=!0,y[m][w]=[y[m][w],"S5S"];break;case"G":break;case"R":me=parseInt(te[x].slice(1))-1;break;case"C":Se=parseInt(te[x].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+K)}if(He&&(y[m][w]&&y[m][w].length==2?y[m][w][0]=ve:y[m][w]=ve,O=null),se){if(de)throw new Error("SYLK shared formula cannot have own formula");var M=me>-1&&y[me][Se];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");y[m][w][1]=AO(M[1],{r:m-me,c:w-Se})}break;case"F":var T=0;for(x=1;x<te.length;++x)switch(te[x].charAt(0)){case"X":w=parseInt(te[x].slice(1))-1,++T;break;case"Y":for(m=parseInt(te[x].slice(1))-1,H=y.length;H<=m;++H)y[H]=[];break;case"M":P=parseInt(te[x].slice(1))/20;break;case"F":break;case"G":break;case"P":O=I[parseInt(te[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=te[x].slice(1).split(" "),H=parseInt(L[0],10);H<=parseInt(L[1],10);++H)P=parseInt(L[2],10),D[H-1]=P===0?{hidden:!0}:{wch:P},lp(D[H-1]);break;case"C":w=parseInt(te[x].slice(1))-1,D[w]||(D[w]={});break;case"R":m=parseInt(te[x].slice(1))-1,N[m]||(N[m]={}),P>0?(N[m].hpt=P,N[m].hpx=pw(P)):P===0&&(N[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+K)}T<1&&(O=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+K)}}return N.length>0&&(z["!rows"]=N),D.length>0&&(z["!cols"]=D),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,z]}function o(f,p){var g=i(f,p),m=g[0],w=g[1],_=xo(m,p);return Bt(w).forEach(function(x){_[x]=w[x]}),_}function a(f,p){return as(o(f,p),p)}function l(f,p,g,m){var w="C;Y"+(g+1)+";X"+(m+1)+";K";switch(f.t){case"n":w+=f.v||0,f.f&&!f.F&&(w+=";E"+up(f.f,{r:g,c:m}));break;case"b":w+=f.v?"TRUE":"FALSE";break;case"e":w+=f.w||f.v;break;case"d":w+='"'+(f.w||f.v)+'"';break;case"s":w+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(f,p){p.forEach(function(g,m){var w="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?w+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Kc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Xc(g.wpx)),typeof g.wch=="number"&&(w+=Math.round(g.wch))),w.charAt(w.length-1)!=" "&&f.push(w)})}function u(f,p){p.forEach(function(g,m){var w="F;";g.hidden?w+="M0;":g.hpt?w+="M"+20*g.hpt+";":g.hpx&&(w+="M"+20*Yc(g.hpx)+";"),w.length>2&&f.push(w+"R"+(m+1))})}function h(f,p){var g=["ID;PWXL;N;E"],m=[],w=qe(f["!ref"]),_,x=Array.isArray(f),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&c(g,f["!cols"]),f["!rows"]&&u(g,f["!rows"]),g.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var I=w.s.r;I<=w.e.r;++I)for(var O=w.s.c;O<=w.e.c;++O){var z=Be({r:I,c:O});_=x?(f[I]||[])[O]:f[z],!(!_||_.v==null&&(!_.f||_.F))&&m.push(l(_,f,I,O))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),R6=function(){function e(s,o){switch(o.type){case"base64":return t(Mr(s),o);case"binary":return t(s,o);case"buffer":return t(Oe&&Buffer.isBuffer(s)?s.toString("binary"):Za(s),o);case"array":return t(Fu(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var f=a[u].trim().split(","),p=f[0],g=f[1];++u;for(var m=a[u]||"";(m.match(/["]/g)||[]).length&1&&u<a.length-1;)m+=`
`+a[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][c]=!0:m==="FALSE"?h[l][c]=!1:isNaN(Ar(g))?isNaN(Ba(g).getDate())?h[l][c]=g:h[l][c]=Zt(g):h[l][c]=Ar(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function n(s,o){return xo(e(s,o),o)}function r(s,o){return as(n(s,o),o)}var i=function(){var s=function(l,c,u,h,f){l.push(c),l.push(u+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=qe(l["!ref"]),h,f=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){o(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=Be({r:p,c:g});if(h=f?(l[p]||[])[g]:l[m],!h){o(c,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,w,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=mi(h.z||lt[14],dn(Zt(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var _=`\r
`,x=c.join(_);return x}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),uw=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,f){for(var p=h.split(`
`),g=-1,m=-1,w=0,_=[];w!==p.length;++w){var x=p[w].trim().split(":");if(x[0]==="cell"){var y=Ct(x[1]);if(_.length<=y.r)for(g=_.length;g<=y.r;++g)_[g]||(_[g]=[]);switch(g=y.r,m=y.c,x[2]){case"t":_[g][m]=e(x[3]);break;case"v":_[g][m]=+x[3];break;case"vtf":var I=x[x.length-1];case"vtc":switch(x[3]){case"nl":_[g][m]=!!+x[4];break;default:_[g][m]=+x[4];break}x[2]=="vtf"&&(_[g][m]=[_[g][m],I])}}}return f&&f.sheetRows&&(_=_.slice(0,f.sheetRows)),_}function r(h,f){return xo(n(h,f),f)}function i(h,f){return as(r(h,f),f)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var f=[],p=[],g,m="",w=Cn(h["!ref"]),_=Array.isArray(h),x=w.s.r;x<=w.e.r;++x)for(var y=w.s.c;y<=w.e.c;++y)if(m=Be({r:x,c:y}),g=_?(h[x]||[])[y]:h[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var I=dn(Zt(g.v));p[2]="vtc",p[3]="nd",p[4]=""+I,p[5]=g.w||mi(g.z||lt[14],I);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}}(),N6=function(){function e(u,h,f,p,g){g.raw?h[f][p]=u:u===""||(u==="TRUE"?h[f][p]=!0:u==="FALSE"?h[f][p]=!1:isNaN(Ar(u))?isNaN(Ba(u).getDate())?h[f][p]=u:h[f][p]=Zt(u):h[f][p]=Ar(u))}function t(u,h){var f=h||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var w=10,_=0,x=0;x<=m;++x)_=g[x].indexOf(" "),_==-1?_=g[x].length:_++,w=Math.max(w,_);for(x=0;x<=m;++x){p[x]=[];var y=0;for(e(g[x].slice(0,w).trim(),p,x,y,f),y=1;y<=(g[x].length-w)/10+1;++y)e(g[x].slice(w+(y-1)*10,w+y*10).trim(),p,x,y,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var h={},f=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?f=!f:!f&&g in n&&(h[g]=(h[g]||0)+1);g=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p]);if(!g.length){h=r;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p])}return g.sort(function(m,w){return m[0]-w[0]||r[m[1]]-r[w[1]]}),n[g.pop()[1]]||44}function s(u,h){var f=h||{},p="",g=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):f&&f.FS?p=f.FS:p=i(u.slice(0,1024));var w=0,_=0,x=0,y=0,I=0,O=p.charCodeAt(0),z=!1,N=0,D=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var L=f.dateNF!=null?GN(f.dateNF):null;function P(){var H=u.slice(y,I),K={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)K.t="z";else if(f.raw)K.t="s",K.v=H;else if(H.trim().length===0)K.t="s",K.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(K.t="s",K.v=H.slice(2,-1).replace(/""/g,'"')):IO(H)?(K.t="n",K.f=H.slice(1)):(K.t="s",K.v=H);else if(H=="TRUE")K.t="b",K.v=!0;else if(H=="FALSE")K.t="b",K.v=!1;else if(!isNaN(x=Ar(H)))K.t="n",f.cellText!==!1&&(K.w=H),K.v=x;else if(!isNaN(Ba(H).getDate())||L&&H.match(L)){K.z=f.dateNF||lt[14];var te=0;L&&H.match(L)&&(H=KN(H,f.dateNF,H.match(L)||[]),te=1),f.cellDates?(K.t="d",K.v=Zt(H,te)):(K.t="n",K.v=dn(Zt(H,te))),f.cellText!==!1&&(K.w=mi(K.z,K.v instanceof Date?dn(K.v):K.v)),f.cellNF||delete K.z}else K.t="s",K.v=H;if(K.t=="z"||(f.dense?(g[w]||(g[w]=[]),g[w][_]=K):g[Be({c:_,r:w})]=K),y=I+1,D=u.charCodeAt(y),m.e.c<_&&(m.e.c=_),m.e.r<w&&(m.e.r=w),N==O)++_;else if(_=0,++w,f.sheetRows&&f.sheetRows<=w)return!0}e:for(;I<u.length;++I)switch(N=u.charCodeAt(I)){case 34:D===34&&(z=!z);break;case O:case 10:case 13:if(!z&&P())break e;break}return I-y>0&&P(),g["!ref"]=pt(m),g}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):xo(t(u,h),h)}function a(u,h){var f="",p=h.type=="string"?[0,0,0,0]:z5(u,h);switch(h.type){case"base64":f=Mr(u);break;case"binary":f=u;break;case"buffer":h.codepage==65001?f=u.toString("utf8"):h.codepage&&typeof Ni<"u"?f=Ni.utils.decode(h.codepage,u):f=Oe&&Buffer.isBuffer(u)?u.toString("binary"):Za(u);break;case"array":f=Fu(u);break;case"string":f=u;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=ia(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=ia(f):h.type=="binary"&&typeof Ni<"u"&&h.codepage&&(f=Ni.utils.decode(h.codepage,Ni.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?uw.to_sheet(h.type=="string"?f:ia(f),h):o(f,h)}function l(u,h){return as(a(u,h),h)}function c(u){for(var h=[],f=qe(u["!ref"]),p,g=Array.isArray(u),m=f.s.r;m<=f.e.r;++m){for(var w=[],_=f.s.c;_<=f.e.c;++_){var x=Be({r:m,c:_});if(p=g?(u[m]||[])[_]:u[x],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(Br(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(_===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}(),_g=function(){function e(F,M,T){if(F){vn(F,F.l||0);for(var R=T.Enum||me;F.l<F.length;){var b=F.read_shift(2),Y=R[b]||R[65535],ne=F.read_shift(2),ae=F.l+ne,ie=Y.f&&Y.f(F,ne,T);if(F.l=ae,M(ie,Y,b))return}}}function t(F,M){switch(M.type){case"base64":return n(Kn(Mr(F)),M);case"binary":return n(Kn(F),M);case"buffer":case"array":return n(F,M)}throw"Unsupported type "+M.type}function n(F,M){if(!F)return F;var T=M||{},R=T.dense?[]:{},b="Sheet1",Y="",ne=0,ae={},ie=[],ge=[],pe={s:{r:0,c:0},e:{r:0,c:0}},je=T.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)T.Enum=me,e(F,function(he,In,mr){switch(mr){case 0:T.vers=he,he>=4096&&(T.qpro=!0);break;case 6:pe=he;break;case 204:he&&(Y=he);break;case 222:Y=he;break;case 15:case 51:T.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:mr==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=T.dateNF||lt[14],T.cellDates&&(he[1].t="d",he[1].v=A2(he[1].v))),T.qpro&&he[3]>ne&&(R["!ref"]=pt(pe),ae[b]=R,ie.push(b),R=T.dense?[]:{},pe={s:{r:0,c:0},e:{r:0,c:0}},ne=he[3],b=Y||"Sheet"+(ne+1),Y="");var Ti=T.dense?(R[he[0].r]||[])[he[0].c]:R[Be(he[0])];if(Ti){Ti.t=he[1].t,Ti.v=he[1].v,he[1].z!=null&&(Ti.z=he[1].z),he[1].f!=null&&(Ti.f=he[1].f);break}T.dense?(R[he[0].r]||(R[he[0].r]=[]),R[he[0].r][he[0].c]=he[1]):R[Be(he[0])]=he[1];break}},T);else if(F[2]==26||F[2]==14)T.Enum=Se,F[2]==14&&(T.qpro=!0,F.l=0),e(F,function(he,In,mr){switch(mr){case 204:b=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>ne&&(R["!ref"]=pt(pe),ae[b]=R,ie.push(b),R=T.dense?[]:{},pe={s:{r:0,c:0},e:{r:0,c:0}},ne=he[3],b="Sheet"+(ne+1)),je>0&&he[0].r>=je)break;T.dense?(R[he[0].r]||(R[he[0].r]=[]),R[he[0].r][he[0].c]=he[1]):R[Be(he[0])]=he[1],pe.e.c<he[0].c&&(pe.e.c=he[0].c),pe.e.r<he[0].r&&(pe.e.r=he[0].r);break;case 27:he[14e3]&&(ge[he[14e3][0]]=he[14e3][1]);break;case 1537:ge[he[0]]=he[1],he[0]==ne&&(b=he[1]);break}},T);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(R["!ref"]=pt(pe),ae[Y||b]=R,ie.push(Y||b),!ge.length)return{SheetNames:ie,Sheets:ae};for(var Ne={},pr=[],it=0;it<ge.length;++it)ae[ie[it]]?(pr.push(ge[it]||ie[it]),Ne[ge[it]]=ae[ge[it]]||ae[ie[it]]):(pr.push(ge[it]),Ne[ge[it]]={"!ref":"A1"});return{SheetNames:pr,Sheets:Ne}}function r(F,M){var T=M||{};if(+T.codepage>=0&&ba(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var R=fn(),b=qe(F["!ref"]),Y=Array.isArray(F),ne=[];re(R,0,s(1030)),re(R,6,l(b));for(var ae=Math.min(b.e.r,8191),ie=b.s.r;ie<=ae;++ie)for(var ge=bt(ie),pe=b.s.c;pe<=b.e.c;++pe){ie===b.s.r&&(ne[pe]=Vt(pe));var je=ne[pe]+ge,Ne=Y?(F[ie]||[])[pe]:F[je];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?re(R,13,p(ie,pe,Ne.v)):re(R,14,m(ie,pe,Ne.v));else{var pr=Br(Ne);re(R,15,h(ie,pe,pr.slice(0,239)))}}return re(R,1),R.end()}function i(F,M){var T=M||{};if(+T.codepage>=0&&ba(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var R=fn();re(R,0,o(F));for(var b=0,Y=0;b<F.SheetNames.length;++b)(F.Sheets[F.SheetNames[b]]||{})["!ref"]&&re(R,27,de(F.SheetNames[b],Y++));var ne=0;for(b=0;b<F.SheetNames.length;++b){var ae=F.Sheets[F.SheetNames[b]];if(!(!ae||!ae["!ref"])){for(var ie=qe(ae["!ref"]),ge=Array.isArray(ae),pe=[],je=Math.min(ie.e.r,8191),Ne=ie.s.r;Ne<=je;++Ne)for(var pr=bt(Ne),it=ie.s.c;it<=ie.e.c;++it){Ne===ie.s.r&&(pe[it]=Vt(it));var he=pe[it]+pr,In=ge?(ae[Ne]||[])[it]:ae[he];if(!(!In||In.t=="z"))if(In.t=="n")re(R,23,P(Ne,it,ne,In.v));else{var mr=Br(In);re(R,22,N(Ne,it,ne,mr.slice(0,239)))}}++ne}}return re(R,1),R.end()}function s(F){var M=V(2);return M.write_shift(2,F),M}function o(F){var M=V(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var T=0,R=0,b=0,Y=0;Y<F.SheetNames.length;++Y){var ne=F.SheetNames[Y],ae=F.Sheets[ne];if(!(!ae||!ae["!ref"])){++b;var ie=Cn(ae["!ref"]);T<ie.e.r&&(T=ie.e.r),R<ie.e.c&&(R=ie.e.c)}}return T>8191&&(T=8191),M.write_shift(2,T),M.write_shift(1,b),M.write_shift(1,R),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function a(F,M,T){var R={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&T.qpro?(R.s.c=F.read_shift(1),F.l++,R.s.r=F.read_shift(2),R.e.c=F.read_shift(1),F.l++,R.e.r=F.read_shift(2),R):(R.s.c=F.read_shift(2),R.s.r=F.read_shift(2),M==12&&T.qpro&&(F.l+=2),R.e.c=F.read_shift(2),R.e.r=F.read_shift(2),M==12&&T.qpro&&(F.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function l(F){var M=V(8);return M.write_shift(2,F.s.c),M.write_shift(2,F.s.r),M.write_shift(2,F.e.c),M.write_shift(2,F.e.r),M}function c(F,M,T){var R=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(R[0].c=F.read_shift(1),R[3]=F.read_shift(1),R[0].r=F.read_shift(2),F.l+=2):(R[2]=F.read_shift(1),R[0].c=F.read_shift(2),R[0].r=F.read_shift(2)),R}function u(F,M,T){var R=F.l+M,b=c(F,M,T);if(b[1].t="s",T.vers==20768){F.l++;var Y=F.read_shift(1);return b[1].v=F.read_shift(Y,"utf8"),b}return T.qpro&&F.l++,b[1].v=F.read_shift(R-F.l,"cstr"),b}function h(F,M,T){var R=V(7+T.length);R.write_shift(1,255),R.write_shift(2,M),R.write_shift(2,F),R.write_shift(1,39);for(var b=0;b<R.length;++b){var Y=T.charCodeAt(b);R.write_shift(1,Y>=128?95:Y)}return R.write_shift(1,0),R}function f(F,M,T){var R=c(F,M,T);return R[1].v=F.read_shift(2,"i"),R}function p(F,M,T){var R=V(7);return R.write_shift(1,255),R.write_shift(2,M),R.write_shift(2,F),R.write_shift(2,T,"i"),R}function g(F,M,T){var R=c(F,M,T);return R[1].v=F.read_shift(8,"f"),R}function m(F,M,T){var R=V(13);return R.write_shift(1,255),R.write_shift(2,M),R.write_shift(2,F),R.write_shift(8,T,"f"),R}function w(F,M,T){var R=F.l+M,b=c(F,M,T);if(b[1].v=F.read_shift(8,"f"),T.qpro)F.l=R;else{var Y=F.read_shift(2);I(F.slice(F.l,F.l+Y),b),F.l+=Y}return b}function _(F,M,T){var R=M&32768;return M&=-32769,M=(R?F:0)+(M>=8192?M-16384:M),(R?"":"$")+(T?Vt(M):bt(M))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(F,M){vn(F,0);for(var T=[],R=0,b="",Y="",ne="",ae="";F.l<F.length;){var ie=F[F.l++];switch(ie){case 0:T.push(F.read_shift(8,"f"));break;case 1:Y=_(M[0].c,F.read_shift(2),!0),b=_(M[0].r,F.read_shift(2),!1),T.push(Y+b);break;case 2:{var ge=_(M[0].c,F.read_shift(2),!0),pe=_(M[0].r,F.read_shift(2),!1);Y=_(M[0].c,F.read_shift(2),!0),b=_(M[0].r,F.read_shift(2),!1),T.push(ge+pe+":"+Y+b)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(F.read_shift(2));break;case 6:{for(var je="";ie=F[F.l++];)je+=String.fromCharCode(ie);T.push('"'+je.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:ae=T.pop(),ne=T.pop(),T.push(["AND","OR"][ie-20]+"("+ne+","+ae+")");break;default:if(ie<32&&y[ie])ae=T.pop(),ne=T.pop(),T.push(ne+y[ie]+ae);else if(x[ie]){if(R=x[ie][1],R==69&&(R=F[F.l++]),R>T.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+T.join("|")+"|");return}var Ne=T.slice(-R);T.length-=R,T.push(x[ie][0]+"("+Ne.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}T.length==1?M[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function O(F){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=F.read_shift(2),M[3]=F[F.l++],M[0].c=F[F.l++],M}function z(F,M){var T=O(F);return T[1].t="s",T[1].v=F.read_shift(M-4,"cstr"),T}function N(F,M,T,R){var b=V(6+R.length);b.write_shift(2,F),b.write_shift(1,T),b.write_shift(1,M),b.write_shift(1,39);for(var Y=0;Y<R.length;++Y){var ne=R.charCodeAt(Y);b.write_shift(1,ne>=128?95:ne)}return b.write_shift(1,0),b}function D(F,M){var T=O(F);T[1].v=F.read_shift(2);var R=T[1].v>>1;if(T[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return T[1].v=R,T}function L(F,M){var T=O(F),R=F.read_shift(4),b=F.read_shift(4),Y=F.read_shift(2);if(Y==65535)return R===0&&b===3221225472?(T[1].t="e",T[1].v=15):R===0&&b===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var ne=Y&32768;return Y=(Y&32767)-16446,T[1].v=(1-ne*2)*(b*Math.pow(2,Y+32)+R*Math.pow(2,Y)),T}function P(F,M,T,R){var b=V(14);if(b.write_shift(2,F),b.write_shift(1,T),b.write_shift(1,M),R==0)return b.write_shift(4,0),b.write_shift(4,0),b.write_shift(2,65535),b;var Y=0,ne=0,ae=0,ie=0;return R<0&&(Y=1,R=-R),ne=Math.log2(R)|0,R/=Math.pow(2,ne-31),ie=R>>>0,ie&2147483648||(R/=2,++ne,ie=R>>>0),R-=ie,ie|=2147483648,ie>>>=0,R*=Math.pow(2,32),ae=R>>>0,b.write_shift(4,ae),b.write_shift(4,ie),ne+=16383+(Y?32768:0),b.write_shift(2,ne),b}function H(F,M){var T=L(F);return F.l+=M-14,T}function K(F,M){var T=O(F),R=F.read_shift(4);return T[1].v=R>>6,T}function te(F,M){var T=O(F),R=F.read_shift(8,"f");return T[1].v=R,T}function we(F,M){var T=te(F);return F.l+=M-10,T}function ve(F,M){return F[F.l+M-1]==0?F.read_shift(M,"cstr"):""}function He(F,M){var T=F[F.l++];T>M-1&&(T=M-1);for(var R="";R.length<T;)R+=String.fromCharCode(F[F.l++]);return R}function We(F,M,T){if(!(!T.qpro||M<21)){var R=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var b=F.read_shift(M-21,"cstr");return[R,b]}}function se(F,M){for(var T={},R=F.l+M;F.l<R;){var b=F.read_shift(2);if(b==14e3){for(T[b]=[0,""],T[b][0]=F.read_shift(2);F[F.l];)T[b][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return T}function de(F,M){var T=V(5+F.length);T.write_shift(2,14e3),T.write_shift(2,M);for(var R=0;R<F.length;++R){var b=F.charCodeAt(R);T[T.l++]=b>127?95:b}return T[T.l++]=0,T}var me={0:{n:"BOF",f:sw},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:He},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:we},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:We},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}(),F6=/^\s|\s$|[\t\n\r]/;function fw(e,t){if(!t.bookSST)return"";var n=[mt];n[n.length]=Z("sst",null,{xmlns:go[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(F6)&&(s+=' xml:space="preserve"'),s+=">"+be(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function O6(e){return[e.read_shift(4),e.read_shift(4)]}function D6(e,t){return t||(t=V(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var P6=SF;function L6(e){var t=fn();X(t,159,D6(e));for(var n=0;n<e.length;++n)X(t,19,P6(e[n]));return X(t,160),t.end()}function b6(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function hw(e){var t=0,n,r=b6(e),i=r.length+1,s,o,a,l,c;for(n=ts(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],a=t&16384?1:0,l=t<<1&32767,c=a|l,t=c^o;return t^52811}var M6=function(){function e(i,s){switch(s.type){case"base64":return t(Mr(i),s);case"binary":return t(i,s);case"buffer":return t(Oe&&Buffer.isBuffer(i)?i.toString("binary"):Za(i),s);case"array":return t(Fu(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var f=/\\\w+\b/g,p=0,g,m=-1;g=f.exec(u);){switch(g[0]){case"\\cell":var w=u.slice(p,f.lastIndex-g[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var _={v:w,t:"s"};Array.isArray(a)?a[h][m]=_:a[Be({r:h,c:m})]=_}break}p=f.lastIndex}m>c.e.c&&(c.e.c=m)}),a["!ref"]=pt(c),a}function n(i,s){return as(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=qe(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=Be({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(Br(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function yg(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var B6=6,Ir=B6;function Kc(e){return Math.floor((e+Math.round(128/Ir)/256)*Ir)}function Xc(e){return Math.floor((e-5)/Ir*100+.5)/100}function th(e){return Math.round((e*Ir+5)/Ir*256)/256}function lp(e){e.width?(e.wpx=Kc(e.width),e.wch=Xc(e.wpx),e.MDW=Ir):e.wpx?(e.wch=Xc(e.wpx),e.width=th(e.wch),e.MDW=Ir):typeof e.wch=="number"&&(e.width=th(e.wch),e.wpx=Kc(e.width),e.MDW=Ir),e.customWidth&&delete e.customWidth}var j6=96,dw=j6;function Yc(e){return e*96/dw}function pw(e){return e*dw/96}function U6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=Z("numFmt",null,{numFmtId:r,formatCode:be(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Z("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function W6(e){var t=[];return t[t.length]=Z("cellXfs",null),e.forEach(function(n){t[t.length]=Z("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Z("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function mw(e,t){var n=[mt,Z("styleSheet",null,{xmlns:go[0],"xmlns:vt":St.vt})],r;return e.SSF&&(r=U6(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=W6(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function z6(e,t){var n=e.read_shift(2),r=$t(e);return[n,r]}function H6(e,t,n){n||(n=V(6+4*t.length)),n.write_shift(2,e),kt(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function V6(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=FF(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var a=e.read_shift(1);a>0&&(r.family=a);var l=e.read_shift(1);switch(l>0&&(r.charset=l),e.l++,r.color=NF(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=$t(e),r}function $6(e,t){t||(t=V(25+4*32)),t.write_shift(2,e.sz*20),OF(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),$c(e.color,t);var r=0;return e.scheme=="major"&&(r=1),e.scheme=="minor"&&(r=2),t.write_shift(1,r),kt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var G6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Df,K6=dr;function wg(e,t){t||(t=V(4*3+8*7+16*1)),Df||(Df=qd(G6));var n=Df[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for($c({auto:1},t),$c({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function X6(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function gw(e,t,n){n||(n=V(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function bo(e,t){return t||(t=V(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Y6=dr;function q6(e,t){return t||(t=V(51)),t.write_shift(1,0),bo(null,t),bo(null,t),bo(null,t),bo(null,t),bo(null,t),t.length>t.l?t.slice(0,t.l):t}function Q6(e,t){return t||(t=V(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Vc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function J6(e,t,n){var r=V(2052);return r.write_shift(4,e),Vc(t,r),Vc(n,r),r.length>r.l?r.slice(0,r.l):r}function Z6(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(X(e,615,er(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&X(e,44,H6(i,t[i]))}),X(e,616))}}function eO(e){var t=1;X(e,611,er(t)),X(e,43,$6({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),X(e,612)}function tO(e){var t=2;X(e,603,er(t)),X(e,45,wg({patternType:"none"})),X(e,45,wg({patternType:"gray125"})),X(e,604)}function nO(e){var t=1;X(e,613,er(t)),X(e,46,q6()),X(e,614)}function rO(e){var t=1;X(e,626,er(t)),X(e,47,gw({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),X(e,627)}function iO(e,t){X(e,617,er(t.length)),t.forEach(function(n){X(e,47,gw(n,0))}),X(e,618)}function sO(e){var t=1;X(e,619,er(t)),X(e,48,Q6({xfId:0,builtinId:0,name:"Normal"})),X(e,620)}function oO(e){var t=0;X(e,505,er(t)),X(e,506)}function aO(e){var t=0;X(e,508,J6(t,"TableStyleMedium9","PivotStyleMedium4")),X(e,509)}function lO(e,t){var n=fn();return X(n,278),Z6(n,e.SSF),eO(n),tO(n),nO(n),rO(n),iO(n,t.cellXfs),sO(n),oO(n),aO(n),X(n,279),n.end()}function xw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[mt];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function cO(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$t(e)}}function uO(e){var t=V(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),kt(e.name,t),t.slice(0,t.l)}function fO(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function hO(e){var t=V(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function dO(e,t){var n=V(8+2*t.length);return n.write_shift(4,e),kt(t,n),n.slice(0,n.l)}function pO(e){return e.l+=4,e.read_shift(4)!=0}function mO(e,t){var n=V(8);return n.write_shift(4,e),n.write_shift(4,t?1:0),n}function gO(){var e=fn();return X(e,332),X(e,334,er(1)),X(e,335,uO({name:"XLDAPR",version:12e4,flags:3496657072})),X(e,336),X(e,339,dO(1,"XLDAPR")),X(e,52),X(e,35,er(514)),X(e,4096,er(0)),X(e,4097,Nn(1)),X(e,36),X(e,53),X(e,340),X(e,337,mO(1,!0)),X(e,51,hO([[1,0]])),X(e,338),X(e,333),e.end()}function vw(){var e=[mt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function xO(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Be(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var Ds=1024;function _w(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Z("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),Z("o:shapelayout",Z("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Z("v:shapetype",[Z("v:stroke",null,{joinstyle:"miter"}),Z("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ds<e*1e3;)Ds+=1e3;return t.forEach(function(s){var o=Ct(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Z("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Z("v:fill",l,a),u={on:"t",obscured:"t"};++Ds,i=i.concat(["<v:shape"+ja({id:"_x0000_s"+Ds,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Z("v:shadow",null,u),Z("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Pt("x:AutoFill","False"),Pt("x:Row",String(o.r)),Pt("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function yw(e){var t=[mt,Z("comments",null,{xmlns:go[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=be(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(be(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Pt("t",be(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;t.push(Pt("t",be(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function vO(e,t,n){var r=[mt,Z("ThreadedComments",null,{xmlns:St.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(Z("threadedComment",Pt("text",o.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function _O(e){var t=[mt,Z("personList",null,{xmlns:St.TCMNT,"xmlns:x":go[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(Z("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function yO(e){var t={};t.iauthor=e.read_shift(4);var n=fs(e);return t.rfx=n.s,t.ref=Be(n.s),e.l+=16,t}function wO(e,t){return t==null&&(t=V(36)),t.write_shift(4,e[1].iauthor),vo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var EO=$t;function TO(e){return kt(e.slice(0,54))}function SO(e){var t=fn(),n=[];return X(t,628),X(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),X(t,632,TO(i.a)))})}),X(t,631),X(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:Ct(r[0]),e:Ct(r[0])};X(t,635,wO([s,i])),i.t&&i.t.length>0&&X(t,637,kF(i)),X(t,636),delete i.iauthor})}),X(t,634),X(t,629),t.end()}function CO(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ue.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var ww=["xlsb","xlsm","xlam","biff8","xla"],kO=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=t.c:--u,l?c+=t.r:--c,i+(a?"":"$")+Vt(u)+(l?"":"$")+bt(c)}return function(i,s){return t=s,i.replace(e,n)}}(),cp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,up=function(){return function(t,n){return t.replace(cp,function(r,i,s,o,a,l){var c=rp(o)-(s?0:n.c),u=np(l)-(a?0:n.r),h=u==0?"":a?u+1:"["+u+"]",f=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+f})}}();function AO(e,t){return e.replace(cp,function(n,r,i,s,o,a){return r+(i=="$"?i+s:Vt(rp(s)+t.c))+(o=="$"?o+a:bt(np(a)+t.r))})}function IO(e){return e.length!=1}function ht(e){e.l+=1}function gi(e,t){var n=e.read_shift(t==1?1:2);return[n&16383,n>>14&1,n>>15&1]}function Ew(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return Tw(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=gi(e,2),a=gi(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Tw(e){var t=gi(e,2),n=gi(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function RO(e,t,n){if(n.biff<8)return Tw(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=gi(e,2),o=gi(e,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Sw(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return NO(e);var r=e.read_shift(n&&n.biff==12?4:2),i=gi(e,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function NO(e){var t=gi(e,2),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function FO(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function OO(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return DO(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function DO(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function PO(e,t,n){var r=(e[e.l++]&96)>>5,i=Ew(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function LO(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=Ew(e,s,n);return[r,i,o]}function bO(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function MO(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function BO(e,t,n){var r=(e[e.l++]&96)>>5,i=RO(e,t-1,n);return[r,i]}function jO(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Eg(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function UO(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function WO(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function zO(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function HO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function VO(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function Cw(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function $O(e){return e.read_shift(2),Cw(e)}function GO(e){return e.read_shift(2),Cw(e)}function KO(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=Sw(e,0,n);return[r,i]}function XO(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=OO(e,0,n);return[r,i]}function YO(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=Sw(e,0,n);return[r,i,s]}function qO(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[qD[i],Iw[i],r]}function QO(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:JO(e);return[i,(s[0]===0?Iw:YD)[s[1]]]}function JO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function ZO(e,t,n){e.l+=n&&n.biff==2?3:4}function eD(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function tD(e){return e.l++,nl[e.read_shift(1)]}function nD(e){return e.l++,e.read_shift(2)}function rD(e){return e.l++,e.read_shift(1)!==0}function iD(e){return e.l++,_o(e)}function sD(e,t,n){return e.l++,aw(e,t-1,n)}function oD(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=YF(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=nl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=_o(e);break;case 2:n[1]=ZF(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function aD(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?fs:n6)(e));return i}function lD(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=oD(e,n.biff);return o}function cD(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function uD(e,t,n){if(n.biff==5)return fD(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function fD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function hD(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function dD(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function pD(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function mD(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var gD=dr,xD=dr,vD=dr;function rl(e,t,n){return e.l+=2,[FO(e)]}function fp(e){return e.l+=6,[]}var _D=rl,yD=fp,wD=fp,ED=rl;function kw(e){return e.l+=2,[sw(e),e.read_shift(2)&1]}var TD=rl,SD=kw,CD=fp,kD=rl,AD=rl,ID=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RD(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=ID[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:r,c:i,C:s}}function ND(e){return e.l+=2,[e.read_shift(4)]}function FD(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function OD(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function DD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function PD(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function LD(e){return e.l+=4,[0,0]}var Tg={1:{n:"PtgExp",f:eD},2:{n:"PtgTbl",f:vD},3:{n:"PtgAdd",f:ht},4:{n:"PtgSub",f:ht},5:{n:"PtgMul",f:ht},6:{n:"PtgDiv",f:ht},7:{n:"PtgPower",f:ht},8:{n:"PtgConcat",f:ht},9:{n:"PtgLt",f:ht},10:{n:"PtgLe",f:ht},11:{n:"PtgEq",f:ht},12:{n:"PtgGe",f:ht},13:{n:"PtgGt",f:ht},14:{n:"PtgNe",f:ht},15:{n:"PtgIsect",f:ht},16:{n:"PtgUnion",f:ht},17:{n:"PtgRange",f:ht},18:{n:"PtgUplus",f:ht},19:{n:"PtgUminus",f:ht},20:{n:"PtgPercent",f:ht},21:{n:"PtgParen",f:ht},22:{n:"PtgMissArg",f:ht},23:{n:"PtgStr",f:sD},26:{n:"PtgSheet",f:FD},27:{n:"PtgEndSheet",f:OD},28:{n:"PtgErr",f:tD},29:{n:"PtgBool",f:rD},30:{n:"PtgInt",f:nD},31:{n:"PtgNum",f:iD},32:{n:"PtgArray",f:jO},33:{n:"PtgFunc",f:qO},34:{n:"PtgFuncVar",f:QO},35:{n:"PtgName",f:cD},36:{n:"PtgRef",f:KO},37:{n:"PtgArea",f:PO},38:{n:"PtgMemArea",f:hD},39:{n:"PtgMemErr",f:gD},40:{n:"PtgMemNoMem",f:xD},41:{n:"PtgMemFunc",f:dD},42:{n:"PtgRefErr",f:pD},43:{n:"PtgAreaErr",f:bO},44:{n:"PtgRefN",f:XO},45:{n:"PtgAreaN",f:BO},46:{n:"PtgMemAreaN",f:DD},47:{n:"PtgMemNoMemN",f:PD},57:{n:"PtgNameX",f:uD},58:{n:"PtgRef3d",f:YO},59:{n:"PtgArea3d",f:LO},60:{n:"PtgRefErr3d",f:mD},61:{n:"PtgAreaErr3d",f:MO},255:{}},bD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},MD={1:{n:"PtgElfLel",f:kw},2:{n:"PtgElfRw",f:kD},3:{n:"PtgElfCol",f:_D},6:{n:"PtgElfRwV",f:AD},7:{n:"PtgElfColV",f:ED},10:{n:"PtgElfRadical",f:TD},11:{n:"PtgElfRadicalS",f:CD},13:{n:"PtgElfColS",f:yD},15:{n:"PtgElfColSV",f:wD},16:{n:"PtgElfRadicalLel",f:SD},25:{n:"PtgList",f:RD},29:{n:"PtgSxName",f:ND},255:{}},BD={0:{n:"PtgAttrNoop",f:LD},1:{n:"PtgAttrSemi",f:VO},2:{n:"PtgAttrIf",f:zO},4:{n:"PtgAttrChoose",f:UO},8:{n:"PtgAttrGoto",f:WO},16:{n:"PtgAttrSum",f:ZO},32:{n:"PtgAttrBaxcel",f:Eg},33:{n:"PtgAttrBaxcel",f:Eg},64:{n:"PtgAttrSpace",f:$O},65:{n:"PtgAttrSpaceSemi",f:GO},128:{n:"PtgAttrIfError",f:HO},255:{}};function jD(e,t,n,r){if(r.biff<8)return dr(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=lD(e,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=aD(e,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(dr(e,t)),s}function UD(e,t,n){for(var r=e.l+t,i,s,o=[];r!=e.l;)t=r-e.l,s=e[e.l],i=Tg[s]||Tg[bD[s]],(s===24||s===25)&&(i=(s===24?MD:BD)[e[e.l+1]]),!i||!i.f?dr(e,t):o.push([i.n,i.f(e,t,n)]);return o}function WD(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var zD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HD(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Aw(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Sg(e,t,n){var r=Aw(e,t,n);return r=="#REF"?r:HD(r,n)}function oo(e,t,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,c,u,h=0,f=0,p,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,w="",_=0,x=e[0].length;_<x;++_){var y=e[0][_];switch(y[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),m>=0){switch(e[0][m][1][0]){case 0:w=ot(" ",e[0][m][1][1]);break;case 1:w=ot("\r",e[0][m][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+w,m=-1}a.push(c+zD[y[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=oa(y[1][1],o,i),a.push(aa(u,s));break;case"PtgRefN":u=n?oa(y[1][1],n,i):y[1][1],a.push(aa(u,s));break;case"PtgRef3d":h=y[1][1],u=oa(y[1][2],o,i),g=Sg(r,h,i),a.push(g+"!"+aa(u,s));break;case"PtgFunc":case"PtgFuncVar":var I=y[1][0],O=y[1][1];I||(I=0),I&=127;var z=I==0?[]:a.slice(-I);a.length-=I,O==="User"&&(O=z.shift()),a.push(O+"("+z.join(",")+")");break;case"PtgBool":a.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(y[1]);break;case"PtgNum":a.push(String(y[1]));break;case"PtgStr":a.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(y[1]);break;case"PtgAreaN":p=lg(y[1][1],n?{s:n}:o,i),a.push(Ff(p,i));break;case"PtgArea":p=lg(y[1][1],o,i),a.push(Ff(p,i));break;case"PtgArea3d":h=y[1][1],p=y[1][2],g=Sg(r,h,i),a.push(g+"!"+Ff(p,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=y[1][2];var N=(r.names||[])[f-1]||(r[0]||[])[f],D=N?N.Name:"SH33TJSNAME"+String(f);D&&D.slice(0,6)=="_xlfn."&&!i.xlfn&&(D=D.slice(6)),a.push(D);break;case"PtgNameX":var L=y[1][1];f=y[1][2];var P;if(i.biff<=5)L<0&&(L=-L),r[L]&&(P=r[L][f]);else{var H="";if(((r[L]||[])[0]||[])[0]==14849||(((r[L]||[])[0]||[])[0]==1025?r[L][f]&&r[L][f].itab>0&&(H=r.SheetNames[r[L][f].itab-1]+"!"):H=r.SheetNames[f-1]+"!"),r[L]&&r[L][f])H+=r[L][f].Name;else if(r[0]&&r[0][f])H+=r[0][f].Name;else{var K=(Aw(r,L,i)||"").split(";;");K[f-1]?H=K[f-1]:H+="SH33TJSERRX"}a.push(H);break}P||(P={Name:"SH33TJSERRY"}),a.push(P.Name);break;case"PtgParen":var te="(",we=")";if(m>=0){switch(w="",e[0][m][1][0]){case 2:te=ot(" ",e[0][m][1][1])+te;break;case 3:te=ot("\r",e[0][m][1][1])+te;break;case 4:we=ot(" ",e[0][m][1][1])+we;break;case 5:we=ot("\r",e[0][m][1][1])+we;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}a.push(te+a.pop()+we);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var ve={c:n.c,r:n.r};if(r.sharedf[Be(u)]){var He=r.sharedf[Be(u)];a.push(oo(He,o,ve,r,i))}else{var We=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(oo(c[1],o,ve,r,i)),We=!0;break}We||a.push(y[1])}break;case"PtgArray":a.push("{"+WD(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&se.indexOf(e[0][_][0])==-1){y=e[0][m];var de=!0;switch(y[1][0]){case 4:de=!1;case 0:w=ot(" ",y[1][1]);break;case 5:de=!1;case 1:w=ot("\r",y[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}a.push((de?w:"")+a.pop()+(de?"":w)),m=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function VD(e){if(e==null){var t=V(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ns(e);return ns(0)}function $D(e,t,n,r,i){var s=rs(t,n,i),o=VD(e.v),a=V(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=V(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Dt([s,o,a,c]);return h}function Ou(e,t,n){var r=e.read_shift(4),i=UD(e,r,n),s=e.read_shift(4),o=s>0?jD(e,s,i,n):null;return[i,o]}var GD=Ou,Du=Ou,KD=Ou,XD=Ou,YD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Iw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function QD(e){var t="of:="+e.replace(cp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function JD(e){return e.replace(/\./,"!")}var la=typeof Map<"u";function hp(e,t,n){var r=0,i=e.length;if(n){if(la?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=la?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(la?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function Pu(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Ir=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=Xc(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=th(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function Rw(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function Ei(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){S2(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function ZD(e,t,n){if(e&&e["!ref"]){var r=qe(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function eP(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+pt(e[n])+'"/>';return t+"</mergeCells>"}function tP(e,t,n,r,i){var s=!1,o={},a=null;if(r.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,o.codeName=Tr(be(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+Z("outlinePr",null,c)}!s&&!a||(i[i.length]=Z("sheetPr",a,o))}var nP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],rP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function iP(e){var t={sheet:1};return nP.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),rP.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=hw(e.password).toString(16).toUpperCase()),Z("sheetProtection",null,t)}function sP(e){return Rw(e),Z("pageMargins",null,e)}function oP(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=Z("col",null,Pu(i,r)));return n[n.length]="</cols>",n.join("")}function aP(e,t,n,r){var i=typeof e.ref=="string"?e.ref:pt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=Cn(i);o.s.r==o.e.r&&(o.e.r=Cn(t["!ref"]).e.r,i=pt(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Z("autoFilter",null,{ref:i})}function lP(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Z("sheetViews",Z("sheetView",null,i),{})}function cP(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=nl[e.v];break;case"d":r&&r.cellDates?i=Zt(e.v,-1).toISOString():(e=pn(e),e.t="n",i=""+(e.v=dn(Zt(e.v)))),typeof e.z>"u"&&(e.z=lt[14]);break;default:i=e.v;break}var a=Pt("v",be(i)),l={r:t},c=Ei(r.cellXfs,e,r);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Pt("v",""+hp(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=Z("f",be(e.f),u)+(e.v!=null?a:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),Z("c",a,l)}function uP(e,t,n,r){var i=[],s=[],o=qe(e["!ref"]),a="",l,c="",u=[],h=0,f=0,p=e["!rows"],g=Array.isArray(e),m={r:c},w,_=-1;for(f=o.s.c;f<=o.e.c;++f)u[f]=Vt(f);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=bt(h),f=o.s.c;f<=o.e.c;++f){l=u[f]+c;var x=g?(e[h]||[])[f]:e[l];x!==void 0&&(a=cP(x,l,e,t))!=null&&s.push(a)}(s.length>0||p&&p[h])&&(m={r:c},p&&p[h]&&(w=p[h],w.hidden&&(m.hidden=1),_=-1,w.hpx?_=Yc(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(m.ht=_,m.customHeight=1),w.level&&(m.outlineLevel=w.level)),i[i.length]=Z("row",s.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},w=p[h],w.hidden&&(m.hidden=1),_=-1,w.hpx?_=Yc(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(m.ht=_,m.customHeight=1),w.level&&(m.outlineLevel=w.level),i[i.length]=Z("row","",m));return i.join("")}function Nw(e,t,n,r){var i=[mt,Z("worksheet",null,{xmlns:go[0],"xmlns:r":St.r})],s=n.SheetNames[e],o=0,a="",l=n.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=qe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=pt(u)}r||(r={}),l["!comments"]=[];var h=[];tP(l,n,e,t,i),i[i.length]=Z("dimension",null,{ref:c}),i[i.length]=lP(l,t,e,n),t.sheetFormat&&(i[i.length]=Z("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=oP(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=uP(l,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=iP(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=aP(l["!autofilter"],l,n,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=eP(l["!merges"]));var f=-1,p,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Le(r,-1,be(m[1].Target).replace(/#.*$/,""),Fe.HLINK),p["r:id"]="rId"+g),(f=m[1].Target.indexOf("#"))>-1&&(p.location=be(m[1].Target.slice(f+1))),m[1].Tooltip&&(p.tooltip=be(m[1].Tooltip)),i[i.length]=Z("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=sP(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Pt("ignoredErrors",Z("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=Le(r,-1,"../drawings/drawing"+(e+1)+".xml",Fe.DRAW),i[i.length]=Z("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=Le(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Fe.VML),i[i.length]=Z("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function fP(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function hP(e,t,n){var r=V(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=Yc(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,f=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var g=Array.isArray(n)?(n[c.r]||[])[c.c]:n[Be(c)];g&&(h<0&&(h=p),f=p)}h<0||(++a,r.write_shift(4,h),r.write_shift(4,f))}var m=r.l;return r.l=l,r.write_shift(4,a),r.l=m,r.length>r.l?r.slice(0,r.l):r}function dP(e,t,n,r){var i=hP(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&X(e,0,i)}var pP=fs,mP=vo;function gP(){}function xP(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=AF(e),n}function vP(e,t,n){n==null&&(n=V(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return $c({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),$2(e,n),n.slice(0,n.l)}function _P(e){var t=jn(e);return[t]}function yP(e,t,n){return n==null&&(n=V(8)),ls(t,n)}function wP(e){var t=cs(e);return[t]}function EP(e,t,n){return n==null&&(n=V(4)),us(t,n)}function TP(e){var t=jn(e),n=e.read_shift(1);return[t,n,"b"]}function SP(e,t,n){return n==null&&(n=V(9)),ls(t,n),n.write_shift(1,e.v?1:0),n}function CP(e){var t=cs(e),n=e.read_shift(1);return[t,n,"b"]}function kP(e,t,n){return n==null&&(n=V(5)),us(t,n),n.write_shift(1,e.v?1:0),n}function AP(e){var t=jn(e),n=e.read_shift(1);return[t,n,"e"]}function IP(e,t,n){return n==null&&(n=V(9)),ls(t,n),n.write_shift(1,e.v),n}function RP(e){var t=cs(e),n=e.read_shift(1);return[t,n,"e"]}function NP(e,t,n){return n==null&&(n=V(8)),us(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function FP(e){var t=jn(e),n=e.read_shift(4);return[t,n,"s"]}function OP(e,t,n){return n==null&&(n=V(12)),ls(t,n),n.write_shift(4,t.v),n}function DP(e){var t=cs(e),n=e.read_shift(4);return[t,n,"s"]}function PP(e,t,n){return n==null&&(n=V(8)),us(t,n),n.write_shift(4,t.v),n}function LP(e){var t=jn(e),n=_o(e);return[t,n,"n"]}function bP(e,t,n){return n==null&&(n=V(16)),ls(t,n),ns(e.v,n),n}function MP(e){var t=cs(e),n=_o(e);return[t,n,"n"]}function BP(e,t,n){return n==null&&(n=V(12)),us(t,n),ns(e.v,n),n}function jP(e){var t=jn(e),n=G2(e);return[t,n,"n"]}function UP(e,t,n){return n==null&&(n=V(12)),ls(t,n),K2(e.v,n),n}function WP(e){var t=cs(e),n=G2(e);return[t,n,"n"]}function zP(e,t,n){return n==null&&(n=V(8)),us(t,n),K2(e.v,n),n}function HP(e){var t=jn(e),n=ip(e);return[t,n,"is"]}function VP(e){var t=jn(e),n=$t(e);return[t,n,"str"]}function $P(e,t,n){return n==null&&(n=V(12+4*e.v.length)),ls(t,n),kt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function GP(e){var t=cs(e),n=$t(e);return[t,n,"str"]}function KP(e,t,n){return n==null&&(n=V(8+4*e.v.length)),us(t,n),kt(e.v,n),n.length>n.l?n.slice(0,n.l):n}function XP(e,t,n){var r=e.l+t,i=jn(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var a=Du(e,r-e.l,n);o[3]=oo(a,null,i,n.supbooks,n)}else e.l=r;return o}function YP(e,t,n){var r=e.l+t,i=jn(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var a=Du(e,r-e.l,n);o[3]=oo(a,null,i,n.supbooks,n)}else e.l=r;return o}function qP(e,t,n){var r=e.l+t,i=jn(e);i.r=n["!row"];var s=_o(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var a=Du(e,r-e.l,n);o[3]=oo(a,null,i,n.supbooks,n)}else e.l=r;return o}function QP(e,t,n){var r=e.l+t,i=jn(e);i.r=n["!row"];var s=$t(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var a=Du(e,r-e.l,n);o[3]=oo(a,null,i,n.supbooks,n)}else e.l=r;return o}var JP=fs,ZP=vo;function e8(e,t){return t==null&&(t=V(4)),t.write_shift(4,e),t}function t8(e,t){var n=e.l+t,r=fs(e),i=sp(e),s=$t(e),o=$t(e),a=$t(e);e.l=n;var l={rfx:r,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function n8(e,t){var n=V(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vo({s:Ct(e[0]),e:Ct(e[0])},n),op("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return kt(i||"",n),kt(e[1].Tooltip||"",n),kt("",n),n.slice(0,n.l)}function r8(){}function i8(e,t,n){var r=e.l+t,i=X2(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var a=GD(e,r-e.l,n);o[1]=a}else e.l=r;return o}function s8(e,t,n){var r=e.l+t,i=fs(e),s=[i];if(n.cellFormula){var o=XD(e,r-e.l,n);s[1]=o,e.l=r}else e.l=r;return s}function o8(e,t,n){n==null&&(n=V(18));var r=Pu(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var Fw=["left","right","top","bottom","header","footer"];function a8(e){var t={};return Fw.forEach(function(n){t[n]=_o(e)}),t}function l8(e,t){return t==null&&(t=V(6*8)),Rw(e),Fw.forEach(function(n){ns(e[n],t)}),t}function c8(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function u8(e,t,n){n==null&&(n=V(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function f8(e){var t=V(24);return t.write_shift(4,4),t.write_shift(4,1),vo(e,t),t}function h8(e,t){return t==null&&(t=V(16*4+2)),t.write_shift(2,e.password?hw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function d8(){}function p8(){}function m8(e,t,n,r,i,s,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=pn(t),t.z=t.z||lt[14],t.v=dn(Zt(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r:n,c:r};switch(l.s=Ei(i.cellXfs,t,i),t.l&&s["!links"].push([Be(l),t.l]),t.c&&s["!comments"].push([Be(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=hp(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,o?X(e,18,PP(t,l)):X(e,7,OP(t,l))):(l.t="str",o?X(e,17,KP(t,l)):X(e,6,$P(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?X(e,13,zP(t,l)):X(e,2,UP(t,l)):o?X(e,16,BP(t,l)):X(e,5,bP(t,l)),!0;case"b":return l.t="b",o?X(e,15,kP(t,l)):X(e,4,SP(t,l)),!0;case"e":return l.t="e",o?X(e,14,NP(t,l)):X(e,3,IP(t,l)),!0}return o?X(e,12,EP(t,l)):X(e,1,yP(t,l)),!0}function g8(e,t,n,r){var i=qe(t["!ref"]||"A1"),s,o="",a=[];X(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=bt(u),dP(e,t,i,u);var h=!1;if(u<=i.e.r)for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(a[f]=Vt(f)),s=a[f]+o;var p=l?(t[u]||[])[f]:t[s];if(!p){h=!1;continue}h=m8(e,p,u,f,r,t,h)}}X(e,146)}function x8(e,t){!t||!t["!merges"]||(X(e,177,e8(t["!merges"].length)),t["!merges"].forEach(function(n){X(e,176,ZP(n))}),X(e,178))}function v8(e,t){!t||!t["!cols"]||(X(e,390),t["!cols"].forEach(function(n,r){n&&X(e,60,o8(r,n))}),X(e,391))}function _8(e,t){!t||!t["!ref"]||(X(e,648),X(e,649,f8(qe(t["!ref"]))),X(e,650))}function y8(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Le(n,-1,r[1].Target.replace(/#.*$/,""),Fe.HLINK);X(e,494,n8(r,i))}}),delete t["!links"]}function w8(e,t,n,r){if(t["!comments"].length>0){var i=Le(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Fe.VML);X(e,551,op("rId"+i)),t["!legacy"]=i}}function E8(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:pt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,a=Cn(s);a.s.r==a.e.r&&(a.e.r=Cn(t["!ref"]).e.r,s=pt(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),X(e,161,vo(qe(s))),X(e,162)}}function T8(e,t,n){X(e,133),X(e,137,u8(t,n)),X(e,138),X(e,134)}function S8(e,t){t["!protect"]&&X(e,535,h8(t["!protect"]))}function C8(e,t,n,r){var i=fn(),s=n.SheetNames[e],o=n.Sheets[s]||{},a=s;try{n&&n.Workbook&&(a=n.Workbook.Sheets[e].CodeName||a)}catch{}var l=qe(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],X(i,129),(n.vbaraw||o["!outline"])&&X(i,147,vP(a,o["!outline"])),X(i,148,mP(l)),T8(i,o,n.Workbook),v8(i,o),g8(i,o,e,t),S8(i,o),E8(i,o,n,e),x8(i,o),y8(i,o,r),o["!margins"]&&X(i,476,l8(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&_8(i,o),w8(i,o,e,r),X(i,130),i.end()}function k8(e,t){e.l+=10;var n=$t(e);return{name:n}}var A8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function I8(e){return!e.Workbook||!e.Workbook.WBProps?"false":sF(e.Workbook.WBProps.date1904)?"true":"false"}var R8="][*?/\\".split("");function Ow(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return R8.forEach(function(r){if(e.indexOf(r)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function N8(e,t,n){e.forEach(function(r,i){Ow(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function F8(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];N8(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)ZD(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function Dw(e){var t=[mt];t[t.length]=Z("workbook",null,{xmlns:go[0],"xmlns:r":St.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(A8.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Z("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:be(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Z("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=Z("definedName",be(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function O8(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=eh(e),n.name=$t(e),n}function D8(e,t){return t||(t=V(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),op(e.strRelID,t),kt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function P8(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?$t(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function L8(e,t){t||(t=V(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),$2(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function b8(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=IF(e),o=KD(e,0,n),a=sp(e);e.l=r;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function M8(e,t){X(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};X(e,156,D8(i))}X(e,144)}function B8(e,t){t||(t=V(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return kt("SheetJS",t),kt(Bc.version,t),kt(Bc.version,t),kt("7262",t),t.length>t.l?t.slice(0,t.l):t}function j8(e,t){t||(t=V(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function U8(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(X(e,135),X(e,158,j8(i)),X(e,136))}}function W8(e,t){var n=fn();return X(n,131),X(n,128,B8()),X(n,153,L8(e.Workbook&&e.Workbook.WBProps||null)),U8(n,e),M8(n,e),X(n,132),n.end()}function z8(e,t,n){return(t.slice(-4)===".bin"?W8:Dw)(e)}function H8(e,t,n,r,i){return(t.slice(-4)===".bin"?C8:Nw)(e,n,r,i)}function V8(e,t,n){return(t.slice(-4)===".bin"?lO:mw)(e,n)}function $8(e,t,n){return(t.slice(-4)===".bin"?L6:fw)(e,n)}function G8(e,t,n){return(t.slice(-4)===".bin"?SO:yw)(e)}function K8(e){return(e.slice(-4)===".bin"?gO:vw)()}function X8(e,t){var n=[];return e.Props&&n.push(VF(e.Props,t)),e.Custprops&&n.push($F(e.Props,e.Custprops)),n.join("")}function Y8(){return""}function q8(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(Z("NumberFormat",null,{"ss:Format":be(lt[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(Z("Style",s.join(""),o))}),Z("Styles",n.join(""))}function Pw(e){return Z("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+up(e.Ref,{r:0,c:0})})}function Q8(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(Pw(i)))}return Z("Names",n.join(""))}function J8(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||s.push(Pw(a)))}return s.join("")}function Z8(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Z("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Z("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Z("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(Z("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Pt("ProtectContents","True")),e["!protect"].objects&&i.push(Pt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Pt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Pt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Pt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Z("WorksheetOptions",i.join(""),{xmlns:_n.x})}function e5(e){return e.map(function(t){var n=iF(t.t||""),r=Z("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Z("Comment",r,{"ss:Author":t.a})}).join("")}function t5(e,t,n,r,i,s,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+be(up(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=Ct(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=be(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=be(e.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",f="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",f=String(e.v);break;case"b":h="Boolean",f=e.v?"1":"0";break;case"e":h="Error",f=nl[e.v];break;case"d":h="DateTime",f=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||lt[14]);break;case"s":h="String",f=rF(e.v||"");break}var p=Ei(r.cellXfs,e,r);a["ss:StyleID"]="s"+(21+p),a["ss:Index"]=o.c+1;var g=e.v!=null?f:"",m=e.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=e5(e.c)),Z("Cell",m,a)}function n5(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=pw(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function r5(e,t,n,r){if(!e["!ref"])return"";var i=qe(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(w,_){lp(w);var x=!!w.width,y=Pu(_,w),I={"ss:Index":_+1};x&&(I["ss:Width"]=Kc(y.width)),w.hidden&&(I["ss:Hidden"]="1"),a.push(Z("Column",null,I))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[n5(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var f=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(f=!0);break}if(!f){var p={r:c,c:h},g=Be(p),m=l?(e[c]||[])[h]:e[g];u.push(t5(m,g,e,t,n,r,p))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function i5(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],o=s?J8(s,t,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?r5(s,t,e,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(Z8(s,t,e,n)),r.join("")}function s5(e,t){t||(t={}),e.SSF||(e.SSF=pn(lt)),e.SSF&&(Ru(),Iu(e.SSF),t.revssf=Nu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ei(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(X8(e,t)),n.push(Y8()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Z("Worksheet",i5(r,t,e),{"ss:Name":be(e.SheetNames[r])}));return n[2]=q8(e,t),n[3]=Q8(e),mt+Z("Workbook",n.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}var Pf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function o5(e,t){var n=[],r=[],i=[],s=0,o,a=Qm(ug,"n"),l=Qm(fg,"n");if(e.Props)for(o=Bt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Bt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?n:Object.prototype.hasOwnProperty.call(l,o[s])?r:i).push([o[s],e.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)iw.indexOf(i[s][0])>-1||tw.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);r.length&&Ue.utils.cfb_add(t,"/SummaryInformation",gg(r,Pf.SI,l,fg)),(n.length||c.length)&&Ue.utils.cfb_add(t,"/DocumentSummaryInformation",gg(n,Pf.DSI,a,ug,c.length?c:null,Pf.UDI))}function a5(e,t){var n=t||{},r=Ue.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Ue.utils.cfb_add(r,i,Lw(e,n)),n.biff==8&&(e.Props||e.Custprops)&&o5(e,r),n.biff==8&&e.vbaraw&&CO(r,Ue.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var l5={0:{f:fP},1:{f:_P},2:{f:jP},3:{f:AP},4:{f:TP},5:{f:LP},6:{f:VP},7:{f:FP},8:{f:QP},9:{f:qP},10:{f:XP},11:{f:YP},12:{f:wP},13:{f:WP},14:{f:RP},15:{f:CP},16:{f:MP},17:{f:GP},18:{f:DP},19:{f:ip},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:b8},40:{},42:{},43:{f:V6},44:{f:z6},45:{f:K6},46:{f:Y6},47:{f:X6},48:{},49:{f:wF},50:{},51:{f:fO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:E6},62:{f:HP},63:{f:xO},64:{f:d8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:c8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:xP},148:{f:pP,p:16},151:{f:r8},152:{},153:{f:P8},154:{},155:{},156:{f:O8},157:{},158:{},159:{T:1,f:O6},160:{T:-1},161:{T:1,f:fs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:JP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:cO},336:{T:-1},337:{f:pO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:eh},357:{},358:{},359:{},360:{T:1},361:{},362:{f:g6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:i8},427:{f:s8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:a8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:t8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:eh},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EO},633:{T:1},634:{T:-1},635:{T:1,f:yO},636:{T:-1},637:{f:CF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:k8},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:p8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function re(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&tp(n)&&e.push(n)}}function c5(e,t,n,r){var i=r||(n||[]).length||0;if(i<=8224)return re(e,t,n,i);var s=t;if(!isNaN(s)){for(var o=n.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),e.push(n.slice(l,l+c)),l+=c}}}function il(e,t,n){return e||(e=V(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function u5(e,t,n,r){var i=V(9);return il(i,e,t),ow(n,r||"b",i),i}function f5(e,t,n){var r=V(8+2*n.length);return il(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function h5(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?dn(Zt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?re(e,2,k6(n,r,i)):re(e,3,C6(n,r,i));return;case"b":case"e":re(e,5,u5(n,r,t.v,t.t));return;case"s":case"str":re(e,4,f5(n,r,(t.v||"").slice(0,255)));return}re(e,1,il(null,n,r))}function d5(e,t,n,r){var i=Array.isArray(t),s=qe(t["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=pt(s)}for(var c=s.s.r;c<=s.e.r;++c){a=bt(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Vt(u)),o=l[u]+a;var h=i?(t[c]||[])[u]:t[o];h&&h5(e,h,c,u)}}}function p5(e,t){for(var n=t||{},r=fn(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return re(r,n.biff==4?1033:n.biff==3?521:9,ap(e,16,n)),d5(r,e.Sheets[e.SheetNames[i]],i,n),re(r,10),r.end()}function m5(e,t,n){re(e,49,l6({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function g5(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&re(e,1054,f6(i,t[i],n))})}function x5(e,t){var n=V(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),re(e,2151,n),n=V(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),cw(qe(t["!ref"]||"A1"),n),n.write_shift(4,4),re(e,2152,n)}function v5(e,t){for(var n=0;n<16;++n)re(e,224,vg({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){re(e,224,vg(r,0,t))})}function _5(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];re(e,440,_6(r)),r[1].Tooltip&&re(e,2048,y6(r))}delete t["!links"]}function y5(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&re(e,125,T6(Pu(i,r),i))})}}function w5(e,t,n,r,i){var s=16+Ei(i.cellXfs,t,i);if(t.v==null&&!t.bf){re(e,513,rs(n,r,s));return}if(t.bf)re(e,6,$D(t,n,r,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?dn(Zt(t.v)):t.v;re(e,515,m6(n,r,o,s));break;case"b":case"e":re(e,517,p6(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var a=hp(i.Strings,t.v,i.revStrings);re(e,253,c6(n,r,a,s))}else re(e,516,u6(n,r,(t.v||"").slice(0,255),s,i));break;default:re(e,513,rs(n,r,s))}}function E5(e,t,n){var r=fn(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,h="",f=[],p=qe(s["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}re(r,2057,ap(n,16,t)),re(r,13,Nn(1)),re(r,12,Nn(100)),re(r,15,qt(!0)),re(r,17,qt(!1)),re(r,16,ns(.001)),re(r,95,qt(!0)),re(r,42,qt(!1)),re(r,43,qt(!1)),re(r,130,Nn(1)),re(r,128,d6([0,0])),re(r,131,qt(!1)),re(r,132,qt(!1)),c&&y5(r,s["!cols"]),re(r,512,h6(p,t)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=bt(m);for(var w=p.s.c;w<=p.e.c;++w){m===p.s.r&&(f[w]=Vt(w)),u=f[w]+h;var _=l?(s[m]||[])[w]:s[u];_&&(w5(r,_,m,w,t),c&&_.l&&s["!links"].push([u,_.l]))}}var x=a.CodeName||a.name||i;return c&&re(r,574,a6((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&re(r,229,v6(s["!merges"])),c&&_5(r,s),re(r,442,lw(x)),c&&x5(r,s),re(r,10),r.end()}function T5(e,t,n){var r=fn(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(re(r,2057,ap(e,5,n)),n.bookType=="xla"&&re(r,135),re(r,225,a?Nn(1200):null),re(r,193,XF(2)),l&&re(r,191),l&&re(r,192),re(r,226),re(r,92,r6("SheetJS",n)),re(r,66,Nn(a?1200:1252)),a&&re(r,353,Nn(0)),a&&re(r,448),re(r,317,S6(e.SheetNames.length)),a&&e.vbaraw&&re(r,211),a&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";re(r,442,lw(c))}re(r,156,Nn(17)),re(r,25,qt(!1)),re(r,18,qt(!1)),re(r,19,Nn(0)),a&&re(r,431,qt(!1)),a&&re(r,444,Nn(0)),re(r,61,o6()),re(r,64,qt(!1)),re(r,141,Nn(0)),re(r,34,qt(I8(e)=="true")),re(r,14,qt(!0)),a&&re(r,439,qt(!1)),re(r,218,Nn(0)),m5(r,e,n),g5(r,e.SSF,n),v5(r,n),a&&re(r,352,qt(!1));var u=r.end(),h=fn();a&&re(h,140,w6()),a&&n.Strings&&c5(h,252,s6(n.Strings)),re(h,10);var f=h.end(),p=fn(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(a?12:11)+(a?2:1)*e.SheetNames[m].length;var w=u.length+g+f.length;for(m=0;m<e.SheetNames.length;++m){var _=s[m]||{};re(p,133,i6({pos:w,hs:_.Hidden||0,dt:0,name:e.SheetNames[m]},n)),w+=t[m].length}var x=p.end();if(g!=x.length)throw new Error("BS8 "+g+" != "+x.length);var y=[];return u.length&&y.push(u),x.length&&y.push(x),f.length&&y.push(f),Dt(y)}function S5(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=pn(lt)),e&&e.SSF&&(Ru(),Iu(e.SSF),n.revssf=Nu(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,dp(n),n.cellXfs=[],Ei(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=E5(i,n,e);return r.unshift(T5(e,r,n)),Dt(r)}function Lw(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=Cn(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return S5(e,t);case 4:case 3:case 2:return p5(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function C5(e,t,n,r){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>o)&&!(i[c].e.r<n||i[c].e.c<o)){if(i[c].s.r<n||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=Be({r:n,c:o}),h=r.dense?(e[n]||[])[o]:e[u],f=h&&h.v!=null&&(h.h||nF(h.w||(Br(h),h.w)||""))||"",p={};a>1&&(p.rowspan=a),l>1&&(p.colspan=l),r.editable?f='<span contenteditable="true">'+f+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),p.id=(r.id||"sjs")+"-"+u,s.push(Z("td",f,p))}}var g="<tr>";return g+s.join("")+"</tr>"}var k5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',A5="</body></html>";function I5(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function bw(e,t){var n=t||{},r=n.header!=null?n.header:k5,i=n.footer!=null?n.footer:A5,s=[r],o=Cn(e["!ref"]);n.dense=Array.isArray(e),s.push(I5(e,o,n));for(var a=o.s.r;a<=o.e.r;++a)s.push(C5(e,o,a,n));return s.push("</table>"+i),s.join("")}function Mw(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?Ct(r.origin):r.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=Cn(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],f=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,w=0,_=0,x=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<a.length&&m<l;++g){var I=a[g];if(Cg(I)){if(r.display)continue;p[m]={hidden:!0}}var O=I.children;for(w=_=0;w<O.length;++w){var z=O[w];if(!(r.display&&Cg(z))){var N=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):oF(z.innerHTML),D=z.getAttribute("data-z")||z.getAttribute("z");for(f=0;f<h.length;++f){var L=h[f];L.s.c==_+s&&L.s.r<m+i&&m+i<=L.e.r&&(_=L.e.c+1-s,f=-1)}y=+z.getAttribute("colspan")||1,((x=+z.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:m+i,c:_+s},e:{r:m+i+(x||1)-1,c:_+s+(y||1)-1}});var P={t:"s",v:N},H=z.getAttribute("data-t")||z.getAttribute("t")||"";N!=null&&(N.length==0?P.t=H||"z":r.raw||N.trim().length==0||H=="s"||(N==="TRUE"?P={t:"b",v:!0}:N==="FALSE"?P={t:"b",v:!1}:isNaN(Ar(N))?isNaN(Ba(N).getDate())||(P={t:"d",v:Zt(N)},r.cellDates||(P={t:"n",v:dn(P.v)}),P.z=r.dateNF||lt[14]):P={t:"n",v:Ar(N)})),P.z===void 0&&D!=null&&(P.z=D);var K="",te=z.getElementsByTagName("A");if(te&&te.length)for(var we=0;we<te.length&&!(te[we].hasAttribute("href")&&(K=te[we].getAttribute("href"),K.charAt(0)!="#"));++we);K&&K.charAt(0)!="#"&&(P.l={Target:K}),r.dense?(e[m+i]||(e[m+i]=[]),e[m+i][_+s]=P):e[Be({c:_+s,r:m+i})]=P,c.e.c<_+s&&(c.e.c=_+s),_+=y}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=pt(c),m>=l&&(e["!fullref"]=pt((c.e.r=a.length-g+m-1+i,c))),e}function Bw(e,t){var n=t||{},r=n.dense?[]:{};return Mw(r,e,t)}function R5(e,t){return as(Bw(e,t),t)}function Cg(e){var t="",n=N5(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function N5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var F5=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ja({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return mt+t}}(),kg=function(){var e=function(s){return be(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,a){var l=[];l.push('      <table:table table:name="'+be(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=Cn(s["!ref"]||"A1"),f=s["!merges"]||[],p=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",w=s["!rows"]||[];for(c=0;c<h.s.r;++c)m=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=h.e.r;++c){for(m=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var _=!1,x={},y="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>u)&&!(f[p].s.r>c)&&!(f[p].e.c<u)&&!(f[p].e.r<c)){(f[p].s.c!=u||f[p].s.r!=c)&&(_=!0),x["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,x["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(_){l.push(n);continue}var I=Be({r:c,c:u}),O=g?(s[c]||[])[u]:s[I];if(O&&O.f&&(x["table:formula"]=be(QD(O.f)),O.F&&O.F.slice(0,I.length)==I)){var z=Cn(O.F);x["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,x["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!O){l.push(t);continue}switch(O.t){case"b":y=O.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=O.v?"true":"false";break;case"n":y=O.w||String(O.v||0),x["office:value-type"]="float",x["office:value"]=O.v||0;break;case"s":case"str":y=O.v==null?"":O.v,x["office:value-type"]="string";break;case"d":y=O.w||Zt(O.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Zt(O.v).toISOString(),x["table:style-name"]="ce1";break;default:l.push(t);continue}var N=e(y);if(O.l&&O.l.Target){var D=O.l.Target;D=D.charAt(0)=="#"?"#"+JD(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),N=Z("text:a",N,{"xlink:href":D.replace(/&/g,"&amp;")})}l.push("          "+Z("table:table-cell",Z("text:p",N,{}),x)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;lp(h),h.ods=a;var f=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[mt],c=ja({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=ja({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Z2().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(r(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function jw(e,t){if(t.bookType=="fods")return kg(e,t);var n=Qd(),r="",i=[],s=[];return r="mimetype",ye(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",ye(n,r,kg(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",ye(n,r,F5(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",ye(n,r,mt+Z2()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",ye(n,r,HF(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",ye(n,r,WF(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function qc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function O5(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Kn(Tr(e))}function D5(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function xi(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function P5(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function Ua(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Pe(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Xs(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function gt(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=Ua(e,n),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=n[0];e[n[0]++]>=128;);a=e.slice(l,n[0])}break;case 5:o=4,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=Ua(e,n),a=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function It(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Pe(r*8+i.type)),i.type==2&&t.push(Pe(i.data.length)),t.push(i.data))})}),xi(t)}function Wn(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=Ua(e,r),s=gt(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:Xs(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=gt(a.data),c=Xs(l[3][0].data);o.messages.push({meta:l,data:e.slice(r[0],r[0]+c)}),r[0]+=c}),(t=s[3])!=null&&t[0]&&(o.merge=Xs(s[3][0].data)>>>0>0),n.push(o)}return n}function gs(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Pe(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Pe(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Pe(o.data.length)}],r[2].push({data:It(o.meta),type:2})});var s=It(r);t.push(Pe(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),xi(t)}function L5(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Ua(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[n[0]],a>1&&(o|=t[n[0]+1]<<8),a>2&&(o|=t[n[0]+2]<<16),a>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=a}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(t[n[0]]>>2&7)+4,l=(t[n[0]++]&224)<<3,l|=t[n[0]++]):(c=(t[n[0]++]>>2)+1,s==2?(l=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(l=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[xi(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=xi(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function zn(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(L5(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return xi(t)}function xs(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=Pe(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return xi(t)}function Lf(e,t){var n=new Uint8Array(32),r=qc(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,P5(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function bf(e,t){var n=new Uint8Array(32),r=qc(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function Vr(e){var t=gt(e);return Ua(t[1][0].data)}function b5(e,t,n){var r,i,s,o;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Xs(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=qc(e[7][0].data),u=0,h=[],f=qc(e[4][0].data),p=0,g=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),f.setUint16(m*2,p,!0);var w,_;switch(typeof t[m]){case"string":w=Lf({t:"s",v:t[m]},n),_=bf({t:"s",v:t[m]},n);break;case"number":w=Lf({t:"n",v:t[m]},n),_=bf({t:"n",v:t[m]},n);break;case"boolean":w=Lf({t:"b",v:t[m]},n),_=bf({t:"b",v:t[m]},n);break;default:throw new Error("Unsupported value "+t[m])}h.push(w),u+=w.length,g.push(_),p+=_.length,++l}for(e[2][0].data=Pe(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return e[6][0].data=xi(h),e[3][0].data=xi(g),l}function M5(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Cn(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(pt(r)));var s=Qc(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(M){return M.forEach(function(T){typeof T=="string"&&o.push(T)})});var a={},l=[],c=Ue.read(t.numbers,{type:"base64"});c.FileIndex.map(function(M,T){return[M,c.FullPaths[T]]}).forEach(function(M){var T=M[0],R=M[1];if(T.type==2&&T.name.match(/\.iwa/)){var b=T.content,Y=zn(b),ne=Wn(Y);ne.forEach(function(ae){l.push(ae.id),a[ae.id]={deps:[],location:R,type:Xs(ae.messages[0].meta[1][0].data)}})}}),l.sort(function(M,T){return M-T});var u=l.filter(function(M){return M>1}).map(function(M){return[M,Pe(M)]});c.FileIndex.map(function(M,T){return[M,c.FullPaths[T]]}).forEach(function(M){var T=M[0];if(M[1],!!T.name.match(/\.iwa/)){var R=Wn(zn(T.content));R.forEach(function(b){b.messages.forEach(function(Y){u.forEach(function(ne){b.messages.some(function(ae){return Xs(ae.meta[1][0].data)!=11006&&D5(ae.data,ne[1])})&&a[ne[0]].deps.push(b.id)})})})}});for(var h=Ue.find(c,a[1].location),f=Wn(zn(h.content)),p,g=0;g<f.length;++g){var m=f[g];m.id==1&&(p=m)}var w=Vr(gt(p.messages[0].data)[1][0].data);for(h=Ue.find(c,a[w].location),f=Wn(zn(h.content)),g=0;g<f.length;++g)m=f[g],m.id==w&&(p=m);for(w=Vr(gt(p.messages[0].data)[2][0].data),h=Ue.find(c,a[w].location),f=Wn(zn(h.content)),g=0;g<f.length;++g)m=f[g],m.id==w&&(p=m);for(w=Vr(gt(p.messages[0].data)[2][0].data),h=Ue.find(c,a[w].location),f=Wn(zn(h.content)),g=0;g<f.length;++g)m=f[g],m.id==w&&(p=m);var _=gt(p.messages[0].data);{_[6][0].data=Pe(r.e.r+1),_[7][0].data=Pe(r.e.c+1);var x=Vr(_[46][0].data),y=Ue.find(c,a[x].location),I=Wn(zn(y.content));{for(var O=0;O<I.length&&I[O].id!=x;++O);if(I[O].id!=x)throw"Bad ColumnRowUIDMapArchive";var z=gt(I[O].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var N=0;N<=r.e.c;++N){var D=[];D[1]=D[2]=[{type:0,data:Pe(N+420690)}],z[1].push({type:2,data:It(D)}),z[2].push({type:0,data:Pe(N)}),z[3].push({type:0,data:Pe(N)})}z[4]=[],z[5]=[],z[6]=[];for(var L=0;L<=r.e.r;++L)D=[],D[1]=D[2]=[{type:0,data:Pe(L+726270)}],z[4].push({type:2,data:It(D)}),z[5].push({type:0,data:Pe(L)}),z[6].push({type:0,data:Pe(L)});I[O].messages[0].data=It(z)}y.content=xs(gs(I)),y.size=y.content.length,delete _[46];var P=gt(_[4][0].data);{P[7][0].data=Pe(r.e.r+1);var H=gt(P[1][0].data),K=Vr(H[2][0].data);y=Ue.find(c,a[K].location),I=Wn(zn(y.content));{if(I[0].id!=K)throw"Bad HeaderStorageBucket";var te=gt(I[0].messages[0].data);for(L=0;L<s.length;++L){var we=gt(te[2][0].data);we[1][0].data=Pe(L),we[4][0].data=Pe(s[L].length),te[2][L]={type:te[2][0].type,data:It(we)}}I[0].messages[0].data=It(te)}y.content=xs(gs(I)),y.size=y.content.length;var ve=Vr(P[2][0].data);y=Ue.find(c,a[ve].location),I=Wn(zn(y.content));{if(I[0].id!=ve)throw"Bad HeaderStorageBucket";for(te=gt(I[0].messages[0].data),N=0;N<=r.e.c;++N)we=gt(te[2][0].data),we[1][0].data=Pe(N),we[4][0].data=Pe(r.e.r+1),te[2][N]={type:te[2][0].type,data:It(we)};I[0].messages[0].data=It(te)}y.content=xs(gs(I)),y.size=y.content.length;var He=Vr(P[4][0].data);(function(){for(var M=Ue.find(c,a[He].location),T=Wn(zn(M.content)),R,b=0;b<T.length;++b){var Y=T[b];Y.id==He&&(R=Y)}var ne=gt(R.messages[0].data);{ne[3]=[];var ae=[];o.forEach(function(pe,je){ae[1]=[{type:0,data:Pe(je)}],ae[2]=[{type:0,data:Pe(1)}],ae[3]=[{type:2,data:O5(pe)}],ne[3].push({type:2,data:It(ae)})})}R.messages[0].data=It(ne);var ie=gs(T),ge=xs(ie);M.content=ge,M.size=M.content.length})();var We=gt(P[3][0].data);{var se=We[1][0];delete We[2];var de=gt(se.data);{var me=Vr(de[2][0].data);(function(){for(var M=Ue.find(c,a[me].location),T=Wn(zn(M.content)),R,b=0;b<T.length;++b){var Y=T[b];Y.id==me&&(R=Y)}var ne=gt(R.messages[0].data);{delete ne[6],delete We[7];var ae=new Uint8Array(ne[5][0].data);ne[5]=[];for(var ie=0,ge=0;ge<=r.e.r;++ge){var pe=gt(ae);ie+=b5(pe,s[ge],o),pe[1][0].data=Pe(ge),ne[5].push({data:It(pe),type:2})}ne[1]=[{type:0,data:Pe(r.e.c+1)}],ne[2]=[{type:0,data:Pe(r.e.r+1)}],ne[3]=[{type:0,data:Pe(ie)}],ne[4]=[{type:0,data:Pe(r.e.r+1)}]}R.messages[0].data=It(ne);var je=gs(T),Ne=xs(je);M.content=Ne,M.size=M.content.length})()}se.data=It(de)}P[3][0].data=It(We)}_[4][0].data=It(P)}p.messages[0].data=It(_);var Se=gs(f),F=xs(Se);return h.content=F,h.size=h.content.length,c}function B5(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function dp(e){B5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function j5(e,t){return t.bookType=="ods"?jw(e,t):t.bookType=="numbers"?M5(e,t):t.bookType=="xlsb"?U5(e,t):W5(e,t)}function U5(e,t){Ds=1024,e&&!e.SSF&&(e.SSF=pn(lt)),e&&e.SSF&&(Ru(),Iu(e.SSF),t.revssf=Nu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,la?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=ww.indexOf(t.bookType)>-1,i=q2();dp(t=t||{});var s=Qd(),o="",a=0;if(t.cellXfs=[],Ei(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ye(s,o,ew(e.Props,t)),i.coreprops.push(o),Le(t.rels,2,o,Fe.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,ye(s,o,nw(e.Props)),i.extprops.push(o),Le(t.rels,3,o,Fe.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ye(s,o,rw(e.Custprops)),i.custprops.push(o),Le(t.rels,4,o,Fe.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},h=e.Sheets[e.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,ye(s,o,H8(a-1,o,t,e,u)),i.sheets.push(o),Le(t.wbrels,-1,"worksheets/sheet"+a+"."+n,Fe.WS[0])}if(h){var p=h["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+a+"."+n,ye(s,m,G8(p,m)),i.comments.push(m),Le(u,-1,"../comments"+a+"."+n,Fe.CMNT),g=!0),h["!legacy"]&&g&&ye(s,"xl/drawings/vmlDrawing"+a+".vml",_w(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&ye(s,J2(o),Gs(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,ye(s,o,$8(t.Strings,o,t)),i.strs.push(o),Le(t.wbrels,-1,"sharedStrings."+n,Fe.SST)),o="xl/workbook."+n,ye(s,o,z8(e,o)),i.workbooks.push(o),Le(t.rels,1,o,Fe.WB),o="xl/theme/theme1.xml",ye(s,o,xw(e.Themes,t)),i.themes.push(o),Le(t.wbrels,-1,"theme/theme1.xml",Fe.THEME),o="xl/styles."+n,ye(s,o,V8(e,o,t)),i.styles.push(o),Le(t.wbrels,-1,"styles."+n,Fe.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",ye(s,o,e.vbaraw),i.vba.push(o),Le(t.wbrels,-1,"vbaProject.bin",Fe.VBA)),o="xl/metadata."+n,ye(s,o,K8(o)),i.metadata.push(o),Le(t.wbrels,-1,"metadata."+n,Fe.XLMETA),ye(s,"[Content_Types].xml",Q2(i,t)),ye(s,"_rels/.rels",Gs(t.rels)),ye(s,"xl/_rels/workbook."+n+".rels",Gs(t.wbrels)),delete t.revssf,delete t.ssf,s}function W5(e,t){Ds=1024,e&&!e.SSF&&(e.SSF=pn(lt)),e&&e.SSF&&(Ru(),Iu(e.SSF),t.revssf=Nu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,la?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=ww.indexOf(t.bookType)>-1,i=q2();dp(t=t||{});var s=Qd(),o="",a=0;if(t.cellXfs=[],Ei(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ye(s,o,ew(e.Props,t)),i.coreprops.push(o),Le(t.rels,2,o,Fe.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,ye(s,o,nw(e.Props)),i.extprops.push(o),Le(t.rels,3,o,Fe.EXT_PROPS),e.Custprops!==e.Props&&Bt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ye(s,o,rw(e.Custprops)),i.custprops.push(o),Le(t.rels,4,o,Fe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var h={"!id":{}},f=e.Sheets[e.SheetNames[a-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+a+"."+n,ye(s,o,Nw(a-1,t,e,h)),i.sheets.push(o),Le(t.wbrels,-1,"worksheets/sheet"+a+"."+n,Fe.WS[0])}if(f){var g=f["!comments"],m=!1,w="";if(g&&g.length>0){var _=!1;g.forEach(function(x){x[1].forEach(function(y){y.T==!0&&(_=!0)})}),_&&(w="xl/threadedComments/threadedComment"+a+"."+n,ye(s,w,vO(g,u,t)),i.threadedcomments.push(w),Le(h,-1,"../threadedComments/threadedComment"+a+"."+n,Fe.TCMNT)),w="xl/comments"+a+"."+n,ye(s,w,yw(g)),i.comments.push(w),Le(h,-1,"../comments"+a+"."+n,Fe.CMNT),m=!0}f["!legacy"]&&m&&ye(s,"xl/drawings/vmlDrawing"+a+".vml",_w(a,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&ye(s,J2(o),Gs(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,ye(s,o,fw(t.Strings,t)),i.strs.push(o),Le(t.wbrels,-1,"sharedStrings."+n,Fe.SST)),o="xl/workbook."+n,ye(s,o,Dw(e)),i.workbooks.push(o),Le(t.rels,1,o,Fe.WB),o="xl/theme/theme1.xml",ye(s,o,xw(e.Themes,t)),i.themes.push(o),Le(t.wbrels,-1,"theme/theme1.xml",Fe.THEME),o="xl/styles."+n,ye(s,o,mw(e,t)),i.styles.push(o),Le(t.wbrels,-1,"styles."+n,Fe.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",ye(s,o,e.vbaraw),i.vba.push(o),Le(t.wbrels,-1,"vbaProject.bin",Fe.VBA)),o="xl/metadata."+n,ye(s,o,vw()),i.metadata.push(o),Le(t.wbrels,-1,"metadata."+n,Fe.XLMETA),u.length>1&&(o="xl/persons/person.xml",ye(s,o,_O(u)),i.people.push(o),Le(t.wbrels,-1,"persons/person.xml",Fe.PEOPLE)),ye(s,"[Content_Types].xml",Q2(i,t)),ye(s,"_rels/.rels",Gs(t.rels)),ye(s,"xl/_rels/workbook."+n+".rels",Gs(t.wbrels)),delete t.revssf,delete t.ssf,s}function z5(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Mr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function Uw(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return el(t.file,Ue.write(e,{type:Oe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ue.write(e,t)}function H5(e,t){var n=pn(t||{}),r=j5(e,n);return V5(r,n)}function V5(e,t){var n={},r=Oe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ue.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Au(i))}return t.password&&typeof encrypt_agile<"u"?Uw(encrypt_agile(i,t.password),t):t.type==="file"?el(t.file,i):t.type=="string"?ia(i):i}function $5(e,t){var n=t||{},r=a5(e,n);return Uw(r,n)}function or(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Ma(Tr(r));case"binary":return Tr(r);case"string":return e;case"file":return el(t.file,r,"utf8");case"buffer":return Oe?zr(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):or(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function G5(e,t){switch(t.type){case"base64":return Ma(e);case"binary":return e;case"string":return e;case"file":return el(t.file,e,"binary");case"buffer":return Oe?zr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?Ma(n):t.type=="string"?ia(n):n;case"file":return el(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function pp(e,t){_N(),F8(e);var n=pn(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=pp(e,n);return n.type="array",Au(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return or(s5(e,n),n);case"slk":case"sylk":return or(I6.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return or(bw(e.Sheets[e.SheetNames[i]],n),n);case"txt":return G5(Ww(e.Sheets[e.SheetNames[i]],n),n);case"csv":return or(mp(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return or(R6.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return bl(A6.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return or(N6.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return or(M6.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return or(uw.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return or(jw(e,n),n);case"wk1":return bl(_g.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return bl(_g.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),bl(Lw(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),$5(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return H5(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function K5(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function X5(e,t,n){var r=n||{};return r.type="file",r.file=t,K5(r),pp(e,r)}function Y5(e,t,n,r,i,s,o,a){var l=bt(n),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,f=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch{f.__rowNum__=n}else f.__rowNum__=n;if(!o||e[n])for(var p=t.s.c;p<=t.e.c;++p){var g=o?e[n][p]:e[r[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[p]!=null&&(f[s[p]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[p]!=null){if(m==null)if(g.t=="e"&&m===null)f[s[p]]=null;else if(c!==void 0)f[s[p]]=c;else if(u&&m===null)f[s[p]]=null;else continue;else f[s[p]]=u&&(g.t!=="n"||g.t==="n"&&a.rawNumbers!==!1)?m:Br(g,m,a);m!=null&&(h=!1)}}return{row:f,isempty:h}}function Qc(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=qe(u);break;case"number":l=qe(e["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var h=bt(l.s.r),f=[],p=[],g=0,m=0,w=Array.isArray(e),_=l.s.r,x=0,y={};w&&!e[_]&&(e[_]=[]);var I=c.skipHidden&&e["!cols"]||[],O=c.skipHidden&&e["!rows"]||[];for(x=l.s.c;x<=l.e.c;++x)if(!(I[x]||{}).hidden)switch(f[x]=Vt(x),n=w?e[_][x]:e[f[x]+h],r){case 1:s[x]=x-l.s.c;break;case 2:s[x]=f[x];break;case 3:s[x]=c.header[x-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=o=Br(n,null,c),m=y[o]||0,!m)y[o]=1;else{do a=o+"_"+m++;while(y[a]);y[o]=m,y[a]=1}s[x]=a}for(_=l.s.r+i;_<=l.e.r;++_)if(!(O[_]||{}).hidden){var z=Y5(e,l,_,f,r,s,w,c);(z.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=z.row)}return p.length=g,p}var Ag=/"/g;function q5(e,t,n,r,i,s,o,a){for(var l=!0,c=[],u="",h=bt(n),f=t.s.c;f<=t.e.c;++f)if(r[f]){var p=a.dense?(e[n]||[])[f]:e[r[f]+h];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(a.rawNumbers&&p.t=="n"?p.v:Br(p,null,a));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===i||m===s||m===34||a.forceQuotes){u='"'+u.replace(Ag,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(Ag,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function mp(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=qe(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];r.dense=Array.isArray(e);for(var f=r.skipHidden&&e["!cols"]||[],p=r.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(f[g]||{}).hidden||(h[g]=Vt(g));for(var m=0,w=i.s.r;w<=i.e.r;++w)(p[w]||{}).hidden||(u=q5(e,i,w,h,o,l,s,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&n.push((m++?a:"")+u)));return delete r.dense,n.join("")}function Ww(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=mp(e,t);return n}function Q5(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=qe(e["!ref"]),s="",o=[],a,l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=Vt(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=bt(u),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+s,n=c?(e[u]||[])[a]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=t+"="+r}return l}function zw(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},o=0,a=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var l=typeof r.origin=="string"?Ct(r.origin):r.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var h=qe(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+t.length-1+i)}else o==-1&&(o=0,u.e.r=t.length-1+i);var f=r.header||[],p=0;t.forEach(function(m,w){Bt(m).forEach(function(_){(p=f.indexOf(_))==-1&&(f[p=f.length]=_);var x=m[_],y="z",I="",O=Be({c:a+p,r:o+w+i});c=Wa(s,O),x&&typeof x=="object"&&!(x instanceof Date)?s[O]=x:(typeof x=="number"?y="n":typeof x=="boolean"?y="b":typeof x=="string"?y="s":x instanceof Date?(y="d",r.cellDates||(y="n",x=dn(x)),I=r.dateNF||lt[14]):x===null&&r.nullError&&(y="e",x=0),c?(c.t=y,c.v=x,delete c.w,delete c.R,I&&(c.z=I)):s[O]=c={t:y,v:x},I&&(c.z=I))})}),u.e.c=Math.max(u.e.c,a+f.length-1);var g=bt(o);if(i)for(p=0;p<f.length;++p)s[Vt(p+a)+g]={t:"s",v:f[p]};return s["!ref"]=pt(u),s}function J5(e,t){return zw(null,e,t)}function Wa(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=Ct(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Wa(e,Be(t)):Wa(e,Be({r:t,c:n||0}))}function Z5(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function eL(){return{SheetNames:[],Sheets:{}}}function tL(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if(Ow(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function nL(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=Z5(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function rL(e,t){return e.z=t,e}function Hw(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function iL(e,t,n){return Hw(e,"#"+t,n)}function sL(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function oL(e,t,n,r){for(var i=typeof t!="string"?t:qe(t),s=typeof t=="string"?t:pt(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=Wa(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return e}var vs={encode_col:Vt,encode_row:bt,encode_cell:Be,encode_range:pt,decode_col:rp,decode_row:np,split_cell:yF,decode_cell:Ct,decode_range:Cn,format_cell:Br,sheet_add_aoa:V2,sheet_add_json:zw,sheet_add_dom:Mw,aoa_to_sheet:xo,json_to_sheet:J5,table_to_sheet:Bw,table_to_book:R5,sheet_to_csv:mp,sheet_to_txt:Ww,sheet_to_json:Qc,sheet_to_html:bw,sheet_to_formulae:Q5,sheet_to_row_object_array:Qc,sheet_get_cell:Wa,book_new:eL,book_append_sheet:tL,book_set_sheet_visibility:nL,cell_set_number_format:rL,cell_set_hyperlink:Hw,cell_set_internal_link:iL,cell_add_comment:sL,sheet_set_array_formula:oL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};class sl{constructor(t=0,n="Network Error"){this.status=t,this.text=n}}const aL=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},Ot={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:aL()},gp=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},lL=(e,t="https://api.emailjs.com")=>{if(!e)return;const n=gp(e);Ot.publicKey=n.publicKey,Ot.blockHeadless=n.blockHeadless,Ot.storageProvider=n.storageProvider,Ot.blockList=n.blockList,Ot.limitRate=n.limitRate,Ot.origin=n.origin||t},Vw=async(e,t,n={})=>{const r=await fetch(Ot.origin+e,{method:"POST",headers:n,body:t}),i=await r.text(),s=new sl(r.status,i);if(r.ok)return s;throw s},$w=(e,t,n)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n||typeof n!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},cL=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},Gw=e=>e.webdriver||!e.languages||e.languages.length===0,Kw=()=>new sl(451,"Unavailable For Headless Browser"),uL=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},fL=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},hL=(e,t)=>e instanceof FormData?e.get(t):e[t],Xw=(e,t)=>{if(fL(e))return!1;uL(e.list,e.watchVariable);const n=hL(t,e.watchVariable);return typeof n!="string"?!1:e.list.includes(n)},Yw=()=>new sl(403,"Forbidden"),dL=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},pL=async(e,t,n)=>{const r=Number(await n.get(e)||0);return t-Date.now()+r},qw=async(e,t,n)=>{if(!t.throttle||!n)return!1;dL(t.throttle,t.id);const r=t.id||e;return await pL(r,t.throttle,n)>0?!0:(await n.set(r,Date.now().toString()),!1)},Qw=()=>new sl(429,"Too Many Requests"),mL=async(e,t,n,r)=>{const i=gp(r),s=i.publicKey||Ot.publicKey,o=i.blockHeadless||Ot.blockHeadless,a=i.storageProvider||Ot.storageProvider,l={...Ot.blockList,...i.blockList},c={...Ot.limitRate,...i.limitRate};return o&&Gw(navigator)?Promise.reject(Kw()):($w(s,e,t),cL(n),n&&Xw(l,n)?Promise.reject(Yw()):await qw(location.pathname,c,a)?Promise.reject(Qw()):Vw("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:e,template_id:t,template_params:n}),{"Content-type":"application/json"}))},gL=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},xL=e=>typeof e=="string"?document.querySelector(e):e,vL=async(e,t,n,r)=>{const i=gp(r),s=i.publicKey||Ot.publicKey,o=i.blockHeadless||Ot.blockHeadless,a=Ot.storageProvider||i.storageProvider,l={...Ot.blockList,...i.blockList},c={...Ot.limitRate,...i.limitRate};if(o&&Gw(navigator))return Promise.reject(Kw());const u=xL(n);$w(s,e,t),gL(u);const h=new FormData(u);return Xw(l,h)?Promise.reject(Yw()):await qw(location.pathname,c,a)?Promise.reject(Qw()):(h.append("lib_version","4.4.1"),h.append("service_id",e),h.append("template_id",t),h.append("user_id",s),Vw("/api/v1.0/email/send-form",h))},Ig={init:lL,send:mL,sendForm:vL,EmailJSResponseStatus:sl},_L=()=>{const[e,t]=ce.useState(!1),[n,r]=ce.useState(""),[i,s]=ce.useState([]),[o,a]=ce.useState([]),[l,c]=ce.useState(""),[u,h]=ce.useState({groomName:"",brideName:"",date:"2026. 11. 21.()  4 40",message:`"  , 
   ."`,locationName:" ",locationAddress:"   103-18",mainImageOpacity:.6,heroTextColor:"#333333",heroTitleFontSize:32,heroDateFontSize:18,heroMessageFontSize:16,heroFontFamily:"",shareTitle:"&  ",shareDesc:"2026 11 21,   .",shareImage:"",groomImage:"",brideImage:"",groomIntro:` ..
  000.`,brideIntro:` ..
  000.`,groomHashtags:"# # #ISFJ",brideHashtags:"# # #ENFP",groomBirth:"1993. 02. 04.",brideBirth:"1998. 01. 18.",groomRegion:" ",brideRegion:" ",closingImageOpacity:.6,closingTextColor:"#333333",closingTextWeight:"normal",closingTextPosition:"center"}),[f,p]=ce.useState({primaryColor:"#333333",pointColor:"#ff9090",fontFamily:"'Apple SD Gothic Neo', sans-serif"}),[g,m]=ce.useState({groom:[{bank:"",accountNumber:"123-456789-12-345",name:""}],bride:[{bank:"",accountNumber:"1002-123-456789",name:""}]}),[w,_]=ce.useState({groom:[{relation:"father",name:"",phone:"010-0000-0000"},{relation:"mother",name:"",phone:"010-0000-0000"}],bride:[{relation:"father",name:"",phone:"010-0000-0000"},{relation:"mother",name:"",phone:"010-0000-0000"}]});ce.useEffect(()=>{const T=Ae(Ie,"guests"),R=Ae(Ie,"gallery_images"),b=Ae(Ie,"wedding_info"),Y=Ae(Ie,"wedding_design"),ne=Ae(Ie,"wedding_accounts"),ae=Ae(Ie,"wedding_contacts"),ie=Ae(Ie,".info/connected");tt(ie,ge=>{ge.val()===!0?console.log("connected"):console.log("not connected")}),tt(T,ge=>{const pe=ge.val();s(pe||[])}),tt(R,ge=>{const pe=ge.val();a(pe||[])}),tt(b,ge=>{const pe=ge.val();pe&&h(je=>({...je,...pe}))}),tt(Y,ge=>{const pe=ge.val();pe&&p(je=>({...je,...pe}))}),tt(ne,ge=>{const pe=ge.val();pe&&m(je=>({...je,...pe}))}),tt(ae,ge=>{const pe=ge.val();pe&&_(je=>({...je,...pe}))})},[]);const x=T=>{T.preventDefault(),n==="ljoshs8524"?t(!0):alert("  .")},y=T=>{const{name:R,value:b}=T.target;p(Y=>({...Y,[R]:b}))},I=()=>{xn(Ae(Ie,"wedding_design"),f).then(()=>alert("  . ( )")).catch(T=>alert(" : "+T.message))},O=T=>{const{name:R,value:b}=T.target;h(Y=>({...Y,[R]:b}))},z=()=>{xn(Ae(Ie,"wedding_info"),u).then(()=>alert("  . ( )")).catch(T=>alert(" : "+T.message))},N=(T,R,b,Y)=>{const ne=[...g[T]];ne[R]={...ne[R],[b]:Y},m({...g,[T]:ne})},D=T=>{if(g[T].length>=3){alert(" 3  .");return}const R=[...g[T],{bank:"",accountNumber:"",name:""}];m({...g,[T]:R})},L=(T,R)=>{const b=g[T].filter((Y,ne)=>ne!==R);m({...g,[T]:b})},P=()=>{xn(Ae(Ie,"wedding_accounts"),g).then(()=>alert("  . ( )")).catch(T=>alert(" : "+T.message))},H=T=>T.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(\-{1,2})$/g,""),K=(T,R,b,Y)=>{const ne=[...w[T]];b==="phone"&&(Y=H(Y)),ne[R]={...ne[R],[b]:Y},_({...w,[T]:ne})},te=T=>{if(w[T].length>=7){alert(" 7  .");return}const R=[...w[T],{relation:"father",name:"",phone:""}];_({...w,[T]:R})},we=(T,R)=>{const b=w[T].filter((Y,ne)=>ne!==R);_({...w,[T]:b})},ve=()=>{xn(Ae(Ie,"wedding_contacts"),w).then(()=>alert("  . ( )")).catch(T=>alert(" : "+T.message))},[He,We]=ce.useState("nu990524@gmail.com"),se=async()=>{if(i.length===0){alert(" .");return}if(window.confirm(`${He}    ?`))try{Ig.init("0l5kY7nMpwoY2RbrH");const T=vs.json_to_sheet(i),R=vs.book_new();vs.book_append_sheet(R,T,"Guests");const b=pp(R,{bookType:"xlsx",type:"array"}),Y=new Blob([b],{type:"application/octet-stream"});let ne="",ae="";try{const ge=MI(uN,`rsvp_lists/wedding_guests_${Date.now()}.xlsx`),pe=await LI(ge,Y);ne=await bI(pe.ref),ae=`
RSVP    .
   :

${ne}

( ${i.reduce((je,Ne)=>je+Ne.count,0)} /  ${i.length})
                `.trim()}catch(ge){console.error("Storage Error:",ge),ae=`
RSVP  .
     (  ).
    'Excel ' .

 : ${window.location.href}

( ${i.reduce((pe,je)=>pe+je.count,0)} /  ${i.length})
                `.trim(),alert("   (Storage ),     .")}const ie={subject:`[] RSVP  (${new Date().toLocaleDateString()})`,message:ae,to_email:He};await Ig.send("service_l43aylp","template_v9ktges",ie),alert(`  !
: ${He}`)}catch(T){console.error("Email Failed:",T),alert(`  : ${T.message}`);const R=vs.json_to_sheet(i),b=vs.book_new();vs.book_append_sheet(b,R,"Guests"),X5(b,"wedding_guests.xlsx")}},de=()=>{window.confirm(" RSVP () ?   .")&&xn(Ae(Ie,"guests"),[]).then(()=>s([])).catch(T=>alert(" : "+T.message))},me=()=>{if(!l)return;const T=[...o,l];a(T),xn(Ae(Ie,"gallery_images"),T).catch(R=>alert(" : "+R.message)),c("")},Se=T=>{if(window.confirm("  ?")){const R=o.filter((b,Y)=>Y!==T);a(R),xn(Ae(Ie,"gallery_images"),R).catch(b=>alert(" : "+b.message))}},F=T=>new Promise(R=>{const b=new FileReader;b.readAsDataURL(T),b.onload=Y=>{const ne=new Image;ne.src=Y.target.result,ne.onload=()=>{const ae=document.createElement("canvas"),ie=1200;let ge=ne.width,pe=ne.height;ge>ie&&(pe*=ie/ge,ge=ie),ae.width=ge,ae.height=pe,ae.getContext("2d").drawImage(ne,0,0,ge,pe),R(ae.toDataURL("image/jpeg",.7))}}}),M=async(T,R)=>{const b=T.target.files[0];if(b)try{const Y=await F(b);if(R==="gallery"){const ne=[...o,Y];xn(Ae(Ie,"gallery_images"),ne).then(()=>a(ne)).catch(ae=>alert(" : "+ae.message))}else h(ne=>({...ne,[R]:Y}))}catch(Y){console.error("Compression failed:",Y),alert("    .")}};return e?d.jsxs("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto",paddingBottom:"100px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("h2",{children:" "}),d.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[d.jsx("span",{style:{fontSize:"12px",padding:"5px 10px",borderRadius:"15px",backgroundColor:"#e0ffe0",color:"#006600",border:"1px solid #00cc00"},children:"  "}),d.jsx("a",{href:"/",className:"btn",children:"< "})]})]}),d.jsxs("section",{style:{marginTop:"20px"},children:[d.jsx("h3",{children:"  "}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",border:"1px solid #87CEEB"},children:[d.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:[d.jsxs("div",{children:[d.jsx("label",{children:"  "}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("input",{type:"color",name:"primaryColor",value:f.primaryColor.startsWith("#")?f.primaryColor:"#000000",onChange:y}),d.jsx("input",{type:"text",name:"primaryColor",value:f.primaryColor,onChange:y,style:{width:"100px",margin:0,padding:"5px"},placeholder:"#000000 or RGB"})]})]}),d.jsxs("div",{children:[d.jsx("label",{children:"  ( )"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[d.jsx("input",{type:"color",name:"pointColor",value:f.pointColor.startsWith("#")?f.pointColor:"#ff9090",onChange:y}),d.jsx("input",{type:"text",name:"pointColor",value:f.pointColor,onChange:y,style:{width:"100px",margin:0,padding:"5px"},placeholder:"#ff9090 or RGB"})]})]})]}),d.jsx("label",{style:{marginTop:"15px",display:"block"},children:" "}),d.jsxs("select",{name:"fontFamily",value:f.fontFamily,onChange:y,children:[d.jsx("option",{value:"'Apple SD Gothic Neo', sans-serif",children:"  ()"}),d.jsx("option",{value:"'Nanum Myeongjo', serif",children:"  ()"}),d.jsx("option",{value:"'Gowun Dodum', sans-serif",children:"  ()"})]}),d.jsx("div",{style:{marginTop:"15px"},children:d.jsx("button",{onClick:I,className:"btn btn-point",children:" "})})]})]}),d.jsxs("section",{style:{marginTop:"20px"},children:[d.jsx("h3",{children:"0.   "}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",border:"1px solid #87CEEB"},children:[d.jsx("label",{children:" "}),d.jsx("input",{name:"groomName",value:u.groomName,onChange:O}),d.jsx("label",{children:" "}),d.jsx("input",{name:"brideName",value:u.brideName,onChange:O}),d.jsx("label",{children:"/ ()"}),d.jsx("input",{name:"date",value:u.date,onChange:O,placeholder:": 2026. 11. 21.()  4 40"}),d.jsx("label",{children:" "}),d.jsx("input",{name:"locationName",value:u.locationName||"",onChange:O,placeholder:": "}),d.jsx("label",{children:" "}),d.jsx("textarea",{name:"message",value:u.message,onChange:O,rows:4,style:{width:"100%",marginBottom:"15px"}}),d.jsxs("div",{style:{backgroundColor:"#f0f0f0",padding:"10px",borderRadius:"4px",marginBottom:"15px"},children:[d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("strong",{children:"  "})," (",u.mainImageOpacity||.6,")"]}),d.jsx("input",{type:"range",name:"mainImageOpacity",min:"0.1",max:"1.0",step:"0.1",value:u.mainImageOpacity||.6,onChange:O,style:{width:"100%",cursor:"pointer",accentColor:"#333"}})]}),d.jsx("label",{children:"  ()"}),d.jsxs("div",{style:{marginBottom:"10px"},children:[u.mainImage&&d.jsx("img",{src:u.mainImage,alt:"Main Preview",style:{width:"100%",maxWidth:"200px",display:"block",marginBottom:"5px",opacity:u.mainImageOpacity||.6}}),d.jsxs("div",{style:{display:"flex",gap:"5px"},children:[d.jsx("input",{name:"mainImage",value:u.mainImage||"",onChange:O,placeholder:"  URL",style:{flex:1,margin:0}}),d.jsxs("label",{className:"btn",style:{padding:"10px",margin:0,fontSize:"14px",cursor:"pointer",backgroundColor:"#666"},children:[" ",d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:T=>M(T,"mainImage")})]})]})]}),d.jsxs("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"2px solid #eee",position:"relative",zIndex:10,backgroundColor:"#fff"},children:[d.jsx("h4",{style:{marginBottom:"15px",color:"#333"},children:"   "}),d.jsx("label",{children:" "}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"10px"},children:[d.jsx("input",{type:"color",name:"heroTextColor",value:u.heroTextColor&&u.heroTextColor.startsWith("#")?u.heroTextColor:"#333333",onChange:O}),d.jsx("input",{type:"text",name:"heroTextColor",value:u.heroTextColor||"#333333",onChange:O,style:{width:"100px",margin:0,padding:"5px"},placeholder:"#333333 or RGB"})]}),d.jsx("label",{children:"  (   )"}),d.jsxs("select",{name:"heroFontFamily",value:u.heroFontFamily||"",onChange:O,style:{marginBottom:"10px"},children:[d.jsx("option",{value:"",children:"  "}),d.jsx("option",{value:"'Nanum Myeongjo', serif",children:"  ()"}),d.jsx("option",{value:"'Gowun Dodum', sans-serif",children:"  ()"}),d.jsx("option",{value:"'Sunflower', sans-serif",children:" ()"}),d.jsx("option",{value:"'Black Han Sans', sans-serif",children:" ()"}),d.jsx("option",{value:"'Pinyon Script', cursive",children:"  (Pinyon)"})]}),d.jsxs("label",{children:["  (",u.heroTitleFontSize||32,"px)"]}),d.jsx("input",{type:"range",name:"heroTitleFontSize",min:"20",max:"60",value:u.heroTitleFontSize||32,onChange:O,style:{width:"100%"}}),d.jsxs("label",{children:["  (",u.heroDateFontSize||18,"px)"]}),d.jsx("input",{type:"range",name:"heroDateFontSize",min:"12",max:"30",value:u.heroDateFontSize||18,onChange:O,style:{width:"100%"}}),d.jsxs("label",{children:["  (",u.heroMessageFontSize||16,"px)"]}),d.jsx("input",{type:"range",name:"heroMessageFontSize",min:"12",max:"24",value:u.heroMessageFontSize||16,onChange:O,style:{width:"100%"}})]}),d.jsxs("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"2px solid #eee",backgroundColor:"#fff"},children:[d.jsx("h4",{style:{marginBottom:"15px",color:"#333"},children:"    ( )"}),d.jsx("label",{children:" / (, )"}),d.jsx("textarea",{name:"invitationPoem",value:u.invitationPoem||"",onChange:O,rows:5,style:{width:"100%",marginBottom:"15px"},placeholder:"    "}),d.jsx("label",{children:" "}),d.jsx("input",{name:"invitationTitle",value:u.invitationTitle||"",onChange:O,placeholder:":   .",style:{width:"100%",marginBottom:"15px"}}),d.jsx("label",{children:"  ()"}),d.jsx("textarea",{name:"invitationBody",value:u.invitationBody||"",onChange:O,rows:6,style:{width:"100%"},placeholder:"  "})]}),d.jsx("label",{style:{marginTop:"20px",display:"block"},children:""}),d.jsx("input",{name:"locationAddress",value:u.locationAddress||"",onChange:O,placeholder:":  ..."}),d.jsx("label",{children:"/ "}),d.jsxs("div",{style:{marginBottom:"10px"},children:[u.mapImage&&d.jsx("img",{src:u.mapImage,alt:"Map Preview",style:{width:"100%",maxWidth:"200px",display:"block",marginBottom:"5px"}}),d.jsxs("div",{style:{display:"flex",gap:"5px"},children:[d.jsx("input",{name:"mapImage",value:u.mapImage||"",onChange:O,placeholder:"  URL",style:{flex:1,margin:0}}),d.jsxs("label",{className:"btn",style:{padding:"10px",margin:0,fontSize:"14px",cursor:"pointer",backgroundColor:"#666"},children:[" ",d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:T=>M(T,"mapImage")})]})]})]}),d.jsx("label",{style:{marginTop:"15px",display:"block"},children:d.jsx("strong",{children:"/ "})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[d.jsx("input",{name:"linkTmap",value:u.linkTmap||"",onChange:O,placeholder:"T-Map  URL"}),d.jsx("input",{name:"linkKakao",value:u.linkKakao||"",onChange:O,placeholder:"  URL"}),d.jsx("input",{name:"linkNaver",value:u.linkNaver||"",onChange:O,placeholder:"  URL"})]}),d.jsx("label",{style:{marginTop:"15px",display:"block"},children:d.jsx("strong",{children:"  (  )"})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"5px"},children:[d.jsx("textarea",{name:"trafficSubway",value:u.trafficSubway||"",onChange:O,placeholder:"  (: 1  1 )",rows:2,style:{width:"100%"}}),d.jsx("textarea",{name:"trafficBus",value:u.trafficBus||"",onChange:O,placeholder:"  (: 10, 28, 62 )",rows:2,style:{width:"100%"}}),d.jsx("textarea",{name:"trafficParking",value:u.trafficParking||"",onChange:O,placeholder:"  (:  1 ~ 6  )",rows:2,style:{width:"100%"}})]}),d.jsx("label",{style:{marginTop:"30px",display:"block"},children:d.jsx("strong",{children:"SNS   (/)"})}),d.jsxs("div",{style:{backgroundColor:"#eef",padding:"10px",borderRadius:"4px",marginBottom:"10px"},children:[d.jsxs("p",{style:{fontSize:"12px",color:"#666",marginBottom:"10px"},children:["* :   , /  ",d.jsx("strong",{children:"()"}),"      .",d.jsx("br",{}),"*    ",d.jsx("a",{href:"https://developers.kakao.com/tool/clear/og",target:"_blank",rel:"noreferrer",children:"  "}),"  ."]}),d.jsx("label",{children:" "}),d.jsx("input",{name:"shareTitle",value:u.shareTitle||"",onChange:O,placeholder:": & "}),d.jsx("label",{children:" "}),d.jsx("input",{name:"shareDesc",value:u.shareDesc||"",onChange:O,placeholder:": 2026 11 21..."}),d.jsx("label",{children:"  "}),d.jsxs("div",{style:{marginBottom:"10px"},children:[u.shareImage&&d.jsx("img",{src:u.shareImage,alt:"Share Preview",style:{width:"100px",height:"100px",objectFit:"cover",display:"block",marginBottom:"5px"}}),d.jsxs("div",{style:{display:"flex",gap:"5px"},children:[d.jsx("input",{name:"shareImage",value:u.shareImage||"",onChange:O,placeholder:"  URL",style:{flex:1,margin:0}}),d.jsxs("label",{className:"btn",style:{padding:"10px",margin:0,fontSize:"14px",cursor:"pointer",backgroundColor:"#666"},children:[" ",d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:T=>{const R=T.target.files[0];if(R){const b=new FileReader;b.onloadend=()=>{h(Y=>({...Y,shareImage:b.result}))},b.readAsDataURL(R)}}})]})]})]})]}),d.jsx("button",{onClick:z,className:"btn btn-point",style:{marginTop:"10px"},children:" "})]})]}),d.jsx("hr",{style:{margin:"40px 0",border:"0",borderTop:"1px dashed #ccc"}}),d.jsxs("section",{style:{marginTop:"20px"},children:[d.jsx("h3",{children:"  &   "}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",border:"1px solid #87CEEB"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[d.jsxs("div",{style:{padding:"10px",backgroundColor:"#f9f9f9",borderRadius:"8px"},children:[d.jsxs("h4",{style:{marginBottom:"10px",color:"#555"},children:["  (",u.groomName,")"]}),d.jsx("label",{children:" "}),d.jsxs("div",{style:{marginBottom:"10px"},children:[u.groomImage&&d.jsx("img",{src:u.groomImage,alt:"Groom",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"50%",display:"block",marginBottom:"5px"}}),d.jsxs("div",{style:{display:"flex",gap:"5px"},children:[d.jsx("input",{name:"groomImage",value:u.groomImage||"",onChange:O,placeholder:" URL",style:{flex:1,minWidth:0}}),d.jsxs("label",{className:"btn",style:{padding:"5px 10px",margin:0,fontSize:"12px",cursor:"pointer",backgroundColor:"#666"},children:["",d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:T=>M(T,"groomImage")})]})]})]}),d.jsx("label",{children:" (: 1993. 02. 04.)"}),d.jsx("input",{name:"groomBirth",value:u.groomBirth||"",onChange:O,placeholder:"1993. 02. 04."}),d.jsx("label",{children:" (:  )"}),d.jsx("input",{name:"groomRegion",value:u.groomRegion||"",onChange:O,placeholder:" "}),d.jsx("label",{children:" (: #)"}),d.jsx("input",{name:"groomHashtags",value:u.groomHashtags||"",onChange:O,placeholder:"#... #..."}),d.jsx("label",{children:" ( )"}),d.jsx("textarea",{name:"groomIntro",value:u.groomIntro||"",onChange:O,rows:3,style:{width:"100%"},placeholder:" "})]}),d.jsxs("div",{style:{padding:"10px",backgroundColor:"#fff0f0",borderRadius:"8px"},children:[d.jsxs("h4",{style:{marginBottom:"10px",color:"#d77"},children:["  (",u.brideName,")"]}),d.jsx("label",{children:" "}),d.jsxs("div",{style:{marginBottom:"10px"},children:[u.brideImage&&d.jsx("img",{src:u.brideImage,alt:"Bride",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"50%",display:"block",marginBottom:"5px"}}),d.jsxs("div",{style:{display:"flex",gap:"5px"},children:[d.jsx("input",{name:"brideImage",value:u.brideImage||"",onChange:O,placeholder:" URL",style:{flex:1,minWidth:0}}),d.jsxs("label",{className:"btn",style:{padding:"5px 10px",margin:0,fontSize:"12px",cursor:"pointer",backgroundColor:"#666"},children:["",d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:T=>M(T,"brideImage")})]})]})]}),d.jsx("label",{children:" (: 1998. 01. 18.)"}),d.jsx("input",{name:"brideBirth",value:u.brideBirth||"",onChange:O,placeholder:"1998. 01. 18."}),d.jsx("label",{children:" (:  )"}),d.jsx("input",{name:"brideRegion",value:u.brideRegion||"",onChange:O,placeholder:" "}),d.jsx("label",{children:" (: #)"}),d.jsx("input",{name:"brideHashtags",value:u.brideHashtags||"",onChange:O,placeholder:"#... #..."}),d.jsx("label",{children:" ( )"}),d.jsx("textarea",{name:"brideIntro",value:u.brideIntro||"",onChange:O,rows:3,style:{width:"100%"},placeholder:" "})]})]}),d.jsx("button",{onClick:z,className:"btn btn-point",style:{marginTop:"15px"},children:" "})]})]}),d.jsx("hr",{style:{margin:"40px 0",border:"0",borderTop:"1px dashed #ccc"}}),d.jsxs("section",{style:{marginTop:"20px"},children:[d.jsx("h3",{children:"0.8     "}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",border:"1px solid #87CEEB"},children:[d.jsxs("p",{style:{fontSize:"13px",color:"#666",marginBottom:"15px"},children:["* /  ()    .",d.jsx("br",{}),"*   ''  ' '  ."]}),["groom","bride"].map(T=>d.jsxs("div",{style:{marginBottom:"30px"},children:[d.jsx("h4",{style:{marginBottom:"10px",color:T==="groom"?"#555":"#d77"},children:T==="groom"?" ":" "}),(w[T]||[]).map((R,b)=>d.jsxs("div",{style:{display:"flex",gap:"5px",marginBottom:"5px",alignItems:"center"},children:[d.jsxs("select",{value:R.relation,onChange:Y=>K(T,b,"relation",Y.target.value),style:{width:"100px",margin:0,padding:"5px"},children:[d.jsx("option",{value:"father",children:""}),d.jsx("option",{value:"mother",children:""}),d.jsx("option",{value:"me",children:""}),d.jsx("option",{value:"older_sister",children:""}),d.jsx("option",{value:"younger_brother",children:""}),d.jsx("option",{value:"maternal_grandmother",children:""}),d.jsx("option",{value:"paternal_grandmother",children:""}),d.jsx("option",{value:"other",children:""})]}),d.jsx("input",{placeholder:"",value:R.name,onChange:Y=>K(T,b,"name",Y.target.value),style:{width:"80px",margin:0}}),d.jsx("input",{placeholder:" (- )",value:R.phone,onChange:Y=>K(T,b,"phone",Y.target.value),style:{flex:1,margin:0},maxLength:13}),d.jsx("button",{onClick:()=>we(T,b),style:{backgroundColor:"#ccc",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",padding:"5px 10px"},children:"X"})]},b)),(w[T]||[]).length<7&&d.jsx("button",{onClick:()=>te(T),className:"btn",style:{padding:"5px 10px",fontSize:"12px",marginTop:"5px",backgroundColor:"#f0f0f0",color:"#333"},children:"+  "})]},T)),d.jsx("button",{onClick:ve,className:"btn btn-point",style:{marginTop:"10px",width:"100%"},children:"  "})]})]}),d.jsxs("section",{style:{marginTop:"20px"},children:[d.jsx("h3",{children:"1.  (  )"}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",border:"1px solid #87CEEB"},children:[["groom","bride"].map(T=>d.jsxs("div",{style:{marginBottom:"30px"},children:[d.jsx("h4",{style:{marginBottom:"10px",color:T==="groom"?"#555":"#d77"},children:T==="groom"?"":""}),g[T].map((R,b)=>d.jsxs("div",{style:{display:"flex",gap:"5px",marginBottom:"5px",alignItems:"center"},children:[d.jsx("input",{placeholder:"",value:R.bank,onChange:Y=>N(T,b,"bank",Y.target.value),style:{width:"80px",margin:0}}),d.jsx("input",{placeholder:"",value:R.accountNumber,onChange:Y=>N(T,b,"accountNumber",Y.target.value),style:{flex:1,margin:0}}),d.jsxs("select",{value:R.relation||"me",onChange:Y=>N(T,b,"relation",Y.target.value),style:{width:"80px",margin:0,padding:"5px"},children:[d.jsx("option",{value:"me",children:""}),d.jsx("option",{value:"father",children:""}),d.jsx("option",{value:"mother",children:""}),d.jsx("option",{value:"father_in_law",children:"/"}),d.jsx("option",{value:"mother_in_law",children:"/"}),d.jsx("option",{value:"other",children:""})]}),d.jsx("input",{placeholder:"",value:R.name,onChange:Y=>N(T,b,"name",Y.target.value),style:{width:"80px",margin:0}}),d.jsx("button",{onClick:()=>L(T,b),style:{backgroundColor:"red",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",padding:"5px 10px"},children:"X"})]},b)),g[T].length<3&&d.jsx("button",{onClick:()=>D(T),className:"btn",style:{padding:"5px 10px",fontSize:"12px",marginTop:"5px"},children:"+  "})]},T)),d.jsx("button",{onClick:P,className:"btn btn-point",style:{marginTop:"10px",width:"100%"},children:"  "})]})]}),d.jsx("hr",{style:{margin:"40px 0",border:"0",borderTop:"1px dashed #ccc"}}),d.jsxs("section",{style:{marginTop:"20px"},children:[d.jsx("h3",{children:"   "}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"20px",borderRadius:"8px",border:"1px solid #87CEEB"},children:[d.jsx("p",{style:{fontSize:"13px",color:"#666",marginBottom:"15px"},children:"* (Footer )     ."}),d.jsx("label",{children:"  "}),d.jsx("textarea",{name:"closingMessage",value:u.closingMessage||"",onChange:O,rows:8,style:{width:"100%",marginBottom:"15px"},placeholder:"  < >..."}),d.jsx("label",{children:" "}),d.jsxs("div",{style:{marginBottom:"10px"},children:[u.closingImage&&d.jsx("img",{src:u.closingImage,alt:"Closing Preview",style:{width:"100%",maxWidth:"200px",display:"block",marginBottom:"5px",opacity:u.closingImageOpacity||.6}}),d.jsxs("div",{style:{display:"flex",gap:"5px"},children:[d.jsx("input",{name:"closingImage",value:u.closingImage||"",onChange:O,placeholder:"  URL",style:{flex:1,margin:0}}),d.jsxs("label",{className:"btn",style:{padding:"10px",margin:0,fontSize:"14px",cursor:"pointer",backgroundColor:"#666"},children:[" ",d.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},onChange:T=>M(T,"closingImage")})]})]})]}),d.jsxs("div",{style:{backgroundColor:"#f9f9f9",padding:"15px",borderRadius:"8px",marginTop:"15px"},children:[d.jsxs("label",{style:{display:"block",marginBottom:"5px"},children:[d.jsx("strong",{children:" "})," (",u.closingImageOpacity||.6,")"]}),d.jsx("input",{type:"range",name:"closingImageOpacity",min:"0.1",max:"1.0",step:"0.1",value:u.closingImageOpacity||.6,onChange:O,style:{width:"100%",marginBottom:"15px"}}),d.jsx("label",{style:{display:"block",marginBottom:"5px"},children:d.jsx("strong",{children:" "})}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px",marginBottom:"15px"},children:[d.jsx("input",{type:"color",name:"closingTextColor",value:u.closingTextColor&&u.closingTextColor.startsWith("#")?u.closingTextColor:"#333333",onChange:O}),d.jsx("input",{name:"closingTextColor",value:u.closingTextColor||"#333333",onChange:O,style:{width:"100px",margin:0}})]}),d.jsx("label",{style:{display:"block",marginBottom:"5px"},children:d.jsx("strong",{children:" "})}),d.jsxs("select",{name:"closingTextWeight",value:u.closingTextWeight||"normal",onChange:O,style:{marginBottom:"15px",width:"100%"},children:[d.jsx("option",{value:"normal",children:" (Normal)"}),d.jsx("option",{value:"bold",children:" (Bold)"}),d.jsx("option",{value:"100",children:"  (Thin)"}),d.jsx("option",{value:"300",children:" (Light)"}),d.jsx("option",{value:"500",children:" (Medium)"}),d.jsx("option",{value:"900",children:"  (Black)"})]}),d.jsx("label",{style:{display:"block",marginBottom:"5px"},children:d.jsx("strong",{children:"  ()"})}),d.jsxs("select",{name:"closingTextPosition",value:u.closingTextPosition||"center",onChange:O,style:{width:"100%"},children:[d.jsx("option",{value:"center",children:"  (Center)"}),d.jsx("option",{value:"left",children:"  (Left)"}),d.jsx("option",{value:"right",children:"  (Right)"}),d.jsx("option",{value:"top-center",children:" "}),d.jsx("option",{value:"bottom-center",children:" "})]})]}),d.jsx("button",{onClick:z,className:"btn btn-point",style:{marginTop:"10px"},children:" "})]})]}),d.jsxs("section",{style:{marginTop:"40px"},children:[d.jsx("h3",{children:"2. RSVP ( ) "}),d.jsxs("div",{style:{margin:"10px 0",padding:"15px",backgroundColor:"#f0f0f0",borderRadius:"8px",display:"flex",gap:"10px",alignItems:"center"},children:[d.jsxs("span",{children:[" ",i.reduce((T,R)=>T+R.count,0)," ( ",i.length,")"]}),d.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:"5px"},children:[d.jsxs("select",{value:He,onChange:T=>We(T.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},children:[d.jsx("option",{value:"nu990524@gmail.com",children:"nu990524@gmail.com"}),d.jsx("option",{value:"ljo5211@gmail.com",children:"ljo5211@gmail.com"})]}),d.jsx("button",{onClick:se,className:"btn btn-point",children:"  "}),d.jsx("button",{onClick:de,className:"btn",style:{backgroundColor:"#999",marginLeft:"5px"},children:""})]})]}),d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginTop:"10px",fontSize:"14px"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{borderBottom:"2px solid #333",textAlign:"left",backgroundColor:"#fafafa"},children:[d.jsx("th",{style:{padding:"8px"},children:""}),d.jsx("th",{style:{padding:"8px"},children:""}),d.jsx("th",{style:{padding:"8px"},children:""}),d.jsx("th",{style:{padding:"8px"},children:""}),d.jsx("th",{style:{padding:"8px"},children:""}),d.jsx("th",{style:{padding:"8px"},children:""})]})}),d.jsx("tbody",{children:i.map(T=>d.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[d.jsx("td",{style:{padding:"8px"},children:T.side==="groom"?"":""}),d.jsx("td",{style:{padding:"8px"},children:T.name}),d.jsx("td",{style:{padding:"8px"},children:T.phone}),d.jsx("td",{style:{padding:"8px"},children:T.count}),d.jsx("td",{style:{padding:"8px",fontWeight:T.meal?"bold":"normal",color:T.meal?"#333":"#aaa"},children:T.meal?"":""}),d.jsx("td",{style:{padding:"8px"},children:T.date.split(" ")[0]})]},T.id))})]})]}),d.jsx("hr",{style:{margin:"40px 0",border:"0",borderTop:"1px dashed #ccc"}}),d.jsxs("section",{children:[d.jsx("h3",{children:"3.   "}),d.jsxs("div",{style:{backgroundColor:"#f9f9f9",padding:"20px",borderRadius:"8px"},children:[d.jsxs("p",{style:{marginBottom:"10px",fontSize:"14px",color:"#666"},children:["*  (URL)    . ",d.jsx("br",{}),"*    ,    ",d.jsx("strong",{children:"URL  "}),"."]}),d.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[d.jsx("input",{type:"text",value:l,onChange:T=>c(T.target.value),placeholder:"  (https://...)",style:{flex:1,margin:0}}),d.jsx("button",{onClick:me,className:"btn",style:{margin:0},children:""})]}),d.jsx("div",{style:{marginBottom:"20px"},children:d.jsxs("label",{style:{display:"inline-block",padding:"8px 16px",backgroundColor:"#fff",border:"1px solid #ccc",cursor:"pointer",borderRadius:"4px"},children:["     ( )",d.jsx("input",{type:"file",accept:"image/*",onChange:M,style:{display:"none"}})]})}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px"},children:o.map((T,R)=>d.jsxs("div",{style:{position:"relative",aspectRatio:"1/1"},children:[d.jsx("img",{src:T,alt:"img",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px"}}),d.jsx("button",{onClick:()=>Se(R),style:{position:"absolute",top:"5px",right:"5px",backgroundColor:"red",color:"white",border:"none",width:"24px",height:"24px",borderRadius:"50%",cursor:"pointer"},children:"X"})]},R))}),o.length===0&&d.jsx("p",{style:{textAlign:"center",color:"#999"},children:"  ."})]})]}),d.jsx("hr",{style:{margin:"40px 0",border:"0",borderTop:"1px dashed #ccc"}}),d.jsx(yL,{})]}):d.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",backgroundColor:"#f5f5f5"},children:d.jsxs("div",{style:{padding:"40px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",textAlign:"center"},children:[d.jsx("h2",{style:{marginBottom:"20px"},children:" "}),d.jsxs("form",{onSubmit:x,children:[d.jsx("input",{type:"password",value:n,onChange:T=>r(T.target.value),placeholder:" ",style:{width:"200px",marginBottom:"10px"},autoFocus:!0}),d.jsx("br",{}),d.jsx("button",{type:"submit",className:"btn btn-point",style:{width:"200px"},children:""})]}),d.jsx("a",{href:"/",style:{display:"block",marginTop:"10px",color:"#888",textDecoration:"none"},children:"  "})]})})},yL=()=>{const[e,t]=Mf.useState([]);Mf.useEffect(()=>{const i=Ae(Ie,"guest_snaps");tt(i,s=>{const o=s.val();t(o||[])})},[]);const n=i=>{if(window.confirm("   ?")){const s=e.filter(o=>o.id!==i);xn(Ae(Ie,"guest_snaps"),s).catch(o=>alert(" : "+o.message))}},r=i=>{const s=document.createElement("a");s.href=i.url;let o="png";i.url.startsWith("data:image/jpeg")?o="jpg":i.url.startsWith("data:image/gif")&&(o="gif"),s.download=`guest_snap_${i.id}.${o}`,document.body.appendChild(s),s.click(),document.body.removeChild(s)};return d.jsxs("section",{children:[d.jsx("h3",{children:"4.   "}),d.jsxs("div",{style:{backgroundColor:"#fff",padding:"15px",borderRadius:"8px",border:"1px solid #eee"},children:[d.jsx("p",{children:"      ."}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"10px",marginTop:"15px"},children:e.map(i=>d.jsxs("div",{style:{position:"relative",aspectRatio:"1/1",border:"1px solid #ddd"},children:[d.jsx("img",{src:i.url,alt:"Snap",style:{width:"100%",height:"100%",objectFit:"cover"}}),d.jsxs("div",{style:{position:"absolute",top:"0",right:"0",display:"flex"},children:[d.jsx("button",{onClick:()=>r(i),title:"",style:{backgroundColor:"rgba(0,0,0,0.6)",color:"white",border:"none",width:"24px",height:"24px",cursor:"pointer",fontSize:"14px"},children:""}),d.jsx("button",{onClick:()=>n(i.id),title:"",style:{backgroundColor:"red",color:"white",border:"none",width:"24px",height:"24px",cursor:"pointer"},children:"X"})]})]},i.id))}),e.length===0&&d.jsx("p",{style:{textAlign:"center",padding:"20px",color:"#999"},children:"   ."})]})]})},wL=()=>{const[e,t]=ce.useState([]),[n,r]=ce.useState([]),[i,s]=ce.useState(null),[o,a]=ce.useState(!1),[l,c]=ce.useState(null),[u,h]=ce.useState(0),[f,p]=ce.useState(!1),g=ce.useRef(null);ce.useEffect(()=>{const D=Ae(Ie,"gallery_images");tt(D,L=>{const P=L.val();let H=[];!P||P.length===0?H=["https://via.placeholder.com/300x300?text=Photo+1","https://via.placeholder.com/300x300?text=Photo+2","https://via.placeholder.com/300x300?text=Photo+3","https://via.placeholder.com/300x300?text=Photo+4","https://via.placeholder.com/300x300?text=Photo+5","https://via.placeholder.com/300x300?text=Photo+6","https://via.placeholder.com/300x300?text=Photo+7","https://via.placeholder.com/300x300?text=Photo+8","https://via.placeholder.com/300x300?text=Photo+9"]:H=P,t(H),H.length>0&&r([H[H.length-1],...H,H[0]])})},[]);const m=D=>{s(D+1),a(!1),h(0),document.body.style.overflow="hidden",document.body.classList.add("rsvp-modal-open")},w=()=>{document.body.style.overflow="auto",document.body.classList.remove("rsvp-modal-open"),s(null)},_=i!==null;ce.useEffect(()=>{if(!_)return;const D=L=>{L.key==="ArrowLeft"?x(-1):L.key==="ArrowRight"?x(1):L.key==="Escape"&&w()};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[_,i,o]);const x=D=>{if(o)return;const L=i+D;s(L),a(!0),h(0)},y=()=>{a(!1),i===0?s(n.length-2):i===n.length-1&&s(1)},I=D=>{o||(c(D.targetTouches[0].clientX),p(!0),h(0),a(!1))},O=D=>{if(!f||!l)return;const L=D.targetTouches[0].clientX;h(L-l)},z=()=>{if(!f)return;p(!1);const D=50;u>D?x(-1):u<-D?x(1):(a(!0),h(0)),c(null)};if(e.length===0)return null;const N=()=>_?i===0?e.length:i===n.length-1?1:i:0;return d.jsxs("div",{className:"section",children:[d.jsx("h3",{children:""}),d.jsx("p",{style:{marginBottom:"20px"},children:"  "}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px",padding:"0 10px"},children:e.map((D,L)=>d.jsx("div",{onClick:()=>m(L),style:{aspectRatio:"1/1",backgroundColor:"#eee",borderRadius:"4px",overflow:"hidden",cursor:"pointer"},children:d.jsx("img",{src:D,alt:`Gallery ${L}`,style:{width:"100%",height:"100%",objectFit:"cover"},onError:P=>P.target.style.display="none"})},L))}),_&&qh.createPortal(d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"#000",zIndex:2e4,display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:[d.jsx("button",{onClick:w,style:{position:"absolute",top:"20px",right:"20px",background:"none",border:"none",color:"white",fontSize:"30px",cursor:"pointer",zIndex:3002},children:""}),d.jsx("button",{onClick:D=>{D.stopPropagation(),x(-1)},style:{position:"absolute",left:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"white",fontSize:"40px",cursor:"pointer",padding:"20px",zIndex:3002},children:""}),d.jsx("button",{onClick:D=>{D.stopPropagation(),x(1)},style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"white",fontSize:"40px",cursor:"pointer",padding:"20px",zIndex:3002},children:""}),d.jsx("div",{ref:g,onTouchStart:I,onTouchMove:O,onTouchEnd:z,onTransitionEnd:y,style:{display:"flex",width:"100%",height:"100%",transform:`translateX(calc(-${i*100}% + ${u}px))`,transition:f||!o?"none":"transform 0.3s ease-out"},children:n.map((D,L)=>d.jsx("div",{style:{minWidth:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:d.jsx("img",{src:D,alt:`Detail ${L}`,style:{maxWidth:"100%",maxHeight:"80vh",objectFit:"contain",userSelect:"none",pointerEvents:"none"},onClick:P=>P.stopPropagation()})},L))}),d.jsxs("div",{style:{position:"absolute",bottom:"20px",color:"#aaa",fontSize:"14px",zIndex:3002},children:[N()," / ",e.length]})]}),document.body)]})},EL=()=>{const[e,t]=ce.useState(new Date(2026,10,21)),[n,r]=ce.useState(" 4 40");ce.useEffect(()=>{const f=Ae(Ie,"wedding_info");tt(f,p=>{const g=p.val();if(g&&g.date){const m=g.date.match(/(\d{4})[.]\s*(\d{1,2})[.]\s*(\d{1,2})/);if(m){const w=parseInt(m[1]),_=parseInt(m[2])-1,x=parseInt(m[3]);t(new Date(w,_,x))}if(g.date.includes("")||g.date.includes("")){const w=g.date.substring(g.date.indexOf(""));w&&r(w)}}})},[]);const i=e.getFullYear(),s=e.getMonth(),o=e.getDate(),a=new Date(i,s,1).getDay(),l=new Date(i,s+1,0).getDate(),c=[];for(let f=0;f<a;f++)c.push(null);for(let f=1;f<=l;f++)c.push(f);const u=["","","","","","",""],h=u[e.getDay()];return d.jsxs("div",{className:"section",style:{backgroundColor:"#fff",paddingBottom:"60px"},children:[d.jsxs("h3",{style:{fontFamily:"serif",letterSpacing:"2px",marginBottom:"30px"},children:[i,". ",s+1,". ",o,"(",h,")"]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",maxWidth:"300px",margin:"0 auto",fontSize:"14px",rowGap:"30px"},children:[u.map((f,p)=>d.jsx("div",{style:{color:p===0?"red":p===6?"blue":"#333",fontWeight:"bold"},children:f},f)),c.map((f,p)=>{if(!f)return d.jsx("div",{},`empty-${p}`);const g=f===o;return d.jsxs("div",{style:{position:"relative",color:p%7===0?"red":p%7===6?"blue":"#333",fontWeight:g?"bold":"normal",zIndex:1},children:[g&&d.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"30px",height:"30px",backgroundColor:"var(--point-color, #ff9090)",opacity:.3,borderRadius:"50%",zIndex:-1}}),f,g&&d.jsx("div",{style:{position:"absolute",top:"28px",left:"50%",transform:"translateX(-50%)",fontSize:"10px",whiteSpace:"nowrap",color:"#555",width:"100px",textAlign:"center"},children:n||" 4 40"})]},f)})]})]})},TL=()=>{const[e,t]=ce.useState([]);ce.useEffect(()=>{const r=Ae(Ie,"guest_snaps");tt(r,i=>{const s=i.val();t(s||[])})},[]);const n=r=>{const i=r.target.files[0];if(!i)return;if(i.size>300*1024){alert("   . (300KB  )");return}const s=new FileReader;s.onloadend=()=>{const a=[{id:Date.now(),url:s.result,date:new Date().toLocaleDateString()},...e];xn(Ae(Ie,"guest_snaps"),a).then(()=>alert("  !")).catch(l=>alert(" : "+l.message))},s.readAsDataURL(i)};return d.jsxs("div",{className:"section",style:{backgroundColor:"#fff"},children:[d.jsx("h3",{children:"  "}),d.jsxs("p",{style:{fontSize:"14px",color:"#666",marginBottom:"20px"},children:["   ",d.jsx("br",{})," ."]}),d.jsxs("label",{className:"btn btn-point",style:{display:"inline-block",marginBottom:"30px",cursor:"pointer"},children:["  ",d.jsx("input",{type:"file",accept:"image/*",onChange:n,style:{display:"none"}})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"5px"},children:e.map(r=>d.jsx("div",{style:{aspectRatio:"1/1",backgroundColor:"#eee",overflow:"hidden",borderRadius:"4px"},children:d.jsx("img",{src:r.url,alt:"Snap",style:{width:"100%",height:"100%",objectFit:"cover"},onClick:()=>window.open(r.url)})},r.id))}),e.length===0&&d.jsxs("div",{style:{padding:"20px",backgroundColor:"#f9f9f9",borderRadius:"8px",fontSize:"12px",color:"#999"},children:["   .",d.jsx("br",{}),"    !"]})]})},SL=()=>{const[e,t]=ce.useState(null),[n,r]=ce.useState({groom:[{bank:"",accountNumber:"123-456789-12-345",name:"",relation:"me"}],bride:[{bank:"",accountNumber:"1002-123-456789",name:"",relation:"me"}]});ce.useEffect(()=>{const a=Ae(Ie,"wedding_accounts");tt(a,l=>{const c=l.val();c&&r(c)})},[]);const i=a=>{t(e===a?null:a)},s=a=>{navigator.clipboard.writeText(a).then(()=>{alert(" .")}).catch(l=>{const c=document.createElement("textarea");c.value=a,document.body.appendChild(c),c.select(),document.execCommand("copy"),document.body.removeChild(c),alert(" .")})},o=(a,l)=>{if(!a||a.length===0)return d.jsx("div",{style:{padding:"15px",color:"#999",fontSize:"14px"},children:"  ."});const c={father:"",mother:"",me:"",father_in_law:"/",mother_in_law:"/",other:""};return a.map((u,h)=>{let f="";return u.relation&&u.relation!=="me"&&u.relation!=="other"?f=`${l} ${c[u.relation]||u.relation}`:u.relation==="me"?f=l:u.relation==="other"&&(f=""),d.jsxs("div",{style:{padding:"15px",borderBottom:h<a.length-1?"1px solid #eee":"none",textAlign:"left",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("div",{children:[d.jsxs("div",{style:{fontSize:"14px",color:"#333",fontWeight:"bold",marginBottom:"4px"},children:[f&&d.jsx("span",{style:{marginRight:"5px",color:"#d77"},children:f}),d.jsxs("span",{style:{color:"#555"},children:[u.bank," ",u.accountNumber]})]}),d.jsxs("div",{style:{fontSize:"13px",color:"#666"},children:[": ",u.name]})]}),d.jsx("button",{className:"btn",style:{padding:"6px 12px",fontSize:"12px",minWidth:"50px",backgroundColor:"#f5f5f5",color:"#333",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>s(u.accountNumber),children:""})]},h)})};return d.jsxs("div",{className:"section",style:{backgroundColor:"#fafafa",padding:"40px 20px",textAlign:"center"},children:[d.jsx("h3",{style:{marginBottom:"10px"},children:"  "}),d.jsxs("p",{style:{marginBottom:"30px",fontSize:"14px",color:"#666",lineHeight:"1.6"},children:["   ",d.jsx("br",{})," .",d.jsx("br",{}),"   ."]}),d.jsxs("div",{style:{maxWidth:"350px",margin:"0 auto"},children:[d.jsxs("div",{style:{marginBottom:"10px"},children:[d.jsxs("button",{onClick:()=>i("groom"),style:{width:"100%",padding:"15px",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px",fontSize:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",color:"#333"},children:[d.jsx("span",{children:"   "}),d.jsx("span",{children:e==="groom"?"":""})]}),e==="groom"&&d.jsx("div",{style:{backgroundColor:"#fff",border:"1px solid #ddd",borderTop:"none",marginTop:"-5px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px"},children:o(n.groom,"")})]}),d.jsxs("div",{style:{marginBottom:"10px"},children:[d.jsxs("button",{onClick:()=>i("bride"),style:{width:"100%",padding:"15px",backgroundColor:"#fff",border:"1px solid #ddd",borderRadius:"8px",fontSize:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",color:"#333"},children:[d.jsx("span",{children:"   "}),d.jsx("span",{children:e==="bride"?"":""})]}),e==="bride"&&d.jsx("div",{style:{backgroundColor:"#fff",border:"1px solid #ddd",borderTop:"none",marginTop:"-5px",borderBottomLeftRadius:"8px",borderBottomRightRadius:"8px"},children:o(n.bride,"")})]})]})]})},CL=()=>{const[e,t]=ce.useState({title:document.title,text:" .",url:window.location.href});ce.useEffect(()=>{const s=Ae(Ie,"wedding_info");tt(s,o=>{const a=o.val();a&&t({title:a.shareTitle||document.title,text:a.shareDesc||" .",url:window.location.href})})},[]);const n=async()=>{if(navigator.share)try{await navigator.share(e)}catch(s){console.log("Error sharing:",s)}else try{await navigator.clipboard.writeText(window.location.href),alert(" .")}catch{alert("  .")}},r=()=>{window.scrollTo({top:0,behavior:"smooth"})},i={width:"45px",height:"45px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.5)",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"20px",color:"#555",marginBottom:"10px",backdropFilter:"blur(4px)"};return d.jsxs("div",{className:"floating-actions",style:{position:"fixed",bottom:"20px",zIndex:1e3,display:"flex",flexDirection:"column",alignItems:"center",left:"50%",transform:"translateX(155px)"},children:[d.jsx("button",{onClick:r,style:i,"aria-label":" ",children:d.jsx("svg",{viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:d.jsx("polyline",{points:"18 15 12 9 6 15"})})}),d.jsx("button",{onClick:n,style:i,"aria-label":"",children:d.jsxs("svg",{viewBox:"0 0 24 24",width:"20",height:"20",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("circle",{cx:"18",cy:"5",r:"3"}),d.jsx("circle",{cx:"6",cy:"12",r:"3"}),d.jsx("circle",{cx:"18",cy:"19",r:"3"}),d.jsx("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),d.jsx("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]})})]})},kL=()=>{const[e,t]=ce.useState({closingImage:"",closingMessage:`  < >

   
    
   .

    
    
   .`,closingImageOpacity:.6,closingTextColor:"#333333",closingTextWeight:"normal",closingTextPosition:"center"});ce.useEffect(()=>{const o=Ae(Ie,"wedding_info");tt(o,a=>{const l=a.val();l&&t(c=>({...c,closingImage:l.closingImage||c.closingImage,closingMessage:l.closingMessage||c.closingMessage,mainImageOpacity:l.mainImageOpacity||c.mainImageOpacity}))})},[]);let n="center",r="center",i="center";const s=e.closingTextPosition||"center";return s==="left"?(r="flex-start",i="left"):s==="right"?(r="flex-end",i="right"):s==="top-center"?(n="flex-start",i="center"):s==="bottom-center"&&(n="flex-end",i="center"),d.jsxs("div",{className:"section",style:{position:"relative",padding:"100px 20px",backgroundColor:"#fff",overflow:"hidden",minHeight:"600px",display:"flex",flexDirection:"column",justifyContent:n,alignItems:r,color:e.closingTextColor||"#333",textAlign:i},children:[e.closingImage&&d.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:`url(${e.closingImage})`,backgroundSize:"cover",backgroundPosition:"center",opacity:e.closingImageOpacity||.6,zIndex:0}}),d.jsx("div",{style:{position:"relative",zIndex:1,width:"100%",maxWidth:"600px"},children:d.jsx("p",{style:{whiteSpace:"pre-line",fontSize:"18px",lineHeight:"2.2",fontFamily:"'Nanum Myeongjo', serif",color:e.closingTextColor||"#333",fontWeight:e.closingTextWeight||"normal",textShadow:e.closingImage?"0 0 10px rgba(255,255,255,0.8)":"none"},children:e.closingMessage})})]})},ir=({children:e,className:t,...n})=>{const[r,i]=ce.useState(!1),s=ce.useRef();return ce.useEffect(()=>{const o=new IntersectionObserver(l=>{l.forEach(c=>{c.isIntersecting?i(!0):c.boundingClientRect.top>0&&i(!1)})},{threshold:.2,rootMargin:"0px 0px -100px 0px"}),a=s.current;return a&&o.observe(a),()=>{a&&o.unobserve(a)}},[]),d.jsx("div",{ref:s,className:`fade-in-section ${r?"is-visible":""} ${t||""}`,...n,children:e})},AL=()=>{const[e,t]=ce.useState(!1),[n,r]=ce.useState(!1);ce.useEffect(()=>{const o=()=>{window.scrollY>window.innerHeight-100?t(!0):t(!1)};return window.addEventListener("scroll",o,{passive:!0}),()=>window.removeEventListener("scroll",o)},[]);const i=o=>{r(!1);const a=document.getElementById(o);if(a){const l=a.getBoundingClientRect().top+window.pageYOffset-50;window.scrollTo({top:l,behavior:"smooth"})}},s=[{name:"",id:"section-hero"},{name:"",id:"section-invitation"},{name:"",id:"section-profiles"},{name:"",id:"section-contact"},{name:"",id:"section-gallery"},{name:"",id:"section-calendar"},{name:" ",id:"section-location"},{name:"  ",id:"section-moneygift"},{name:" ",id:"section-rsvp"},{name:" ",id:"section-guestsnaps"},{name:"",id:"section-closing"}];return d.jsxs(d.Fragment,{children:[d.jsxs("nav",{className:"global-nav",style:{position:"fixed",top:0,left:0,width:"100%",height:"50px",backgroundColor:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(5px)",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 15px",boxSizing:"border-box",zIndex:9e3,boxShadow:"0 2px 10px rgba(0,0,0,0.05)",transform:e?"translateY(0)":"translateY(-100%)",transition:"transform 0.3s ease-in-out",color:"#333"},children:[d.jsx("div",{onClick:()=>r(!0),style:{width:"24px",cursor:"pointer",display:"flex",alignItems:"center"},children:d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),d.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),d.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),d.jsxs("div",{style:{fontSize:"16px",fontWeight:"500"},children:[" ",d.jsx("span",{style:{color:"#ff9090"},children:""})," "]}),d.jsx("div",{style:{width:"24px"}})]}),d.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100vh",backgroundColor:"rgba(255, 255, 255, 0.98)",zIndex:9999,display:"flex",flexDirection:"column",transition:"opacity 0.3s ease, visibility 0.3s ease",opacity:n?1:0,visibility:n?"visible":"hidden",backdropFilter:"blur(10px)"},children:[d.jsxs("div",{style:{height:"50px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 15px",borderBottom:"1px solid #f0f0f0"},children:[d.jsx("div",{onClick:()=>r(!1),style:{width:"24px",cursor:"pointer",display:"flex",alignItems:"center",color:"#ff9090"},children:d.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),d.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}),d.jsxs("div",{style:{fontSize:"16px",fontWeight:"500",color:"#ddd"},children:[" ",d.jsx("span",{style:{color:"#ffeaea"},children:""})," "]}),d.jsx("div",{style:{width:"24px"}})]}),d.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"20px",paddingBottom:"50px",overflowY:"auto"},children:s.map(o=>d.jsx("div",{onClick:()=>i(o.id),style:{fontSize:"18px",fontWeight:"500",color:"#333",cursor:"pointer",padding:"10px"},children:o.name},o.id))})]})]})};function IL(){const[e,t]=ce.useState(!1);return ce.useEffect(()=>{new URLSearchParams(window.location.search).get("admin")==="true"&&t(!0);const r=Ae(Ie,"wedding_design");tt(r,s=>{const o=s.val();o&&(document.documentElement.style.setProperty("--primary-color",o.primaryColor||"#333"),document.documentElement.style.setProperty("--point-color",o.pointColor||"#ff9090"),o.fontFamily&&(document.body.style.fontFamily=o.fontFamily))});const i=Ae(Ie,"wedding_info");tt(i,s=>{const o=s.val();if(o){if(o.shareTitle){document.title=o.shareTitle;const a=document.querySelector('meta[property="og:title"]');a&&a.setAttribute("content",o.shareTitle)}if(o.shareDesc){const a=document.querySelector('meta[property="og:description"]');a&&a.setAttribute("content",o.shareDesc)}if(o.shareImage){const a=document.querySelector('meta[property="og:image"]');a&&a.setAttribute("content",o.shareImage)}}})},[]),d.jsx(d.Fragment,{children:e?d.jsx(_L,{}):d.jsxs("div",{className:"app-container",children:[d.jsx(AL,{}),d.jsx("div",{id:"section-hero",children:d.jsx(fN,{})}),d.jsx(ir,{id:"section-invitation",children:d.jsx(hN,{})}),d.jsx(ir,{id:"section-profiles",children:d.jsx(dN,{})}),d.jsx(ir,{id:"section-contact",children:d.jsx(pN,{})}),d.jsx(ir,{id:"section-gallery",children:d.jsx(wL,{})}),d.jsx(ir,{id:"section-calendar",children:d.jsx(EL,{})}),d.jsx(ir,{id:"section-location",children:d.jsx(mN,{})}),d.jsx(ir,{id:"section-moneygift",children:d.jsx(SL,{})}),d.jsx(ir,{id:"section-rsvp",children:d.jsx(gN,{})}),d.jsx(ir,{id:"section-guestsnaps",children:d.jsx(TL,{})}),d.jsx(ir,{id:"section-closing",children:d.jsx(kL,{})}),d.jsx(CL,{}),d.jsxs("footer",{style:{padding:"20px",textAlign:"center",fontSize:"12px",color:"#999"},children:[d.jsx("p",{children:"Copyright 2026 JinO HaSom Wedding Invite"}),d.jsx("a",{href:"?admin=true",style:{textDecoration:"none",color:"#eee"},children:"Admin"})]})]})})}Bf.createRoot(document.getElementById("root")).render(d.jsx(Mf.StrictMode,{children:d.jsx(IL,{})}));
